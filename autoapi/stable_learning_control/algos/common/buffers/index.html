<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>stable_learning_control.algos.common.buffers &mdash; stable-learning-control 6.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../../../_static/css/modify.css?v=519ed47b" />

  
    <link rel="shortcut icon" href="../../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../../../../" id="documentation_options" src="../../../../../_static/documentation_options.js?v=9497d378"></script>
        <script src="../../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" />
    <link rel="next" title="stable_learning_control.algos.common.helpers" href="../helpers/index.html" />
    <link rel="prev" title="stable_learning_control.algos.common" href="../index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../../index.html">
            
              <img src="../../../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                6.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../usage/docker.html">Use with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../usage/algorithms.html">Available Agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../usage/running.html">Running Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../usage/hyperparameter_tuning.html">Hyperparameter Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../usage/saving_and_loading.html">Experiment Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../usage/plotting.html">Plotting Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../usage/eval_robustness.html">Evaluating Robustness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../usage/benchmarks.html">Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../utils/loggers.html">Loggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../utils/mpi.html">MPI Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../utils/run_utils.html">Run Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../utils/plotter.html">Plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../utils/testers.html">Policy testers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../dev/contributing.html">Contribute to stable-learning-control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../dev/doc_dev.html">Build the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../dev/license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../../index.html">API Reference</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../../index.html">stable_learning_control</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../../../index.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="../../index.html">stable_learning_control.algos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../common/index.html">stable_learning_control.common</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../disturbers/index.html">stable_learning_control.disturbers</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../utils/index.html">stable_learning_control.utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#attributes">Attributes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#functions">Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../index.html#package-contents">Package Contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Etc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../etc/acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">stable-learning-control</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../../index.html">API Reference</a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">stable_learning_control</a></li>
          <li class="breadcrumb-item"><a href="../../index.html">stable_learning_control.algos</a></li>
          <li class="breadcrumb-item"><a href="../index.html">stable_learning_control.algos.common</a></li>
      <li class="breadcrumb-item active">stable_learning_control.algos.common.buffers</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/rickstaa/stable-learning-control/blob/main/docs/source/autoapi/stable_learning_control/algos/common/buffers/index.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-stable_learning_control.algos.common.buffers">
<span id="stable-learning-control-algos-common-buffers"></span><h1>stable_learning_control.algos.common.buffers<a class="headerlink" href="#module-stable_learning_control.algos.common.buffers" title="Permalink to this heading"></a></h1>
<p>This module contains several replay buffers that are used in multiple Pytorch and
TensorFlow algorithms.</p>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this heading"></a></h2>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#stable_learning_control.algos.common.buffers.ReplayBuffer" title="stable_learning_control.algos.common.buffers.ReplayBuffer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a></p></td>
<td><p>A simple first-in-first-out (FIFO) experience replay buffer.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer" title="stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FiniteHorizonReplayBuffer</span></code></a></p></td>
<td><p>A first-in-first-out (FIFO) experience replay buffer that also stores the</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer" title="stable_learning_control.algos.common.buffers.TrajectoryBuffer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TrajectoryBuffer</span></code></a></p></td>
<td><p>A simple FIFO trajectory buffer. It can store trajectories of varying lengths</p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.ReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_learning_control.algos.common.buffers.</span></span><span class="sig-name descname"><span class="pre">ReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.ReplayBuffer" title="Permalink to this definition"></a></dt>
<dd><p>A simple first-in-first-out (FIFO) experience replay buffer.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.ReplayBuffer.obs_buf">
<span class="sig-name descname"><span class="pre">obs_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.obs_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.ReplayBuffer.obs_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing the current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.ReplayBuffer.obs_next_buf">
<span class="sig-name descname"><span class="pre">obs_next_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.obs_next_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.ReplayBuffer.obs_next_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing the next state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.ReplayBuffer.act_buf">
<span class="sig-name descname"><span class="pre">act_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.act_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.ReplayBuffer.act_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing the current action.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.ReplayBuffer.rew_buf">
<span class="sig-name descname"><span class="pre">rew_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.rew_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.ReplayBuffer.rew_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing the current reward.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.ReplayBuffer.done_buf">
<span class="sig-name descname"><span class="pre">done_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.done_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.ReplayBuffer.done_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing information whether the episode was
terminated after the action was taken.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.ReplayBuffer.ptr">
<span class="sig-name descname"><span class="pre">ptr</span></span><a class="headerlink" href="#stable_learning_control.algos.common.buffers.ReplayBuffer.ptr" title="Permalink to this definition"></a></dt>
<dd><p>The current buffer index.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<p>Initialise the ReplayBuffer object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a>) – The size of the observation space.</p></li>
<li><p><strong>act_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a>) – The size of the action space.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The replay buffer size.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">obs_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.obs_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id1">
<span class="sig-name descname"><span class="pre">obs_next_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.obs_next_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id1" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">act_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.act_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">rew_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.rew_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id4">
<span class="sig-name descname"><span class="pre">done_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.done_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id4" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.ReplayBuffer.store">
<span class="sig-name descname"><span class="pre">store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.store"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.ReplayBuffer.store" title="Permalink to this definition"></a></dt>
<dd><p>Add experience tuple to buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Start state (observation).</p></li>
<li><p><strong>act</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Action.</p></li>
<li><p><strong>rew</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.float64</span></code></a>) – Reward.</p></li>
<li><p><strong>next_obs</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Next state (observation)</p></li>
<li><p><strong>done</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Boolean specifying whether the terminal state was reached.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.ReplayBuffer.sample_batch">
<span class="sig-name descname"><span class="pre">sample_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#ReplayBuffer.sample_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.ReplayBuffer.sample_batch" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve a batch of experiences from buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The batch size. Defaults to <code class="docutils literal notranslate"><span class="pre">32</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A batch of experiences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_learning_control.algos.common.buffers.</span></span><span class="sig-name descname"><span class="pre">FiniteHorizonReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">horizon_length</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#FiniteHorizonReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#stable_learning_control.algos.common.buffers.ReplayBuffer" title="stable_learning_control.algos.common.buffers.ReplayBuffer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ReplayBuffer</span></code></a></p>
<p>A first-in-first-out (FIFO) experience replay buffer that also stores the
expected cumulative finite-horizon reward.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The expected cumulative finite-horizon reward is calculated using the following
formula:</p>
<div class="math">
<p><img src="../../../../../_images/math/535c81ab0878e2bc55cd524c848cfc30cef743c7.svg" alt="L_{target}(s,a) = \sum_{t}^{t+N} \mathbb{E}_{c_{t}}"/></p>
</div></div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer.horizon_length">
<span class="sig-name descname"><span class="pre">horizon_length</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#FiniteHorizonReplayBuffer.horizon_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer.horizon_length" title="Permalink to this definition"></a></dt>
<dd><p>The length of the finite-horizon.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer.horizon_rew_buf">
<span class="sig-name descname"><span class="pre">horizon_rew_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#FiniteHorizonReplayBuffer.horizon_rew_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer.horizon_rew_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing the expected cumulative
finite-horizon reward.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<p>Initialise the FiniteHorizonReplayBuffer object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a>) – The size of the observation space.</p></li>
<li><p><strong>act_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a>) – The size of the action space.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The replay buffer size.</p></li>
<li><p><strong>horizon_length</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The length of the finite-horizon.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id5">
<span class="sig-name descname"><span class="pre">horizon_length</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#FiniteHorizonReplayBuffer.horizon_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id5" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer._path_start_ptr">
<span class="sig-name descname"><span class="pre">_path_start_ptr</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#FiniteHorizonReplayBuffer._path_start_ptr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer._path_start_ptr" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer._path_length">
<span class="sig-name descname"><span class="pre">_path_length</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0</span></em><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#FiniteHorizonReplayBuffer._path_length"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer._path_length" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id6">
<span class="sig-name descname"><span class="pre">horizon_rew_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#FiniteHorizonReplayBuffer.horizon_rew_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id6" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer.store">
<span class="sig-name descname"><span class="pre">store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">truncated</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#FiniteHorizonReplayBuffer.store"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer.store" title="Permalink to this definition"></a></dt>
<dd><p>Add experience tuple to buffer and calculate expected cumulative finite
horizon reward if the episode is done or truncated.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Start state (observation).</p></li>
<li><p><strong>act</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Action.</p></li>
<li><p><strong>rew</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.float64</span></code></a>) – Reward.</p></li>
<li><p><strong>next_obs</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Next state (observation)</p></li>
<li><p><strong>done</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Boolean specifying whether the terminal state was reached.</p></li>
<li><p><strong>truncated</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Boolean specifying whether the episode was truncated.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer.sample_batch">
<span class="sig-name descname"><span class="pre">sample_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#FiniteHorizonReplayBuffer.sample_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.FiniteHorizonReplayBuffer.sample_batch" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve a batch of experiences and their expected cumulative finite-horizon
reward from buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The batch size. Defaults to <code class="docutils literal notranslate"><span class="pre">32</span></code>.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A batch of experiences.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_learning_control.algos.common.buffers.</span></span><span class="sig-name descname"><span class="pre">TrajectoryBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preempt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_trajectory_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">incomplete</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gamma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lam</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer" title="Permalink to this definition"></a></dt>
<dd><p>A simple FIFO trajectory buffer. It can store trajectories of varying lengths
for Monte Carlo or TD-N learning algorithms.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.obs_buf">
<span class="sig-name descname"><span class="pre">obs_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.obs_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.obs_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing the current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.obs_next_buf">
<span class="sig-name descname"><span class="pre">obs_next_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.obs_next_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.obs_next_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing the next state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.act_buf">
<span class="sig-name descname"><span class="pre">act_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.act_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.act_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing the current action.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.rew_buf">
<span class="sig-name descname"><span class="pre">rew_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.rew_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.rew_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing the current reward.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.done_buf">
<span class="sig-name descname"><span class="pre">done_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.done_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.done_buf" title="Permalink to this definition"></a></dt>
<dd><p>Buffer containing information whether the episode was
terminated after the action was taken.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)">numpy.ndarray</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.traj_lengths">
<span class="sig-name descname"><span class="pre">traj_lengths</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.traj_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.traj_lengths" title="Permalink to this definition"></a></dt>
<dd><p>List with the lengths of each trajectory in the
buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.ptr">
<span class="sig-name descname"><span class="pre">ptr</span></span><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.ptr" title="Permalink to this definition"></a></dt>
<dd><p>The current buffer index.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.traj_ptr">
<span class="sig-name descname"><span class="pre">traj_ptr</span></span><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.traj_ptr" title="Permalink to this definition"></a></dt>
<dd><p>The start index of the current trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.traj_ptrs">
<span class="sig-name descname"><span class="pre">traj_ptrs</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.traj_ptrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.traj_ptrs" title="Permalink to this definition"></a></dt>
<dd><p>The start indexes of each trajectory.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)">list</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.n_traj">
<span class="sig-name descname"><span class="pre">n_traj</span></span><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.n_traj" title="Permalink to this definition"></a></dt>
<dd><p>The number of trajectories currently stored in the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)">int</a></p>
</dd>
</dl>
</dd></dl>

<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This buffer has not be rigorously tested and should therefore still be regarded
as experimental.</p>
</div>
<p>Initialise the TrajectoryBuffer object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a>) – The size of the observation space.</p></li>
<li><p><strong>act_dim</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)"><em>tuple</em></a>) – The size of the action space.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a>) – The replay buffer size.</p></li>
<li><p><strong>preempt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether the buffer can be retrieved before it is
full. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>min_trajectory_size</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – The minimum trajectory length that can
be stored in the buffer. Defaults to <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p></li>
<li><p><strong>incomplete</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Whether the buffer can store incomplete
trajectories (i.e. trajectories which do not contain the final state).
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>gamma</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><em>float</em></a><em>, </em><em>optional</em>) – The General Advantage Estimate (GAE) discount
factor (Always between 0 and 1). Defaults to <code class="docutils literal notranslate"><span class="pre">0.99</span></code>.</p></li>
<li><p><strong>lam</strong> (<em>lam</em><em>, </em><em>optional</em>) – The GAE bias-variance trade-off factor (always between
0 and 1). Defaults to <code class="docutils literal notranslate"><span class="pre">0.95</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="id7">
<span class="sig-name descname"><span class="pre">obs_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.obs_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id7" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id8">
<span class="sig-name descname"><span class="pre">obs_next_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.obs_next_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id8" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id9">
<span class="sig-name descname"><span class="pre">act_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.act_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id9" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id10">
<span class="sig-name descname"><span class="pre">rew_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.rew_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id10" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id11">
<span class="sig-name descname"><span class="pre">done_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.done_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id11" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.adv_buf">
<span class="sig-name descname"><span class="pre">adv_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.adv_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.adv_buf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.ret_buf">
<span class="sig-name descname"><span class="pre">ret_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.ret_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.ret_buf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.val_buf">
<span class="sig-name descname"><span class="pre">val_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.val_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.val_buf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.logp_buf">
<span class="sig-name descname"><span class="pre">logp_buf</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.logp_buf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.logp_buf" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id12">
<span class="sig-name descname"><span class="pre">traj_ptrs</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.traj_ptrs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id12" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="id13">
<span class="sig-name descname"><span class="pre">traj_lengths</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.traj_lengths"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id13" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer._preempt">
<span class="sig-name descname"><span class="pre">_preempt</span></span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer._preempt"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer._preempt" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.store">
<span class="sig-name descname"><span class="pre">store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rew</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">next_obs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">done</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">logp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.store"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.store" title="Permalink to this definition"></a></dt>
<dd><p>Append one timestep of agent-environment interaction to the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Start state (observation).</p></li>
<li><p><strong>act</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Action.</p></li>
<li><p><strong>rew</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.scalars.html#numpy.float64" title="(in NumPy v2.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.float64</span></code></a>) – Reward.</p></li>
<li><p><strong>next_obs</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a>) – Next state (observation)</p></li>
<li><p><strong>done</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – Boolean specifying whether the terminal state was reached.</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – The (action) values. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>logp</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.1)"><em>numpy.ndarray</em></a><em>, </em><em>optional</em>) – The log probabilities of the actions.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.finish_path">
<span class="sig-name descname"><span class="pre">finish_path</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">last_val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.finish_path"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.finish_path" title="Permalink to this definition"></a></dt>
<dd><p>Call this at the end of a trajectory or when one gets cut off by an epoch
ends. This function increments the buffer pointers and calculates the advantage
and rewards-to-go if it contains (action) values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When (action) values are stored in the buffer, this function looks back in
the buffer to where the trajectory started and uses rewards and value
estimates from the whole trajectory to compute advantage estimates with
GAE-Lambda and compute the rewards-to-go for each state to use as the
targets for the value function.</p>
<p>The “last_val” argument should be 0 if the trajectory ended because the
agent reached a terminal state (died), and otherwise should be V(s_T), the
value function estimated for the last state. This allows us to bootstrap
the reward-to-go calculation to account for timesteps beyond the arbitrary
episode horizon (or epoch cutoff).</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.algos.common.buffers.TrajectoryBuffer.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../../../_modules/stable_learning_control/algos/common/buffers.html#TrajectoryBuffer.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.algos.common.buffers.TrajectoryBuffer.get" title="Permalink to this definition"></a></dt>
<dd><p>Retrieve the trajectory buffer.</p>
<p>Call this at the end of an epoch to get all of the data from
the buffer. Also, resets some pointers in the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>flat</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Retrieve a flat buffer (i.e. the trajectories are
concatenated). Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>The trajectory buffer.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../index.html" class="btn btn-neutral float-left" title="stable_learning_control.algos.common" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../helpers/index.html" class="btn btn-neutral float-right" title="stable_learning_control.algos.common.helpers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Rick Staa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>