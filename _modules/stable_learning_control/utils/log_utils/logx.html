<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>stable_learning_control.utils.log_utils.logx &mdash; stable-learning-control 6.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/modify.css?v=519ed47b" />

  
    <link rel="shortcut icon" href="../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js?v=9497d378"></script>
        <script src="../../../../_static/doctools.js?v=888ff710"></script>
        <script src="../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html">
            
              <img src="../../../../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                6.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/docker.html">Use with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/algorithms.html">Available Agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/running.html">Running Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/hyperparameter_tuning.html">Hyperparameter Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/saving_and_loading.html">Experiment Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/plotting.html">Plotting Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/eval_robustness.html">Evaluating Robustness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../usage/benchmarks.html">Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils/loggers.html">Loggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils/mpi.html">MPI Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils/run_utils.html">Run Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils/plotter.html">Plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../utils/testers.html">Policy testers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev/contributing.html">Contribute to stable-learning-control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev/doc_dev.html">Build the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../dev/license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../autoapi/index.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Etc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../etc/acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">stable-learning-control</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">stable_learning_control.utils.log_utils.logx</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for stable_learning_control.utils.log_utils.logx</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Contains a multi-purpose logger that can be used to log data and save trained models.</span>

<span class="sd">.. note::</span>
<span class="sd">    This module extends the logx module of</span>
<span class="sd">    `the SpinningUp repository &lt;https://github.com/openai/spinningup/tree/master/spinup/utils/logx.py&gt;`_</span>
<span class="sd">    so that it:</span>
<span class="sd">    </span>
<span class="sd">    - Also logs in line format (besides tabular format).</span>
<span class="sd">    - Logs to a file with a .csv extension (besides .txt).</span>
<span class="sd">    - Logs to TensorBoard (besides logging to a file).</span>
<span class="sd">    - Logs to Weights &amp; Biases (besides logging to a file).</span>
<span class="sd">&quot;&quot;&quot;</span>  <span class="c1"># noqa</span>

<span class="kn">import</span> <span class="nn">atexit</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">import</span> <span class="nn">glob</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">osp</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="kn">import</span> <span class="nn">joblib</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">from</span> <span class="nn">torch.utils.tensorboard</span> <span class="kn">import</span> <span class="n">SummaryWriter</span>

<span class="kn">from</span> <span class="nn">stable_learning_control.common.helpers</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">convert_to_tb_config</span><span class="p">,</span>
    <span class="n">convert_to_wandb_config</span><span class="p">,</span>
    <span class="n">is_scalar</span><span class="p">,</span>
    <span class="n">parse_config_env_key</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">stable_learning_control.user_config</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">DEFAULT_STD_OUT_TYPE</span><span class="p">,</span>
    <span class="n">PRINT_CONFIG</span><span class="p">,</span>
    <span class="n">TB_HPARAMS_FILTER</span><span class="p">,</span>
    <span class="n">TB_HPARAMS_METRICS</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">stable_learning_control.utils.import_utils</span> <span class="kn">import</span> <span class="n">import_tf</span><span class="p">,</span> <span class="n">lazy_importer</span>
<span class="kn">from</span> <span class="nn">stable_learning_control.utils.log_utils.helpers</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">dict_to_mdtable</span><span class="p">,</span>
    <span class="n">log_to_std_out</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">stable_learning_control.utils.mpi_utils.mpi_tools</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">mpi_statistics_scalar</span><span class="p">,</span>
    <span class="n">proc_id</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">stable_learning_control.utils.serialization_utils</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">convert_json</span><span class="p">,</span>
    <span class="n">load_from_json</span><span class="p">,</span>
    <span class="n">save_to_json</span><span class="p">,</span>
<span class="p">)</span>

<span class="c1"># Import ray tuner if installed.</span>
<div class="viewcode-block" id="ray"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.ray">[docs]</a><span class="n">ray</span> <span class="o">=</span> <span class="n">lazy_importer</span><span class="p">(</span><span class="n">module_name</span><span class="o">=</span><span class="s2">&quot;ray&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="Logger"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger">[docs]</a><span class="k">class</span> <span class="nc">Logger</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A general-purpose logger.</span>

<span class="sd">    Makes it easy to save diagnostics, hyperparameter configurations, the</span>
<span class="sd">    state of a training run, and the trained model.</span>
<span class="sd">    &quot;&quot;&quot;</span>

<div class="viewcode-block" id="Logger.__init__"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">output_dir</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">output_fname</span><span class="o">=</span><span class="s2">&quot;progress.csv&quot;</span><span class="p">,</span>
        <span class="n">exp_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">verbose_fmt</span><span class="o">=</span><span class="n">DEFAULT_STD_OUT_TYPE</span><span class="p">,</span>
        <span class="n">verbose_vars</span><span class="o">=</span><span class="p">[],</span>
        <span class="n">save_checkpoints</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">backend</span><span class="o">=</span><span class="s2">&quot;torch&quot;</span><span class="p">,</span>
        <span class="n">output_dir_exists_warning</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="n">use_wandb</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">wandb_job_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">wandb_project</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">wandb_group</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">wandb_run_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise a Logger.</span>

<span class="sd">        Args:</span>
<span class="sd">            output_dir (str, optional): A directory for saving results to. If</span>
<span class="sd">                ``None``, defaults to a temp directory of the form</span>
<span class="sd">                ``/tmp/experiments/somerandomnumber``.</span>
<span class="sd">            output_fname (str, optional): Name for the (comma/tab) separated-value</span>
<span class="sd">                file containing metrics logged throughout a training run. Defaults to</span>
<span class="sd">                to ``progress.csv`` which uses commas as separators.</span>
<span class="sd">            exp_name (str, optional): Experiment name. If you run multiple training</span>
<span class="sd">                runs and give them all the same ``exp_name``, the plotter</span>
<span class="sd">                will know to group them. (Use case: if you run the same</span>
<span class="sd">                hyperparameter configuration with multiple random seeds, you</span>
<span class="sd">                should give them all the same ``exp_name``.)</span>
<span class="sd">            quiet (bool, optional): Whether you want to suppress logging of the</span>
<span class="sd">                diagnostics to the stdout. Defaults to ``False``.</span>
<span class="sd">            verbose_fmt (str, optional): The format in which the diagnostics are</span>
<span class="sd">                displayed to the terminal. Options are ``tab`` which supplies them as a</span>
<span class="sd">                table and ``line`` which prints them in one line. Default is set in the</span>
<span class="sd">                :mod:`~stable_learning_control.user_config` file.</span>
<span class="sd">            verbose_vars (list, optional): A list of variables you want to log to the</span>
<span class="sd">                stdout. By default all variables are logged.</span>
<span class="sd">            save_checkpoints (bool, optional): Save checkpoints during training.</span>
<span class="sd">                Defaults to ``False``.</span>
<span class="sd">            backend (str, optional): The backend you want to use for writing to</span>
<span class="sd">                TensorBoard. Options are: ``tf2`` or ``torch``. Defaults to ``torch``.</span>
<span class="sd">            output_dir_exists_warning (bool, optional): Whether to print a warning</span>
<span class="sd">                when the output directory already exists. Defaults to ``True``.</span>
<span class="sd">            use_wandb (bool, optional): Whether to use Weights &amp; Biases for logging.</span>
<span class="sd">                Defaults to ``False``.</span>
<span class="sd">            wandb_job_type (str, optional): The Weights &amp; Biases job type. Defaults to</span>
<span class="sd">                ``None``.</span>
<span class="sd">            wandb_project (str, optional): The name of the Weights &amp; Biases</span>
<span class="sd">                project. Defaults to ``None`` which means that the project name is</span>
<span class="sd">                automatically generated.</span>
<span class="sd">            wandb_group (str, optional): The name of the Weights &amp; Biases group you want</span>
<span class="sd">                to assign the run to. Defaults to ``None``.</span>
<span class="sd">            wandb_run_name (str, optional): The name of the Weights &amp; Biases run.</span>
<span class="sd">                Defaults to ``None`` which means that the run name is automatically</span>
<span class="sd">                generated.</span>

<span class="sd">        Attributes:</span>
<span class="sd">            tb_writer (torch.utils.tensorboard.writer.SummaryWriter): A TensorBoard</span>
<span class="sd">                writer. This is only created when you log a variable to TensorBoard or</span>
<span class="sd">                set the :attr:`Logger.use_tensorboard` variable to ``True``.</span>
<span class="sd">            output_dir (str): The directory in which the log data and models are saved.</span>
<span class="sd">            output_file (str): The name of the file in which the progress data is saved.</span>
<span class="sd">            exp_name (str): Experiment name.</span>
<span class="sd">            wandb (wandb): A Weights &amp; Biases object. This is only created when you set</span>
<span class="sd">                the :attr:`Logger.use_wandb` variable to ``True``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Parse output_fname to see if csv was requested.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_output_file_extension</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">output_fname</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_output_file_sep</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;,&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_file_extension</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;.csv&quot;</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="se">\t</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span>
                <span class="n">Path</span><span class="p">(</span><span class="n">output_dir</span> <span class="ow">or</span> <span class="s2">&quot;/tmp/experiments/</span><span class="si">%i</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="nb">int</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()))</span><span class="o">.</span><span class="n">resolve</span><span class="p">()</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">osp</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">output_dir_exists_warning</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                        <span class="p">(</span>
                            <span class="s2">&quot;Log dir </span><span class="si">%s</span><span class="s2"> already exists! Storing info there anyway.&quot;</span>
                            <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span>
                        <span class="p">),</span>
                        <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">output_fname</span><span class="p">),</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Logging data to &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_file</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="n">quiet</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verbose_table</span> <span class="o">=</span> <span class="n">verbose_fmt</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">!=</span> <span class="s2">&quot;line&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verbose_vars</span> <span class="o">=</span> <span class="p">[</span>
                <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;avg|Avg|AVG&quot;</span><span class="p">,</span> <span class="s2">&quot;Average&quot;</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">verbose_vars</span>
            <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">output_file</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verbose_table</span> <span class="o">=</span> <span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">verbose_vars</span> <span class="o">=</span> <span class="kc">None</span>
<div class="viewcode-block" id="Logger.exp_name"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.exp_name">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">exp_name</span> <span class="o">=</span> <span class="n">exp_name</span></div>
<div class="viewcode-block" id="Logger._first_row"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._first_row">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_first_row</span> <span class="o">=</span> <span class="kc">True</span></div>
<div class="viewcode-block" id="Logger._log_headers"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._log_headers">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_log_headers</span> <span class="o">=</span> <span class="p">[]</span></div>
<div class="viewcode-block" id="Logger._log_current_row"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._log_current_row">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span> <span class="o">=</span> <span class="p">{}</span></div>
<div class="viewcode-block" id="Logger._last_metrics"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._last_metrics">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_last_metrics</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger._save_checkpoints"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._save_checkpoints">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_save_checkpoints</span> <span class="o">=</span> <span class="n">save_checkpoints</span></div>
<div class="viewcode-block" id="Logger._checkpoint"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._checkpoint">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span> <span class="o">=</span> <span class="mi">0</span></div>
<div class="viewcode-block" id="Logger._save_info_saved"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._save_info_saved">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_save_info_saved</span> <span class="o">=</span> <span class="kc">False</span></div>
<div class="viewcode-block" id="Logger._use_tensorboard"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._use_tensorboard">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_use_tensorboard</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger._tf"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._tf">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger.wandb"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.wandb">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger._config"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._config">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="kc">None</span></div>

        <span class="c1"># Training output files paths storage variables.</span>
<div class="viewcode-block" id="Logger._config_file_path"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._config_file_path">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_config_file_path</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger._output_file_path"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._output_file_path">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_output_file_path</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger._state_path"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._state_path">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state_path</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger._state_checkpoints_dir_path"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._state_checkpoints_dir_path">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_state_checkpoints_dir_path</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger._save_info_path"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._save_info_path">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_save_info_path</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger._model_path"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._model_path">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_model_path</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger._model_checkpoints_dir_path"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._model_checkpoints_dir_path">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_model_checkpoints_dir_path</span> <span class="o">=</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Logger._use_tf_backend"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._use_tf_backend">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span> <span class="o">=</span> <span class="n">backend</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;tf2&quot;</span></div>
<div class="viewcode-block" id="Logger.tb_writer"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.tb_writer">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span> <span class="o">=</span> <span class="kc">None</span></div>
<div class="viewcode-block" id="Logger._tabular_to_tb_dict"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._tabular_to_tb_dict">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_tabular_to_tb_dict</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">dict</span><span class="p">()</span>
        <span class="p">)</span>  <span class="c1"># Stores if tabular is logged to TensorBoard when dump_tabular is called.</span></div>
<div class="viewcode-block" id="Logger._step_count_dict"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._step_count_dict">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_step_count_dict</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">dict</span><span class="p">()</span>
        <span class="p">)</span>  <span class="c1"># Used for keeping count of the current global step.</span></div>

        <span class="c1"># Setup Weights &amp; Biases if requested.</span>
        <span class="k">if</span> <span class="n">use_wandb</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">wandb</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span> <span class="o">=</span> <span class="n">wandb</span>
            <span class="n">wandb</span><span class="o">.</span><span class="n">init</span><span class="p">(</span>
                <span class="n">job_type</span><span class="o">=</span><span class="n">wandb_job_type</span><span class="p">,</span>
                <span class="nb">dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span>
                <span class="n">project</span><span class="o">=</span><span class="n">wandb_project</span><span class="p">,</span>
                <span class="n">group</span><span class="o">=</span><span class="n">wandb_group</span><span class="p">,</span>
                <span class="n">name</span><span class="o">=</span><span class="n">wandb_run_name</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="c1"># Initialize artifacts.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="o">.</span><span class="n">Artifact</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;config&quot;</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;metadata&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Contains training configuration data.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="p">[</span><span class="s2">&quot;progress&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="o">.</span><span class="n">Artifact</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;progress&quot;</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;diagnostics&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Contains training diagnostics.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="o">.</span><span class="n">Artifact</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;state&quot;</span><span class="p">,</span>
                <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Contains training state data.&quot;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="o">.</span><span class="n">Artifact</span><span class="p">(</span>
                <span class="n">name</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;model&quot;</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Contains model related data.&quot;</span>
            <span class="p">)</span>

            <span class="c1"># Ensure training artifacts are uploaded to WandB at the end of the run.</span>
            <span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_log_wandb_artifacts</span><span class="p">)</span>

            <span class="c1"># Ensure hparams and final metrics are logged if backend is PyTorch.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span><span class="p">:</span>
                <span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_log_tb_hparams</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.log"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.log">[docs]</a>    <span class="k">def</span> <span class="nf">log</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">msg</span><span class="p">,</span>
        <span class="n">color</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
        <span class="n">bold</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">highlight</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">*</span><span class="n">args</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print a colorized message to ``stdout``.</span>

<span class="sd">        Args:</span>
<span class="sd">            msg (str): Message you want to log.</span>
<span class="sd">            color (str, optional): Color you want the message to have. Defaults to</span>
<span class="sd">                ``&quot;&quot;``.</span>
<span class="sd">            bold (bool, optional): Whether you want the text to be bold text has to be</span>
<span class="sd">                bold.</span>
<span class="sd">            highlight (bool, optional):  Whether you want to highlight the text.</span>
<span class="sd">                Defaults to ``False``.</span>
<span class="sd">            type (str, optional): The log message type. Options are: ``info``,</span>
<span class="sd">                ``warning`` and ``error``. Defaults to ``None``.</span>
<span class="sd">            *args: All args to pass to the print function.</span>
<span class="sd">            **kwargs: All kwargs to pass to the print function.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">log_to_std_out</span><span class="p">(</span>
                <span class="n">msg</span><span class="p">,</span>
                <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span>
                <span class="n">bold</span><span class="o">=</span><span class="n">bold</span><span class="p">,</span>
                <span class="n">highlight</span><span class="o">=</span><span class="n">highlight</span><span class="p">,</span>
                <span class="nb">type</span><span class="o">=</span><span class="nb">type</span><span class="p">,</span>
                <span class="o">*</span><span class="n">args</span><span class="p">,</span>
                <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="Logger.log_to_tb"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.log_to_tb">[docs]</a>    <span class="k">def</span> <span class="nf">log_to_tb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">tb_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tb_alias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log a value to TensorBoard.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str):  The name of the diagnostic.</span>
<span class="sd">            val (object): A value for the diagnostic.</span>
<span class="sd">            tb_prefix(str, optional): A prefix which can be added to group the</span>
<span class="sd">                variables.</span>
<span class="sd">            tb_alias (str, optional): A tb alias for the variable you want to store</span>
<span class="sd">                store. Defaults to empty :obj:`dict`. If not supplied the variable name</span>
<span class="sd">                is used.</span>
<span class="sd">            global_step (int, optional): Global step value to record. Uses internal step</span>
<span class="sd">                counter if global step is not supplied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Make sure SummaryWriter exists.</span>
        <span class="n">var_name</span> <span class="o">=</span> <span class="n">tb_alias</span> <span class="k">if</span> <span class="n">tb_alias</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">key</span>
        <span class="n">var_name</span> <span class="o">=</span> <span class="n">tb_prefix</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">var_name</span> <span class="k">if</span> <span class="n">tb_prefix</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">var_name</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_write_to_tb</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.log_tabular"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.log_tabular">[docs]</a>    <span class="k">def</span> <span class="nf">log_tabular</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">,</span>
        <span class="n">val</span><span class="p">,</span>
        <span class="n">tb_write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">tb_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tb_alias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log a value of some diagnostic.</span>

<span class="sd">        Call this only once for each diagnostic quantity, each iteration.</span>
<span class="sd">        After using :meth:`log_tabular` to store values for each diagnostic,</span>
<span class="sd">        make sure to call :meth:`dump_tabular` to write them out to file,</span>
<span class="sd">        TensorBoard and ``stdout`` (otherwise they will not get saved anywhere).</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The name of the diagnostic. If you are logging a</span>
<span class="sd">                diagnostic whose state has previously been saved with</span>
<span class="sd">                :meth:`EpochLogger.store`, the key here has to match the key you used</span>
<span class="sd">                there.</span>
<span class="sd">            val (object): A value for the diagnostic. If you have previously saved</span>
<span class="sd">                values for this key via :meth:`EpochLogger.store`, do *not* provide a</span>
<span class="sd">                ``val`` here.</span>
<span class="sd">            tb_write (bool, optional): Boolean specifying whether you also want to write</span>
<span class="sd">                the value to the TensorBoard logfile. Defaults to ``False``.</span>
<span class="sd">            tb_metrics (Union[list[str], str], optional): List containing the metrics</span>
<span class="sd">                you want to write to TensorBoard. Options are [``avg``, ``std``,</span>
<span class="sd">                ``min``, ``max``].`` Defaults to ``avg``.</span>
<span class="sd">            tb_prefix(str, optional): A prefix which can be added to group the</span>
<span class="sd">                variables.</span>
<span class="sd">            tb_alias (str, optional): A tb alias for the variable you want to store</span>
<span class="sd">                store. Defaults to empty :obj:`dict`. If not supplied the variable name</span>
<span class="sd">                is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_row</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_log_headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">assert</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_headers</span><span class="p">,</span> <span class="p">(</span>
                <span class="s2">&quot;Trying to introduce a new key </span><span class="si">%s</span><span class="s2"> that you didn&#39;t include in the &quot;</span>
                <span class="s2">&quot;first iteration&quot;</span> <span class="o">%</span> <span class="n">key</span>
            <span class="p">)</span>
        <span class="k">assert</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span><span class="p">,</span> <span class="p">(</span>
            <span class="s2">&quot;You already set </span><span class="si">%s</span><span class="s2"> this iteration. Maybe you forgot to call dump_tabular()&quot;</span>
            <span class="o">%</span> <span class="n">key</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tabular_to_tb_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;tb_write&quot;</span><span class="p">:</span> <span class="n">tb_write</span><span class="p">,</span>
            <span class="s2">&quot;tb_prefix&quot;</span><span class="p">:</span> <span class="n">tb_prefix</span><span class="p">,</span>
            <span class="s2">&quot;tb_alias&quot;</span><span class="p">:</span> <span class="n">tb_alias</span><span class="p">,</span>
        <span class="p">}</span></div>

<div class="viewcode-block" id="Logger.dump_tabular"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.dump_tabular">[docs]</a>    <span class="k">def</span> <span class="nf">dump_tabular</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">global_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write all of the diagnostics from the current iteration.</span>

<span class="sd">        Writes both to ``stdout``, TensorBoard and to the output file.</span>

<span class="sd">        Args:</span>
<span class="sd">            global_step (int, optional): Global step value to record. Uses internal step</span>
<span class="sd">                counter if global step is not supplied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">print_dict</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="n">print_keys</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">print_vals</span> <span class="o">=</span> <span class="p">[]</span>

            <span class="c1"># Retrieve data and max value length from current row.</span>
            <span class="n">val_lens</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">))</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span>
            <span class="n">max_val_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">val_lens</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_headers</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="n">valstr</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">val</span><span class="p">)</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="n">max_val_len</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">valstr</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;%</span><span class="si">{</span><span class="n">max_val_len</span><span class="si">}</span><span class="s2">.3g&quot;</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose_table</span> <span class="k">else</span> <span class="s2">&quot;</span><span class="si">%.3g</span><span class="s2">&quot;</span>
                    <span class="p">)</span> <span class="o">%</span> <span class="n">val</span>
                <span class="n">print_keys</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
                <span class="n">print_vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valstr</span><span class="p">)</span>
                <span class="n">print_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">valstr</span>
                <span class="n">vals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

            <span class="c1"># Log to stdout.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">quiet</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose_vars</span><span class="p">:</span>
                    <span class="n">filtered_keys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose_vars</span>

                    <span class="c1"># Make sure Epoch and EnvInteract are always shown if present.</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">([</span><span class="s2">&quot;Epoch&quot;</span><span class="p">,</span> <span class="s2">&quot;TotalEnvInteracts&quot;</span><span class="p">]):</span>
                        <span class="k">if</span> <span class="n">item</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">filtered_keys</span> <span class="ow">and</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">print_keys</span><span class="p">:</span>
                            <span class="n">filtered_keys</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">item</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">filtered_keys</span> <span class="o">=</span> <span class="n">print_keys</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">verbose_table</span><span class="p">:</span>
                    <span class="n">key_lens</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_headers</span><span class="p">]</span>
                    <span class="n">max_key_len</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="nb">max</span><span class="p">(</span><span class="n">key_lens</span><span class="p">))</span>
                    <span class="n">keystr</span> <span class="o">=</span> <span class="s2">&quot;%&quot;</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">max_key_len</span>
                    <span class="n">fmt</span> <span class="o">=</span> <span class="s2">&quot;| &quot;</span> <span class="o">+</span> <span class="n">keystr</span> <span class="o">+</span> <span class="s2">&quot;s | </span><span class="si">%s</span><span class="s2"> |&quot;</span>
                    <span class="n">n_slashes</span> <span class="o">=</span> <span class="n">max_val_len</span> <span class="o">+</span> <span class="n">max_key_len</span> <span class="o">+</span> <span class="mi">7</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">n_slashes</span><span class="p">)</span>
                    <span class="n">print_str</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="n">fmt</span> <span class="o">%</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span>
                            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">print_keys</span><span class="p">,</span> <span class="n">print_vals</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">filtered_keys</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">print_str</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;-&quot;</span> <span class="o">*</span> <span class="n">n_slashes</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">print_str</span> <span class="o">=</span> <span class="s2">&quot;|&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="s2">&quot;</span><span class="si">%s</span><span class="s2">:</span><span class="si">%s</span><span class="s2">&quot;</span>
                            <span class="o">%</span> <span class="p">(</span>
                                <span class="p">(</span>
                                    <span class="s2">&quot;Steps&quot;</span>
                                    <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s2">&quot;TotalEnvInteracts&quot;</span>
                                    <span class="k">else</span> <span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;Average&quot;</span><span class="p">,</span> <span class="s2">&quot;Avg&quot;</span><span class="p">)</span>
                                <span class="p">),</span>
                                <span class="n">val</span><span class="p">,</span>
                            <span class="p">)</span>
                            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">print_keys</span><span class="p">,</span> <span class="n">print_vals</span><span class="p">)</span>
                            <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">filtered_keys</span>
                        <span class="p">]</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">print_str</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># Increase epoch steps and time on the same line.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                    <span class="s2">&quot;</span><span class="se">\r</span><span class="si">{}</span><span class="s2">: </span><span class="si">{:8.3G}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">: </span><span class="si">{:8.3g}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">: </span><span class="si">{:8.3G}</span><span class="s2"> s&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                        <span class="s2">&quot;Epoch&quot;</span><span class="p">,</span>
                        <span class="nb">float</span><span class="p">(</span><span class="n">print_dict</span><span class="p">[</span><span class="s2">&quot;Epoch&quot;</span><span class="p">]),</span>
                        <span class="s2">&quot;Step&quot;</span><span class="p">,</span>
                        <span class="nb">float</span><span class="p">(</span><span class="n">print_dict</span><span class="p">[</span><span class="s2">&quot;TotalEnvInteracts&quot;</span><span class="p">]),</span>
                        <span class="s2">&quot;Time&quot;</span><span class="p">,</span>
                        <span class="nb">float</span><span class="p">(</span><span class="n">print_dict</span><span class="p">[</span><span class="s2">&quot;Time&quot;</span><span class="p">]),</span>
                    <span class="p">),</span>
                    <span class="n">end</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="c1"># Log to file.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_first_row</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_file_sep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_log_headers</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                    <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_file_sep</span><span class="si">}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">vals</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output_file</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_output_file_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_file</span><span class="o">.</span><span class="n">name</span>

            <span class="c1"># Write tabular to TensorBoard log.</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_headers</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tabular_to_tb_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;tb_write&quot;</span><span class="p">]:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
                    <span class="c1"># Use internal counter if global_step is None.</span>
                    <span class="k">if</span> <span class="n">global_step</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_headers</span><span class="p">:</span>
                            <span class="n">global_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span>
                    <span class="n">var_name</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_tabular_to_tb_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;tb_alias&quot;</span><span class="p">]</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tabular_to_tb_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;tb_alias&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                        <span class="k">else</span> <span class="n">key</span>
                    <span class="p">)</span>
                    <span class="n">var_name</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_tabular_to_tb_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;tb_prefix&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;/&quot;</span> <span class="o">+</span> <span class="n">var_name</span>
                        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tabular_to_tb_dict</span><span class="p">[</span><span class="n">key</span><span class="p">][</span><span class="s2">&quot;tb_prefix&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                        <span class="k">else</span> <span class="n">var_name</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_write_to_tb</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>

            <span class="c1"># Log to Ray tune if available.</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">ray</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">ray</span><span class="o">.</span><span class="n">is_initialized</span><span class="p">()</span>
                <span class="ow">and</span> <span class="n">ray</span><span class="o">.</span><span class="n">tune</span><span class="o">.</span><span class="n">is_session_enabled</span><span class="p">()</span>
            <span class="p">):</span>
                <span class="n">ray</span><span class="o">.</span><span class="n">tune</span><span class="o">.</span><span class="n">report</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span><span class="p">)</span>

            <span class="c1"># Log to Weights &amp; Biases if available.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">filtered_log_current_row</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span>
                <span class="p">}</span>  <span class="c1"># Weights &amp; Biases doesn&#39;t support string values.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">filtered_log_current_row</span><span class="p">)</span>

        <span class="c1"># Store last metrics.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_last_metrics</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">TB_HPARAMS_METRICS</span>
        <span class="p">}</span>

        <span class="c1"># Clear the current row.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_first_row</span> <span class="o">=</span> <span class="kc">False</span></div>

<div class="viewcode-block" id="Logger.get_logdir"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.get_logdir">[docs]</a>    <span class="k">def</span> <span class="nf">get_logdir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get Logger and TensorBoard SummaryWriter logdirs.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the Summary/SummaryWriter object.</span>
<span class="sd">            **kwargs: All kwargs to pass to the Summary/SummaryWriter object.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (dict): dict containing:</span>

<span class="sd">                - output_dir(:obj:`str`): Logger output directory.</span>
<span class="sd">                - tb_output_dir(:obj:`str`): TensorBoard writer output directory.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">log_dir</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;output_dir&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tensorboard</span><span class="p">:</span>
            <span class="n">log_dir</span><span class="p">[</span><span class="s2">&quot;tb_output_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">get_logdir</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log_dir</span><span class="p">[</span><span class="s2">&quot;wandb_output_dir&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="o">.</span><span class="n">run</span><span class="o">.</span><span class="n">dir</span>
        <span class="k">return</span> <span class="n">log_dir</span></div>

<div class="viewcode-block" id="Logger.save_config"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.save_config">[docs]</a>    <span class="k">def</span> <span class="nf">save_config</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log an experiment configuration.</span>

<span class="sd">        Call this once at the top of your experiment, passing in all important</span>
<span class="sd">        config vars as a dict. This will serialize the config to JSON, while</span>
<span class="sd">        handling anything which can&#39;t be serialized in a graceful way (writing</span>
<span class="sd">        as informative a string as possible). The resulting JSON will be saved</span>
<span class="sd">        to the output directory, made available to TensorBoard and Weights &amp; Biases and</span>
<span class="sd">        printed to stdout.</span>

<span class="sd">        Example:</span>
<span class="sd">            .. code-block:: python</span>

<span class="sd">                logger = EpochLogger(**logger_kwargs)</span>
<span class="sd">                logger.save_config(locals())</span>

<span class="sd">        Args:</span>
<span class="sd">            config (object): Configuration Python object you want to save.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">parse_config_env_key</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_config</span> <span class="o">=</span> <span class="n">config</span>
            <span class="n">config_json</span> <span class="o">=</span> <span class="n">convert_json</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">config_json</span><span class="p">[</span><span class="s2">&quot;exp_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_name</span>
            <span class="n">output</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span>
                <span class="n">config_json</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;,&quot;</span><span class="p">,</span> <span class="s2">&quot;:</span><span class="se">\t</span><span class="s2">&quot;</span><span class="p">),</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">True</span>
            <span class="p">)</span>
            <span class="n">config_file</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;config.json&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Saving config to &#39;</span><span class="si">%s</span><span class="s2">&#39;.&quot;</span> <span class="o">%</span> <span class="n">config_file</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">PRINT_CONFIG</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">config:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_file</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_config_file_path</span> <span class="o">=</span> <span class="n">config_file</span>

            <span class="c1"># Update Weights &amp; Biases config.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_wandb_config</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Logger.load_config"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.load_config">[docs]</a>    <span class="k">def</span> <span class="nf">load_config</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">config_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads an experiment configuration.</span>

<span class="sd">        Args:</span>
<span class="sd">           config_path (str): Folder that contains the config files you want to load.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (object): Object containing the loaded configuration.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">osp</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">config_path</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.json&quot;</span><span class="p">):</span>
                <span class="n">load_path</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span>
                    <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;**&quot;</span><span class="p">,</span> <span class="s2">&quot;config.json&quot;</span><span class="p">),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">load_path</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;No &#39;config.json&#39; file found in &#39;</span><span class="si">{</span><span class="n">config_path</span><span class="si">}</span><span class="s2">&#39;. Please check &quot;</span>
                        <span class="s2">&quot;your `config_path` and try again.&quot;</span>
                    <span class="p">)</span>
                <span class="n">load_path</span> <span class="o">=</span> <span class="n">load_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">load_path</span> <span class="o">=</span> <span class="n">config_path</span>
            <span class="k">return</span> <span class="n">load_from_json</span><span class="p">(</span><span class="n">load_path</span><span class="p">)</span></div>

    <span class="nd">@classmethod</span>
<div class="viewcode-block" id="Logger.load_env"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.load_env">[docs]</a>    <span class="k">def</span> <span class="nf">load_env</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">env_path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads a pickled environment.</span>

<span class="sd">        Args:</span>
<span class="sd">           config_path (str): Folder that contains the pickled environment.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (:obj:`gym.env`): The gymnasium environment.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">osp</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">env_path</span><span class="p">)</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.pkl&quot;</span><span class="p">):</span>
                <span class="n">load_path</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span>
                    <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">env_path</span><span class="p">,</span> <span class="s2">&quot;**&quot;</span><span class="p">,</span> <span class="s2">&quot;vars.pkl&quot;</span><span class="p">),</span> <span class="n">recursive</span><span class="o">=</span><span class="kc">True</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">load_path</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span>
                        <span class="sa">f</span><span class="s2">&quot;No &#39;vars.pkl&#39; file found in &#39;</span><span class="si">{</span><span class="n">env_path</span><span class="si">}</span><span class="s2">&#39;. Please check  &quot;</span>
                        <span class="s2">&quot;your &#39;env_path&#39; and try again.&quot;</span>
                    <span class="p">)</span>
                <span class="n">load_path</span> <span class="o">=</span> <span class="n">load_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">load_path</span> <span class="o">=</span> <span class="n">env_path</span>

        <span class="c1"># try to load environment from save.</span>
        <span class="c1"># NOTE: Sometimes this will fail because the environment could not be pickled.</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">state</span> <span class="o">=</span> <span class="n">joblib</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">load_path</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">state</span><span class="p">[</span><span class="s2">&quot;env&quot;</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Something went wrong while trying to load the pickled environment &quot;</span>
                <span class="s2">&quot;please check the environment and try again.&quot;</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="Logger.save_to_json"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.save_to_json">[docs]</a>    <span class="k">def</span> <span class="nf">save_to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_object</span><span class="p">,</span> <span class="n">output_filename</span><span class="p">,</span> <span class="n">output_path</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save python object to Json file. This method will serialize the object to</span>
<span class="sd">        JSON, while handling anything which can&#39;t be serialized in a graceful way</span>
<span class="sd">        (writing as informative a string as possible).</span>

<span class="sd">        Args:</span>
<span class="sd">            input_object (object): The input object you want to save.</span>
<span class="sd">            output_filename (str): The output filename.</span>
<span class="sd">            output_path (str): The output path. By default the</span>
<span class="sd">                :attr:`Logger.output_dir`  is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">input_object_json</span> <span class="o">=</span> <span class="n">convert_json</span><span class="p">(</span><span class="n">input_object</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">input_object_json</span><span class="p">[</span><span class="s2">&quot;exp_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_name</span>
            <span class="n">output_path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="k">if</span> <span class="n">output_path</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">output_path</span>
            <span class="n">save_to_json</span><span class="p">(</span>
                <span class="n">input_object</span><span class="o">=</span><span class="n">input_object_json</span><span class="p">,</span>
                <span class="n">output_filename</span><span class="o">=</span><span class="n">output_filename</span><span class="p">,</span>
                <span class="n">output_path</span><span class="o">=</span><span class="n">output_path</span><span class="p">,</span>
            <span class="p">)</span></div>

<div class="viewcode-block" id="Logger.load_from_json"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.load_from_json">[docs]</a>    <span class="k">def</span> <span class="nf">load_from_json</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load data from json file.</span>

<span class="sd">        Args:</span>
<span class="sd">            path (str): The path of the json file you want to load.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (object): The Json load object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">load_from_json</span><span class="p">(</span><span class="n">path</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.save_state"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.save_state">[docs]</a>    <span class="k">def</span> <span class="nf">save_state</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">state_dict</span><span class="p">,</span> <span class="n">itr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves the state of an experiment.</span>

<span class="sd">        .. important::</span>
<span class="sd">            To be clear: this is about saving *state*, not logging diagnostics.</span>
<span class="sd">            All diagnostic logging is separate from this function. This function</span>
<span class="sd">            will save whatever is in ``state_dict``---usually just a copy of the</span>
<span class="sd">            environment---and the most recent parameters for the model you</span>
<span class="sd">            previously set up saving for with :meth:`setup_tf_saver` or</span>
<span class="sd">            :meth:`setup_pytorch_saver`.</span>

<span class="sd">        Call with any frequency you prefer. If you only want to maintain a</span>
<span class="sd">        single state and overwrite it at each call with the most recent</span>
<span class="sd">        version, leave ``itr=None``. If you want to keep all of the states you</span>
<span class="sd">        save, provide unique (increasing) values for &#39;itr&#39;.</span>

<span class="sd">        Args:</span>
<span class="sd">            state_dict (dict): Dictionary containing essential elements to</span>
<span class="sd">                describe the current state of training.</span>
<span class="sd">            itr (Union[int, None]): Current iteration of training (e.g. epoch). Defaults</span>
<span class="sd">                to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Save training state (environment, ...)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">state_path</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;vars.pkl&quot;</span><span class="p">)</span>
                <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">state_dict</span><span class="p">,</span> <span class="n">state_path</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_state_path</span> <span class="o">=</span> <span class="n">state_path</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">PicklingError</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Warning: could not pickle state_dict.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

            <span class="c1"># Save model state.</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_tf_saver_elements&quot;</span><span class="p">):</span>
                <span class="n">backend_folder_name</span> <span class="o">=</span> <span class="s2">&quot;tf2_save&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tf_save</span><span class="p">(</span><span class="n">itr</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_pytorch_saver_elements&quot;</span><span class="p">):</span>
                <span class="n">backend_folder_name</span> <span class="o">=</span> <span class="s2">&quot;torch_save&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_save</span><span class="p">(</span><span class="n">itr</span><span class="p">)</span>

            <span class="c1"># Save checkpoint state.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_checkpoints</span> <span class="ow">and</span> <span class="n">itr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">itr_name</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;iter</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">itr</span>
                    <span class="k">if</span> <span class="n">itr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="s2">&quot;iter&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">fdir</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span> <span class="n">backend_folder_name</span><span class="p">,</span> <span class="s2">&quot;checkpoints&quot;</span><span class="p">)</span>
                <span class="n">fpath</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fdir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">itr_name</span><span class="p">))</span>
                <span class="n">fname</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;vars.pkl&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">joblib</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">state_dict</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_state_checkpoints_dir_path</span> <span class="o">=</span> <span class="n">fdir</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="n">pickle</span><span class="o">.</span><span class="n">PicklingError</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Warning: could not pickle state_dict.&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.setup_tf_saver"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.setup_tf_saver">[docs]</a>    <span class="k">def</span> <span class="nf">setup_tf_saver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what_to_save</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up easy model saving for a single Tensorlow model.</span>

<span class="sd">        Args:</span>
<span class="sd">            what_to_save (object): Any Tensorflow model or serializable object</span>
<span class="sd">                containing TensorFlow models.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span> <span class="o">=</span> <span class="n">import_tf</span><span class="p">()</span>  <span class="c1"># Throw custom warning if tf is not installed.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tf_saver_elements</span> <span class="o">=</span> <span class="n">what_to_save</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Policy will be saved to &#39;</span><span class="si">{}</span><span class="s2">&#39;.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.setup_pytorch_saver"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.setup_pytorch_saver">[docs]</a>    <span class="k">def</span> <span class="nf">setup_pytorch_saver</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">what_to_save</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set up easy model saving for a single PyTorch model.</span>

<span class="sd">        Args:</span>
<span class="sd">            what_to_save (object): Any PyTorch model or serializable object containing</span>
<span class="sd">                PyTorch models.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_saver_elements</span> <span class="o">=</span> <span class="n">what_to_save</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Policy will be saved to &#39;</span><span class="si">{}</span><span class="s2">&#39;.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">),</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger._tf_save"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._tf_save">[docs]</a>    <span class="k">def</span> <span class="nf">_tf_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves the PyTorch model/models using their ``state_dict``.</span>

<span class="sd">        Args:</span>
<span class="sd">            itr (Union[int, None]): Current iteration of training (e.g. epoch). Defaults</span>
<span class="sd">                to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">save_fail_warning</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;The object you tried to save doesn&#39;t have a &#39;save_weights&#39; we &quot;</span>
                <span class="s2">&quot;can use to retrieve the model weights. Please make sure you supplied &quot;</span>
                <span class="s2">&quot;the &#39;setup_tf_saver&#39; method with a valid &#39;tf.keras.Model&#39; object &quot;</span>
                <span class="s2">&quot;or implemented a &#39;save_weights&#39; method on your object.&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_tf_saver_elements&quot;</span>
            <span class="p">),</span> <span class="s2">&quot;First have to setup saving with self.setup_tf_saver&quot;</span>

            <span class="c1"># Create filename.</span>
            <span class="n">fpath</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;tf2_save&quot;</span><span class="p">)</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;weights_checkpoint&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Create Checkpoints name.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_checkpoints</span> <span class="ow">and</span> <span class="n">itr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">itr_name</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;iter</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">itr</span>
                    <span class="k">if</span> <span class="n">itr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="s2">&quot;iter&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">cdir</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;checkpoints&quot;</span><span class="p">)</span>
                <span class="n">cpath</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cdir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">itr_name</span><span class="p">))</span>
                <span class="n">cname</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cpath</span><span class="p">,</span> <span class="s2">&quot;weights_checkpoint&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">cpath</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Save additional algorithm information.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_info_saved</span><span class="p">:</span>
                <span class="n">save_info</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;alg_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf_saver_elements</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tf_saver_elements</span><span class="p">,</span> <span class="s2">&quot;_setup_kwargs&quot;</span><span class="p">):</span>
                    <span class="n">save_info</span><span class="p">[</span><span class="s2">&quot;setup_kwargs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf_saver_elements</span><span class="o">.</span><span class="n">_setup_kwargs</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_to_json</span><span class="p">(</span>
                    <span class="n">save_info</span><span class="p">,</span>
                    <span class="n">output_filename</span><span class="o">=</span><span class="s2">&quot;save_info.json&quot;</span><span class="p">,</span>
                    <span class="n">output_path</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_info_saved</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_info_path</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;save_info.json&quot;</span><span class="p">)</span>

            <span class="c1"># Save model.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tf_saver_elements</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tf_saver_elements</span><span class="p">,</span> <span class="s2">&quot;save_weights&quot;</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tf_saver_elements</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_model_path</span> <span class="o">=</span> <span class="n">fname</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">save_fail_warning</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">)</span>

            <span class="c1"># Save checkpoint.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_checkpoints</span> <span class="ow">and</span> <span class="n">itr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tf_saver_elements</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">keras</span><span class="o">.</span><span class="n">Model</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_tf_saver_elements</span><span class="p">,</span> <span class="s2">&quot;save_weights&quot;</span>
                <span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_tf_saver_elements</span><span class="o">.</span><span class="n">save_weights</span><span class="p">(</span><span class="n">cname</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_model_checkpoints_dir_path</span> <span class="o">=</span> <span class="n">cdir</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">save_fail_warning</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># Increase epoch.</span></div>

<div class="viewcode-block" id="Logger._pytorch_save"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._pytorch_save">[docs]</a>    <span class="k">def</span> <span class="nf">_pytorch_save</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">itr</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves the PyTorch model/models using their ``state_dict``.</span>

<span class="sd">        Args:</span>
<span class="sd">            itr (Union[int, None]): Current iteration of training (e.g. epoch). Defaults</span>
<span class="sd">                to ``None``.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">proc_id</span><span class="p">()</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">save_fail_warning</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;The object you tried to save doesn&#39;t have a &#39;state_dict&#39; we can&quot;</span>
                <span class="s2">&quot;use to retrieve the model weights. Please make sure you supplied the &quot;</span>
                <span class="s2">&quot;&#39;setup_pytorch_saver&#39; method with a valid &#39;torch.nn.Module&#39; object or &quot;</span>
                <span class="s2">&quot;implemented a&#39;state_dict&#39; method on your object.&quot;</span>
            <span class="p">)</span>

            <span class="k">assert</span> <span class="nb">hasattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="s2">&quot;_pytorch_saver_elements&quot;</span>
            <span class="p">),</span> <span class="s2">&quot;First have to setup saving with self.setup_pytorch_saver&quot;</span>

            <span class="c1"># Create filename.</span>
            <span class="n">fpath</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span> <span class="s2">&quot;torch_save&quot;</span><span class="p">)</span>
            <span class="n">fname</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;model_state.pt&quot;</span><span class="p">)</span>
            <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Create Checkpoints Name.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_checkpoints</span> <span class="ow">and</span> <span class="n">itr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">itr_name</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="s2">&quot;iter</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">itr</span>
                    <span class="k">if</span> <span class="n">itr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="k">else</span> <span class="s2">&quot;iter&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span><span class="p">)</span>
                <span class="p">)</span>
                <span class="n">cdir</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;checkpoints&quot;</span><span class="p">)</span>
                <span class="n">cpath</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cdir</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">itr_name</span><span class="p">))</span>
                <span class="n">cname</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cpath</span><span class="p">,</span> <span class="s2">&quot;model_state.pt&quot;</span><span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">cpath</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

            <span class="c1"># Save additional algorithm information.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_info_saved</span><span class="p">:</span>
                <span class="n">save_info</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;alg_name&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_saver_elements</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span><span class="p">,</span>
                <span class="p">}</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_saver_elements</span><span class="p">,</span> <span class="s2">&quot;_setup_kwargs&quot;</span><span class="p">):</span>
                    <span class="n">save_info</span><span class="p">[</span><span class="s2">&quot;setup_kwargs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_saver_elements</span><span class="o">.</span><span class="n">_setup_kwargs</span>
                    <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">save_to_json</span><span class="p">(</span>
                    <span class="n">save_info</span><span class="p">,</span>
                    <span class="n">output_filename</span><span class="o">=</span><span class="s2">&quot;save_info.json&quot;</span><span class="p">,</span>
                    <span class="n">output_path</span><span class="o">=</span><span class="n">fpath</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_info_saved</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_save_info_path</span> <span class="o">=</span> <span class="n">osp</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">fpath</span><span class="p">,</span> <span class="s2">&quot;save_info.json&quot;</span><span class="p">)</span>

            <span class="c1"># Save model.</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_saver_elements</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_saver_elements</span><span class="p">,</span> <span class="s2">&quot;state_dict&quot;</span>
            <span class="p">):</span>
                <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_saver_elements</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">fname</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_model_path</span> <span class="o">=</span> <span class="n">fname</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">save_fail_warning</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">)</span>

            <span class="c1"># Save checkpoint.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_save_checkpoints</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_saver_elements</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">hasattr</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_saver_elements</span><span class="p">,</span> <span class="s2">&quot;state_dict&quot;</span>
                <span class="p">):</span>
                    <span class="n">torch</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pytorch_saver_elements</span><span class="o">.</span><span class="n">state_dict</span><span class="p">(),</span> <span class="n">cname</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">_model_checkpoints_dir_path</span> <span class="o">=</span> <span class="n">cdir</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">save_fail_warning</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">)</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_checkpoint</span> <span class="o">+=</span> <span class="mi">1</span>  <span class="c1"># Increase epoch.</span></div>

<div class="viewcode-block" id="Logger._write_to_tb"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._write_to_tb">[docs]</a>    <span class="k">def</span> <span class="nf">_write_to_tb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">var_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Writes data to TensorBoard log file.</span>

<span class="sd">        It currently works with scalars, histograms and images. For other data types</span>
<span class="sd">        please use :attr:`Logger.tb_writer`. directly.</span>

<span class="sd">        Args:</span>
<span class="sd">            var_name (str): Data identifier.</span>
<span class="sd">            data (Union[int, float, numpy.ndarray, torch.Tensor, tf.Tensor]): Data you</span>
<span class="sd">                want to write.</span>
<span class="sd">            global_step (int, optional): Global step value to record. Uses internal step</span>
<span class="sd">                counter if global step is not supplied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Try to write data to tb as as histogram.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="o">=</span> <span class="p">(</span>
                <span class="kc">True</span>  <span class="c1"># Property that creates tf writer if set to True.</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">is_scalar</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>  <span class="c1"># Extra protection since trying to write a list freezes tb.</span>
            <span class="k">try</span><span class="p">:</span>  <span class="c1"># Try to write as scalar.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_scalar</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span>
                <span class="ne">AssertionError</span><span class="p">,</span>
                <span class="ne">NotImplementedError</span><span class="p">,</span>
                <span class="ne">NameError</span><span class="p">,</span>
                <span class="ne">ValueError</span><span class="p">,</span>
                <span class="ne">TypeError</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="k">pass</span>
        <span class="c1"># NOTE: The options below are not yet used in the SLC but were added to show how</span>
        <span class="c1"># the logger can be extended to write other data types to TensorBoard.</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Try to write data to tb as as histogram.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_histogram</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span>
                <span class="ne">AssertionError</span><span class="p">,</span>
                <span class="ne">NotImplementedError</span><span class="p">,</span>
                <span class="ne">NameError</span><span class="p">,</span>
                <span class="ne">ValueError</span><span class="p">,</span>
                <span class="ne">TypeError</span><span class="p">,</span>
                <span class="ne">ImportError</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="k">pass</span>

            <span class="c1"># Try to write data as image.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_image</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span>
                <span class="ne">AssertionError</span><span class="p">,</span>
                <span class="ne">NotImplementedError</span><span class="p">,</span>
                <span class="ne">NameError</span><span class="p">,</span>
                <span class="ne">ValueError</span><span class="p">,</span>
                <span class="ne">TypeError</span><span class="p">,</span>
                <span class="ne">ImportError</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="k">pass</span>

            <span class="c1"># Try to write data as text.</span>
            <span class="c1"># NOTE: This should be the last option as the other objects can also contain</span>
            <span class="c1"># caffe2 identifier strings.</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_text</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span>
            <span class="k">except</span> <span class="p">(</span>
                <span class="ne">AssertionError</span><span class="p">,</span>
                <span class="ne">NotImplementedError</span><span class="p">,</span>
                <span class="ne">NameError</span><span class="p">,</span>
                <span class="ne">ValueError</span><span class="p">,</span>
                <span class="ne">TypeError</span><span class="p">,</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="s2">&quot;WARNING: Variable </span><span class="si">{}</span><span class="s2"> could &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">var_name</span><span class="o">.</span><span class="n">capitalize</span><span class="p">())</span>
                        <span class="o">+</span> <span class="s2">&quot;not be written to TensorBoard as the &#39;</span><span class="si">{}</span><span class="s2">&#39; &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span>
                        <span class="p">)</span>
                        <span class="o">+</span> <span class="s2">&quot;class does not yet support objects of type </span><span class="si">{}</span><span class="s2">.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                            <span class="nb">type</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="p">),</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">pass</span></div>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Logger.use_tensorboard"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.use_tensorboard">[docs]</a>    <span class="k">def</span> <span class="nf">use_tensorboard</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Variable specifying whether the logger uses TensorBoard. A TensorBoard writer</span>
<span class="sd">        is created on the :attr:`Logger.tb_writer` attribute when</span>
<span class="sd">        :attr:`~Logger.use_tensorboard` is set to ``True``</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tensorboard</span></div>

    <span class="nd">@use_tensorboard</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">use_tensorboard</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Custom setter that makes sure a TensorBoard writer is present on the</span>
<span class="sd">        :attr:`Logger.tb_writer` attribute when ``use_tensorboard`` is set to ``True``</span>
<span class="sd">        . This TensorBoard writer can be used to write to the TensorBoard.</span>

<span class="sd">        Args:</span>
<span class="sd">            value (bool): Whether you want to use TensorBoard logging.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_use_tensorboard</span> <span class="o">=</span> <span class="n">value</span>

        <span class="c1"># Create TensorBoard writer if use_tensorboard == True else delete.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tensorboard</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="p">:</span>  <span class="c1"># Create writer object.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Using TensorFlow as the TensorBoard backend.&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span> <span class="o">=</span> <span class="n">import_tf</span><span class="p">()</span>  <span class="c1"># Throw custom warning if tf is not installed.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">create_file_writer</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                    <span class="s2">&quot;Using Torch.utils.tensorboard as the TensorBoard backend.&quot;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">exp_name</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_name</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">exp_name</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span> <span class="o">=</span> <span class="n">SummaryWriter</span><span class="p">(</span>
                    <span class="n">log_dir</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">,</span>
                    <span class="n">comment</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">exp_name</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="si">}</span><span class="s2">-data_&quot;</span>
                    <span class="o">+</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">-%H%M%S&quot;</span><span class="p">),</span>
                <span class="p">)</span>
                <span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flush_tb_writer</span><span class="p">)</span>  <span class="c1"># Make sure all data is written.</span>
                <span class="n">atexit</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>  <span class="c1"># Make sure the writer is closed.</span>

            <span class="c1"># Add config TensorBoard.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_text</span><span class="p">(</span>
                    <span class="s2">&quot;Config&quot;</span><span class="p">,</span> <span class="n">dict_to_mdtable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tb_config</span><span class="p">),</span> <span class="n">global_step</span><span class="o">=</span><span class="mi">0</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                    <span class="s2">&quot;No hyper parameters found. Please ensure that you have called &quot;</span>
                    <span class="s2">&quot;the &#39;save_config&#39; method of the &#39;ExperimentLogger&#39; class &quot;</span>
                    <span class="s2">&quot;if you want to have the used hyper parameters written to &quot;</span><span class="p">,</span>
                    <span class="s2">&quot;TensorBoard.&quot;</span><span class="p">,</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">elif</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tensorboard</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="p">:</span>  <span class="c1"># Delete TensorBoard writer.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">flush_tb_writer</span><span class="p">()</span>  <span class="c1"># Make sure all data is written.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># Close writer.</span>
            <span class="n">atexit</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">flush_tb_writer</span><span class="p">)</span>  <span class="c1"># Make sure the writer is closed.</span>
            <span class="n">atexit</span><span class="o">.</span><span class="n">unregister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">close</span><span class="p">)</span>  <span class="c1"># Make sure the writer is closed.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Logger.log_current_row"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.log_current_row">[docs]</a>    <span class="k">def</span> <span class="nf">log_current_row</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the current row of the logger.&quot;&quot;&quot;</span>
        <span class="n">log_current_row</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_log_current_row</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">log_current_row</span></div>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Logger._global_step"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._global_step">[docs]</a>    <span class="k">def</span> <span class="nf">_global_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the current estimated global step count.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">max</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_step_count_dict</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">+</span> <span class="p">[</span><span class="mi">0</span><span class="p">])</span></div>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Weights &amp; Biases related methods.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Logger._wandb_config"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._wandb_config">[docs]</a>    <span class="k">def</span> <span class="nf">_wandb_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform the config to a format that looks better on Weights &amp; Biases.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">convert_to_wandb_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Logger.watch_model_in_wandb"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.watch_model_in_wandb">[docs]</a>    <span class="k">def</span> <span class="nf">watch_model_in_wandb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Watch model parameters in Weights &amp; Biases.</span>

<span class="sd">        Args:</span>
<span class="sd">            model (torch.nn.Module): Model to watch on Weights &amp; Biases.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
                    <span class="p">(</span>
                        <span class="s2">&quot;WARNING: Model could not be watched on Weights &amp; Biases as &quot;</span>
                        <span class="sa">f</span><span class="s2">&quot;the &#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">model</span><span class="p">)</span><span class="si">}</span><span class="s2">&#39; class is not yet supported.&quot;</span>
                    <span class="p">),</span>
                    <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;warning&quot;</span><span class="p">,</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="Logger._log_wandb_artifacts"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._log_wandb_artifacts">[docs]</a>    <span class="k">def</span> <span class="nf">_log_wandb_artifacts</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log all stored artifacts to Weights &amp; Biases.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="p">:</span>
            <span class="c1"># Log configuration artifacts</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config_file_path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_file_path</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config_file_path</span><span class="p">)</span>

            <span class="c1"># Log progress artifacts.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output_file_path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_file_path</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="p">[</span><span class="s2">&quot;progress&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_output_file_path</span><span class="p">)</span>

            <span class="c1"># Log training state artifacts.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_state_path</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_state_path</span><span class="p">)</span>

            <span class="c1"># Log training state checkpoints artifacts.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_state_checkpoints_dir_path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_state_checkpoints_dir_path</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="p">[</span><span class="s2">&quot;state&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_state_checkpoints_dir_path</span><span class="p">)</span>

            <span class="c1"># Log model artifacts.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_model_path</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_model_path</span><span class="p">)</span>

            <span class="c1"># Log model checkpoints artifacts.</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_model_checkpoints_dir_path</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_model_checkpoints_dir_path</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="p">[</span><span class="s2">&quot;model&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">add_dir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_model_checkpoints_dir_path</span><span class="p">)</span>

            <span class="c1"># Log all artifacts to Weights &amp; Biases.</span>
            <span class="k">for</span> <span class="n">artifact</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_wandb_artifacts</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">wandb</span><span class="o">.</span><span class="n">log_artifact</span><span class="p">(</span><span class="n">artifact</span><span class="p">)</span></div>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;TensorBoard related methods</span>
<span class="sd">    Below are several wrapper methods which make the TensorBoard writer methods</span>
<span class="sd">    available directly on the :class:`EpochLogger` class.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Logger._tb_config"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._tb_config">[docs]</a>    <span class="k">def</span> <span class="nf">_tb_config</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Modify the config to a format that looks better on Tensorboard.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">convert_to_tb_config</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">None</span></div>

    <span class="nd">@property</span>
<div class="viewcode-block" id="Logger._tb_hparams"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._tb_hparams">[docs]</a>    <span class="k">def</span> <span class="nf">_tb_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Transform the config to a format that is accepted as hyper parameters by</span>
<span class="sd">        TensorBoard.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_config</span><span class="p">:</span>
            <span class="n">tb_config</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tb_config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">TB_HPARAMS_FILTER</span> <span class="ow">and</span> <span class="n">value</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">type</span><span class="p">):</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="n">value</span><span class="o">.</span><span class="vm">__module__</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">value</span><span class="o">.</span><span class="vm">__name__</span>
                    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">int</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">)):</span>
                        <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                    <span class="n">tb_config</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">return</span> <span class="n">tb_config</span>
        <span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Logger._log_tb_hparams"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.Logger._log_tb_hparams">[docs]</a>    <span class="k">def</span> <span class="nf">_log_tb_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log hyper parameters together with final metrics to TensorBoard.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tb_hparams</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_metrics</span><span class="p">:</span>
            <span class="c1"># Log hyper parameters and metrics.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_hparams</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tb_hparams</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_last_metrics</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.log_model_to_tb"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.log_model_to_tb">[docs]</a>    <span class="k">def</span> <span class="nf">log_model_to_tb</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">input_to_model</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add model to tb summary.</span>

<span class="sd">        Wrapper that calls the :obj:`torch.utils.tensorboard.SummaryWriter.add_graph`</span>
<span class="sd">        or :obj:`tf.summary.graph` (depending on the backend) method while first making</span>
<span class="sd">        sure a SummaryWriter object exits.</span>

<span class="sd">        Args:</span>
<span class="sd">            model (union[torch.nn.Module, tf.keras.Model]): Model to add to the summary.</span>
<span class="sd">            input_to_model (union[torch.Tensor, tf.Tensor]): Input tensor to the model.</span>
<span class="sd">            *args: All args to pass to the Summary/SummaryWriter object.</span>
<span class="sd">            **kwargs: All kwargs to pass to the Summary/SummaryWriter object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Make sure SummaryWriter exists.</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>
                <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;global_step&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">trace_on</span><span class="p">(</span><span class="n">graph</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                <span class="n">model</span><span class="p">(</span><span class="n">input_to_model</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">trace_export</span><span class="p">(</span>
                    <span class="s2">&quot;model&quot;</span><span class="p">,</span>
                    <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_graph</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">input_to_model</span><span class="o">=</span><span class="n">input_to_model</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.add_tb_scalar"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.add_tb_scalar">[docs]</a>    <span class="k">def</span> <span class="nf">add_tb_scalar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add scalar to tb summary.</span>

<span class="sd">        Wrapper that calls the :obj:`torch.utils.tensorboard.SummaryWriter.add_scalar`</span>
<span class="sd">        or :obj:`tf.summary.scalar` (depending on the backend) method while first making</span>
<span class="sd">        sure a SummaryWriter object exits. These methods can be used to add a scalar</span>
<span class="sd">        to the summary.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the Summary/SummaryWriter object.</span>
<span class="sd">            **kwargs: All kwargs to pass to the Summary/SummaryWriter object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Make sure SummaryWriter exists.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;global_step&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">scalar</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">add_scalar</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.tb_scalar"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.tb_scalar">[docs]</a>    <span class="k">def</span> <span class="nf">tb_scalar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper for making the :meth:`add_tb_scalar` method available directly under</span>
<span class="sd">        the ``scalar`` alias.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the :meth:`add_tb_scalar` method.</span>
<span class="sd">            **kwargs: All kwargs to pass to the :meth:`add_tb_scalar` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_scalar</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.add_tb_histogram"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.add_tb_histogram">[docs]</a>    <span class="k">def</span> <span class="nf">add_tb_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add histogram to tb summary.</span>

<span class="sd">        Wrapper that calls the</span>
<span class="sd">        :obj:`torch.utils.tensorboard.SummaryWriter.add_histogram` or</span>
<span class="sd">        :obj:`tf.summary.histogram` (depending on the backend) method while first making</span>
<span class="sd">        sure a SummaryWriter object exits. These methods can be used to add a histogram</span>
<span class="sd">        to the summary.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the Summary/SummaryWriter object.</span>
<span class="sd">            **kwargs: All kwargs to pass to the Summary/SummaryWriter object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Make sure SummaryWriter exists.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;global_step&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">add_histogram</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.tb_histogram"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.tb_histogram">[docs]</a>    <span class="k">def</span> <span class="nf">tb_histogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper for making the :meth:`add_tb_histogram` method available directly</span>
<span class="sd">        under the ``tb_histogram`` alias.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the :meth:`add_tb_histogram` method.</span>
<span class="sd">            **kwargs: All kwargs to pass to the :meth:`add_tb_histogram` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_histogram</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.add_tb_image"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.add_tb_image">[docs]</a>    <span class="k">def</span> <span class="nf">add_tb_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add image to tb summary.</span>

<span class="sd">        Wrapper that calls the :obj:`torch.utils.tensorboard.SummaryWriter.add_image`</span>
<span class="sd">        or :obj:`tf.summary.image` (depending on the backend) method while first making</span>
<span class="sd">        sure a SummaryWriter object exits. These methods can be used to add a image</span>
<span class="sd">        to the summary.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the Summary/SummaryWriter object.</span>
<span class="sd">            **kwargs: All kwargs to pass to the Summary/SummaryWriter object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Make sure SummaryWriter exists.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;global_step&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">image</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.tb_image"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.tb_image">[docs]</a>    <span class="k">def</span> <span class="nf">tb_image</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper for making the :meth:`add_tb_image` method available directly under</span>
<span class="sd">        the ``tb_image`` alias.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the :meth:`add_tb_image` method.</span>
<span class="sd">            **kwargs: All kwargs to pass to the :meth:`add_tb_image` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_image</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.add_tb_text"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.add_tb_text">[docs]</a>    <span class="k">def</span> <span class="nf">add_tb_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add text to tb summary.</span>

<span class="sd">        Wrapper that calls the</span>
<span class="sd">        :obj:`torch.utils.tensorboard.SummaryWriter.add_text` or</span>
<span class="sd">        :obj:`tf.summary.add_text` (depending on the backend) method while first making</span>
<span class="sd">        sure a SummaryWriter object exits. These methods can be used to add text</span>
<span class="sd">        to the summary.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the Summary/SummaryWriter object.</span>
<span class="sd">            **kwargs: All kwargs to pass to the Summary/SummaryWriter object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Make sure SummaryWriter exists.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;global_step&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">add_text</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.tb_text"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.tb_text">[docs]</a>    <span class="k">def</span> <span class="nf">tb_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper for making the :meth:`add_tb_text` method available directly under</span>
<span class="sd">        the ``text`` alias.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the :meth:`add_tb_text` method.</span>
<span class="sd">            **kwargs: All kwargs to pass to the :meth:`add_tb_text` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_text</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.add_tb_graph"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.add_tb_graph">[docs]</a>    <span class="k">def</span> <span class="nf">add_tb_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Add graph to tb summary.</span>

<span class="sd">        Wrapper that calls the :obj:`torch.utils.tensorboard.SummaryWriter.add_graph`</span>
<span class="sd">        or :obj:`tf.summary.add_graph` (depending on the backend) method while first</span>
<span class="sd">        making sure a SummaryWriter object exits. These methods can be used to add a</span>
<span class="sd">        graph to the summary.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the Summary/SummaryWriter object.</span>
<span class="sd">            **kwargs: All kwargs to pass to the Summary/SummaryWriter object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;step&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;global_step&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span><span class="p">)</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">graph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">add_graph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.tb_graph"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.tb_graph">[docs]</a>    <span class="k">def</span> <span class="nf">tb_graph</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Wrapper for making the :meth:`add_tb_graph` method available directly under</span>
<span class="sd">        the ``tb_graph`` alias.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the :meth:`add_tb_graph` method.</span>
<span class="sd">            **kwargs: All kwargs to pass to the :meth:`add_tb_graph` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_tb_graph</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.add_tb_hparams"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.add_tb_hparams">[docs]</a>    <span class="k">def</span> <span class="nf">add_tb_hparams</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds hyper parameters to tb summary.</span>

<span class="sd">        Wrapper that calls the :obj:`torch.utils.tensorboard.SummaryWriter.add_hparams`</span>
<span class="sd">        method while first making sure a SummaryWriter object exits. The ``add_hparams``</span>
<span class="sd">        method adds a set of hyperparameters to be compared in TensorBoard.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the Summary/SummaryWriter object.</span>
<span class="sd">            **kwargs: All kwargs to pass to the Summary/SummaryWriter object.</span>

<span class="sd">        Raises:</span>
<span class="sd">            NotImplementedError: Raised if you try to call this method when using the</span>
<span class="sd">                TensorFlow backend.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Make sure SummaryWriter exists.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span>
                <span class="s2">&quot;The &#39;add_tb_hparams&#39; method is not available when using the &quot;</span>
                <span class="s2">&quot;&#39;tensorflow&#39; backend.&quot;</span>
            <span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">add_hparams</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="Logger.flush_tb_writer"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.Logger.flush_tb_writer">[docs]</a>    <span class="k">def</span> <span class="nf">flush_tb_writer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Flush tb event file to disk.</span>


<span class="sd">        Wrapper that calls the</span>
<span class="sd">        :obj:`torch.utils.tensorboard.SummaryWriter.flush` or</span>
<span class="sd">        :obj:`tf.summary.flush` (depending on the backend) method while first making</span>
<span class="sd">        sure a SummaryWriter object exits. These methods can be used to flush the event</span>
<span class="sd">        file to disk.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to the Summary/SummaryWriter object.</span>
<span class="sd">            **kwargs: All kwargs to pass to the Summary/SummaryWriter object.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">use_tensorboard</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># Make sure SummaryWriter exists.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_use_tf_backend</span><span class="p">:</span>
            <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">as_default</span><span class="p">():</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tf</span><span class="o">.</span><span class="n">summary</span><span class="o">.</span><span class="n">flush</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tb_writer</span><span class="o">.</span><span class="n">flush</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="EpochLogger"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.EpochLogger">[docs]</a><span class="k">class</span> <span class="nc">EpochLogger</span><span class="p">(</span><span class="n">Logger</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A variant of :class:`Logger` tailored for tracking average values over epochs.</span>

<span class="sd">    **Typical use case:** there is some quantity which is calculated many times</span>
<span class="sd">    throughout an epoch, and at the end of the epoch, you would like to</span>
<span class="sd">    report the average/std/min/max value of that quantity.</span>

<span class="sd">    With an EpochLogger, each time the quantity is calculated, you would</span>
<span class="sd">    use</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        epoch_logger.store(NameOfQuantity=quantity_value)</span>

<span class="sd">    to load it into the EpochLogger&#39;s state. Then at the end of the epoch, you</span>
<span class="sd">    would use</span>

<span class="sd">    .. code-block:: python</span>

<span class="sd">        epoch_logger.log_tabular(NameOfQuantity, **options)</span>

<span class="sd">    to record the desired values.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        epoch_dict (dict): Dictionary used to store variables you want to log into the</span>
<span class="sd">           :class:`EpochLogger` current state.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise a EpochLogger.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<div class="viewcode-block" id="EpochLogger.epoch_dict"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.EpochLogger.epoch_dict">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span></div>
<div class="viewcode-block" id="EpochLogger._tb_index_dict"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.EpochLogger._tb_index_dict">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_tb_index_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span></div>
<div class="viewcode-block" id="EpochLogger._n_table_dumps"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.EpochLogger._n_table_dumps">[docs]</a>        <span class="bp">self</span><span class="o">.</span><span class="n">_n_table_dumps</span> <span class="o">=</span> <span class="mi">0</span></div>

<div class="viewcode-block" id="EpochLogger.store"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.EpochLogger.store">[docs]</a>    <span class="k">def</span> <span class="nf">store</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">tb_write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">tb_aliases</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
        <span class="n">extend</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">global_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="o">**</span><span class="n">kwargs</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Save something into the :class:`EpochLogger`&#39;s current state.</span>

<span class="sd">        Provide an arbitrary number of keyword arguments with numerical</span>
<span class="sd">        values.</span>

<span class="sd">        Args:</span>
<span class="sd">            tb_write (Union[bool, dict], optional): Boolean or dict of key boolean pairs</span>
<span class="sd">                specifying whether you also want to write the value to the TensorBoard</span>
<span class="sd">                logfile. Defaults to ``False``.</span>
<span class="sd">            tb_aliases (dict, optional): Dictionary that can be used to set aliases for</span>
<span class="sd">                the variables you want to store. Defaults to empty :obj:`dict`.</span>
<span class="sd">            extend (bool, optional): Boolean specifying whether you want to extend the</span>
<span class="sd">                values to the log buffer. By default ``False`` meaning the values are</span>
<span class="sd">                appended to the buffer.</span>
<span class="sd">            global_step (int, optional): Global step value to record. Uses internal step</span>
<span class="sd">                counter if global step is not supplied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="c1"># Store variable values in epoch_dict and increase global step count.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_step_count_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">extend</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

            <span class="c1"># Increase the step count for all the keys.</span>
            <span class="c1"># NOTE: This is done in such a way that two values of a given key do not</span>
            <span class="c1"># get the same global step value assigned to them.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_step_count_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_step_count_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_step_count_dict</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span>
                <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span>
            <span class="p">)</span>

            <span class="c1"># Check if a alias was given for the current parameter.</span>
            <span class="n">var_name</span> <span class="o">=</span> <span class="n">k</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">tb_aliases</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="n">tb_aliases</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>

            <span class="c1"># Write variable value to TensorBoard.</span>
            <span class="n">tb_write_key</span> <span class="o">=</span> <span class="p">(</span>
                <span class="p">(</span><span class="n">tb_write</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">tb_write</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">else</span> <span class="kc">False</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tb_write</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span>
                <span class="k">else</span> <span class="n">tb_write</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">tb_write_key</span><span class="p">:</span>
                <span class="n">global_step</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">global_step</span> <span class="k">if</span> <span class="n">global_step</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span>
                <span class="p">)</span>  <span class="c1"># Use internal counter if global_step is None.</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_write_to_tb</span><span class="p">(</span><span class="n">var_name</span><span class="p">,</span> <span class="n">v</span><span class="p">,</span> <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">)</span></div>

<div class="viewcode-block" id="EpochLogger.log_to_tb"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.EpochLogger.log_to_tb">[docs]</a>    <span class="k">def</span> <span class="nf">log_to_tb</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">keys</span><span class="p">,</span>
        <span class="n">val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">with_min_and_max</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">average_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">tb_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tb_alias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">global_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Log a diagnostic to TensorBoard. This function takes or a list of keys or a</span>
<span class="sd">        key-value pair. If only keys are supplied, averages will be calculated using</span>
<span class="sd">        the new data found in the Loggers internal storage. If a key-value pair is</span>
<span class="sd">        supplied, this pair will be directly logged to TensorBoard.</span>

<span class="sd">        Args:</span>
<span class="sd">            keys (Union[list[str], str]): The name(s) of the diagnostic.</span>
<span class="sd">            val: A value for the diagnostic.</span>
<span class="sd">            with_min_and_max (bool): If ``True``, log min and max values of the</span>
<span class="sd">                diagnostic.</span>
<span class="sd">            average_only (bool): If ``True``, do not log the standard deviation</span>
<span class="sd">                of the diagnostic.</span>
<span class="sd">            tb_prefix(str, optional): A prefix which can be added to group the</span>
<span class="sd">                variables.</span>
<span class="sd">            tb_alias (str, optional): A tb alias for the variable you want to store</span>
<span class="sd">                store. Defaults to empty :obj:`dict`. If not supplied the variable name</span>
<span class="sd">                is used.</span>
<span class="sd">            global_step (int, optional): Global step value to record. Uses internal step</span>
<span class="sd">                counter if global step is not supplied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># When key and value are supplied use direct write.</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">log_to_tb</span><span class="p">(</span>
                <span class="n">keys</span><span class="p">,</span>
                <span class="n">val</span><span class="p">,</span>
                <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span><span class="p">,</span>
                <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
                <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># When only keys are supplied use internal storage.</span>
            <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="n">keys</span><span class="p">]</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="k">else</span> <span class="n">keys</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">global_step</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># Retrieve global step if not supplied.</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_n_table_dumps</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">:</span>
                        <span class="n">global_step_tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_global_step</span>
                    <span class="k">elif</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                        <span class="n">global_step_tmp</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">global_step_tmp</span> <span class="o">=</span> <span class="n">global_step</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">_log_tb_diagnostics</span><span class="p">(</span>
                    <span class="n">key</span><span class="p">,</span>
                    <span class="n">with_min_and_max</span><span class="o">=</span><span class="n">with_min_and_max</span><span class="p">,</span>
                    <span class="n">average_only</span><span class="o">=</span><span class="n">average_only</span><span class="p">,</span>
                    <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span><span class="p">,</span>
                    <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
                    <span class="n">global_step</span><span class="o">=</span><span class="n">global_step_tmp</span><span class="p">,</span>
                <span class="p">)</span></div>

<div class="viewcode-block" id="EpochLogger.log_tabular"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.EpochLogger.log_tabular">[docs]</a>    <span class="k">def</span> <span class="nf">log_tabular</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">,</span>
        <span class="n">val</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">with_min_and_max</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">average_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">tb_write</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">tb_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tb_alias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Log a value or possibly the mean/std/min/max values of a diagnostic.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The name of the diagnostic. If you are logging a</span>
<span class="sd">                diagnostic whose state has previously been saved with</span>
<span class="sd">                :meth:`store`, the key here has to match the key you used there.</span>
<span class="sd">            val: A value for the diagnostic. If you have previously saved</span>
<span class="sd">                values for this key via :meth:`store`, do *not* provide a ``val``</span>
<span class="sd">                here.</span>
<span class="sd">            with_min_and_max (bool): If ``True``, log min and max values of the</span>
<span class="sd">                diagnostic over the epoch.</span>
<span class="sd">            average_only (bool): If ``True``, do not log the standard deviation</span>
<span class="sd">                of the diagnostic over the epoch.</span>
<span class="sd">            tb_write (bool, optional): Boolean specifying whether you also want to write</span>
<span class="sd">                the value to the TensorBoard logfile. Defaults to False.</span>
<span class="sd">            tb_prefix(str, optional): A prefix which can be added to group the</span>
<span class="sd">                variables.</span>
<span class="sd">            tb_alias (str, optional): A tb alias for the variable you want to store</span>
<span class="sd">                store. Defaults to empty :obj:`dict`. If not supplied the variable name</span>
<span class="sd">                is used.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">val</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span>
                <span class="n">key</span><span class="p">,</span>
                <span class="n">val</span><span class="p">,</span>
                <span class="n">tb_write</span><span class="o">=</span><span class="n">tb_write</span><span class="p">,</span>
                <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span><span class="p">,</span>
                <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="n">vals</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
                <span class="k">else</span> <span class="n">v</span>
            <span class="p">)</span>
            <span class="n">stats</span> <span class="o">=</span> <span class="n">mpi_statistics_scalar</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">with_min_and_max</span><span class="o">=</span><span class="n">with_min_and_max</span><span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span>
                <span class="s2">&quot;Average&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">,</span>
                <span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
                <span class="n">tb_write</span><span class="o">=</span><span class="n">tb_write</span><span class="p">,</span>
                <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span> <span class="o">+</span> <span class="s2">&quot;/Average&quot;</span> <span class="k">if</span> <span class="n">tb_prefix</span> <span class="k">else</span> <span class="s2">&quot;Average&quot;</span><span class="p">,</span>
                <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">average_only</span><span class="p">):</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span>
                    <span class="s2">&quot;Std&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">,</span>
                    <span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                    <span class="n">tb_write</span><span class="o">=</span><span class="n">tb_write</span><span class="p">,</span>
                    <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span> <span class="o">+</span> <span class="s2">&quot;/Std&quot;</span> <span class="k">if</span> <span class="n">tb_prefix</span> <span class="k">else</span> <span class="s2">&quot;Std&quot;</span><span class="p">,</span>
                    <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">if</span> <span class="n">with_min_and_max</span><span class="p">:</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span>
                    <span class="s2">&quot;Max&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">,</span>
                    <span class="n">stats</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                    <span class="n">tb_write</span><span class="o">=</span><span class="n">tb_write</span><span class="p">,</span>
                    <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span> <span class="o">+</span> <span class="s2">&quot;/Max&quot;</span> <span class="k">if</span> <span class="n">tb_prefix</span> <span class="k">else</span> <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
                    <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span>
                    <span class="s2">&quot;Min&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">,</span>
                    <span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                    <span class="n">tb_write</span><span class="o">=</span><span class="n">tb_write</span><span class="p">,</span>
                    <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span> <span class="o">+</span> <span class="s2">&quot;/Min&quot;</span> <span class="k">if</span> <span class="n">tb_prefix</span> <span class="k">else</span> <span class="s2">&quot;Min&quot;</span><span class="p">,</span>
                    <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
                <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span></div>

<div class="viewcode-block" id="EpochLogger.dump_tabular"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.EpochLogger.dump_tabular">[docs]</a>    <span class="k">def</span> <span class="nf">dump_tabular</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Small wrapper around the :meth:`Logger.dump_tabular` method which</span>
<span class="sd">        makes sure that the TensorBoard index track dictionary is reset after the table</span>
<span class="sd">        is dumped.</span>

<span class="sd">        Args:</span>
<span class="sd">            *args: All args to pass to parent method.</span>
<span class="sd">            **kwargs: All kwargs to pass to parent method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">dump_tabular</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_n_table_dumps</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tb_index_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tb_index_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="p">}</span>  <span class="c1"># Reset TensorBoard logging index storage dict.</span></div>

<div class="viewcode-block" id="EpochLogger.get_stats"><a class="viewcode-back" href="../../../../utils/loggers.html#stable_learning_control.utils.log_utils.EpochLogger.get_stats">[docs]</a>    <span class="k">def</span> <span class="nf">get_stats</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Lets an algorithm ask the logger for mean/std/min/max of a diagnostic.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (str): The key for which you want to get the stats.</span>

<span class="sd">        Returns:</span>
<span class="sd">            (tuple): tuple containing:</span>

<span class="sd">                - mean(:obj:`float`): The current mean value.</span>
<span class="sd">                - std(:obj:`float`): The current  mean standard deviation.</span>
<span class="sd">                - min(:obj:`float`): The current mean value.</span>
<span class="sd">                - max(:obj:`float`): The current mean value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="n">v</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">mpi_statistics_scalar</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span></div>

<div class="viewcode-block" id="EpochLogger._log_tb_diagnostics"><a class="viewcode-back" href="../../../../autoapi/stable_learning_control/utils/log_utils/logx/index.html#stable_learning_control.utils.log_utils.EpochLogger._log_tb_diagnostics">[docs]</a>    <span class="k">def</span> <span class="nf">_log_tb_diagnostics</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">key</span><span class="p">,</span>
        <span class="n">with_min_and_max</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">average_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">tb_prefix</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">tb_alias</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">global_step</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculates the diagnostics of a given key from all the new data found in the</span>
<span class="sd">        Loggers internal storage.</span>

<span class="sd">        Args:</span>
<span class="sd">            key (Union[list[str], str]): The name of the diagnostic.</span>
<span class="sd">            with_min_and_max (bool): If ``True``, log min and max values of the</span>
<span class="sd">                diagnostic.</span>
<span class="sd">            average_only (bool): If ``True``, do not log the standard deviation</span>
<span class="sd">                of the diagnostic.</span>
<span class="sd">            tb_prefix(str, optional): A prefix which can be added to group the</span>
<span class="sd">                variables.</span>
<span class="sd">            tb_alias (str, optional): A tb alias for the variable you want to store</span>
<span class="sd">                store. Defaults to empty :obj:`dict`. If not supplied the variable name</span>
<span class="sd">                is used.</span>
<span class="sd">            global_step (int, optional): Global step value to record. Uses internal step</span>
<span class="sd">                counter if global step is not supplied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tb_index_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tb_index_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">v</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epoch_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
        <span class="n">vals</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_tb_index_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">:])</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span>
            <span class="k">else</span> <span class="n">v</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_tb_index_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="p">:]</span>
        <span class="p">)</span>
        <span class="n">stats</span> <span class="o">=</span> <span class="n">mpi_statistics_scalar</span><span class="p">(</span><span class="n">vals</span><span class="p">,</span> <span class="n">with_min_and_max</span><span class="o">=</span><span class="n">with_min_and_max</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">log_to_tb</span><span class="p">(</span>
            <span class="s2">&quot;Average&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">,</span>
            <span class="n">stats</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span> <span class="o">+</span> <span class="s2">&quot;/Average&quot;</span> <span class="k">if</span> <span class="n">tb_prefix</span> <span class="k">else</span> <span class="s2">&quot;Average&quot;</span><span class="p">,</span>
            <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
            <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">average_only</span><span class="p">):</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">log_to_tb</span><span class="p">(</span>
                <span class="s2">&quot;Std&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">,</span>
                <span class="n">stats</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
                <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span> <span class="o">+</span> <span class="s2">&quot;/Std&quot;</span> <span class="k">if</span> <span class="n">tb_prefix</span> <span class="k">else</span> <span class="s2">&quot;Std&quot;</span><span class="p">,</span>
                <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
                <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="k">if</span> <span class="n">with_min_and_max</span><span class="p">:</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">log_to_tb</span><span class="p">(</span>
                <span class="s2">&quot;Max&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">,</span>
                <span class="n">stats</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span>
                <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span> <span class="o">+</span> <span class="s2">&quot;/Max&quot;</span> <span class="k">if</span> <span class="n">tb_prefix</span> <span class="k">else</span> <span class="s2">&quot;Max&quot;</span><span class="p">,</span>
                <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
                <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">log_to_tb</span><span class="p">(</span>
                <span class="s2">&quot;Min&quot;</span> <span class="o">+</span> <span class="n">key</span><span class="p">,</span>
                <span class="n">stats</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                <span class="n">tb_prefix</span><span class="o">=</span><span class="n">tb_prefix</span> <span class="o">+</span> <span class="s2">&quot;/Min&quot;</span> <span class="k">if</span> <span class="n">tb_prefix</span> <span class="k">else</span> <span class="s2">&quot;Min&quot;</span><span class="p">,</span>
                <span class="n">tb_alias</span><span class="o">=</span><span class="n">tb_alias</span><span class="p">,</span>
                <span class="n">global_step</span><span class="o">=</span><span class="n">global_step</span><span class="p">,</span>
            <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tb_index_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">+=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vals</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Rick Staa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>