<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Running Experiments &mdash; stable-learning-control 6.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../_static/css/modify.css?v=519ed47b" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=9497d378"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Hyperparameter Tuning" href="hyperparameter_tuning.html" />
    <link rel="prev" title="Soft Actor-Critic" href="algorithms/sac.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                6.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Use with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">Available Agents</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Running Experiments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#launching-from-the-command-line">Launching from the Command Line</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#choosing-pytorch-or-tensorflow-from-the-command-line">Choosing PyTorch or TensorFlow from the Command Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="#setting-hyperparameters-from-the-command-line">Setting Hyperparameters from the Command Line</a></li>
<li class="toctree-l3"><a class="reference internal" href="#launching-multiple-experiments-at-once">Launching Multiple Experiments at Once</a></li>
<li class="toctree-l3"><a class="reference internal" href="#special-flags">Special Flags</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#environment-flags">Environment Flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="#algorithm-flags">Algorithm Flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="#config-flags">Config Flags</a></li>
<li class="toctree-l4"><a class="reference internal" href="#logger-flags">Logger Flags</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#using-experimental-configuration-files-yaml">Using experimental configuration files (yaml)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#where-results-are-saved">Where Results are Saved</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#how-is-suffix-determined">How is Suffix Determined?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#extra">Extra</a></li>
<li class="toctree-l3"><a class="reference internal" href="#use-transfer-learning">Use transfer learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-custom-environments">Using custom environments</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#launching-from-scripts">Launching from Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#using-experimentgrid">Using ExperimentGrid</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="hyperparameter_tuning.html">Hyperparameter Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="saving_and_loading.html">Experiment Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">Plotting Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="eval_robustness.html">Evaluating Robustness</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmarks.html">Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utils/loggers.html">Loggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/mpi.html">MPI Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/run_utils.html">Run Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/plotter.html">Plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/testers.html">Policy testers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/contributing.html">Contribute to stable-learning-control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/doc_dev.html">Build the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../autoapi/index.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Etc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../etc/acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">stable-learning-control</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Running Experiments</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/rickstaa/stable-learning-control/blob/main/docs/source/usage/running.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="running-experiments">
<span id="id1"></span><h1><a class="toc-backref" href="#id3" role="doc-backlink">Running Experiments</a><a class="headerlink" href="#running-experiments" title="Permalink to this heading"></a></h1>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#running-experiments" id="id3">Running Experiments</a></p>
<ul>
<li><p><a class="reference internal" href="#launching-from-the-command-line" id="id4">Launching from the Command Line</a></p>
<ul>
<li><p><a class="reference internal" href="#choosing-pytorch-or-tensorflow-from-the-command-line" id="id5">Choosing PyTorch or TensorFlow from the Command Line</a></p></li>
<li><p><a class="reference internal" href="#setting-hyperparameters-from-the-command-line" id="id6">Setting Hyperparameters from the Command Line</a></p></li>
<li><p><a class="reference internal" href="#launching-multiple-experiments-at-once" id="id7">Launching Multiple Experiments at Once</a></p></li>
<li><p><a class="reference internal" href="#special-flags" id="id8">Special Flags</a></p>
<ul>
<li><p><a class="reference internal" href="#environment-flags" id="id9">Environment Flags</a></p></li>
<li><p><a class="reference internal" href="#algorithm-flags" id="id10">Algorithm Flags</a></p>
<ul>
<li><p><a class="reference internal" href="#general-flags" id="id11">General Flags</a></p></li>
<li><p><a class="reference internal" href="#shortcut-flags" id="id12">Shortcut Flags</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#config-flags" id="id13">Config Flags</a></p></li>
<li><p><a class="reference internal" href="#logger-flags" id="id14">Logger Flags</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#using-experimental-configuration-files-yaml" id="id15">Using experimental configuration files (yaml)</a></p></li>
<li><p><a class="reference internal" href="#where-results-are-saved" id="id16">Where Results are Saved</a></p>
<ul>
<li><p><a class="reference internal" href="#how-is-suffix-determined" id="id17">How is Suffix Determined?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#extra" id="id18">Extra</a></p></li>
<li><p><a class="reference internal" href="#use-transfer-learning" id="id19">Use transfer learning</a></p></li>
<li><p><a class="reference internal" href="#using-custom-environments" id="id20">Using custom environments</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#launching-from-scripts" id="id21">Launching from Scripts</a></p>
<ul>
<li><p><a class="reference internal" href="#using-experimentgrid" id="id22">Using ExperimentGrid</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<p>One of the best ways to get a feel for deep RL is to run the algorithms and see how they
perform on different tasks. The SLC library makes small-scale (local) experiments easy to
do, and in this section, we’ll discuss two ways to run them: either from the command line
or through function calls in scripts.</p>
<section id="launching-from-the-command-line">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Launching from the Command Line</a><a class="headerlink" href="#launching-from-the-command-line" title="Permalink to this heading"></a></h2>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p><strong>Important Note:</strong> To run the examples in this section, you need to install the <a class="reference external" href="https://gymnasium.farama.org/environments/mujoco/">Gymnasium Mujoco environments</a> package, including all its necessary dependencies. To do so, execute the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>stable-learning-control<span class="o">[</span>mujoco<span class="o">]</span>
</pre></div>
</div>
<p>For more detailed information about the <a class="reference external" href="https://gymnasium.farama.org/environments/mujoco/">Gymnasium Mujoco environments</a> package, please consult the documentation available <a class="reference external" href="https://gymnasium.farama.org/environments/mujoco/">here</a>.</p>
</div>
<p>SLC ships with a convenient <a class="reference internal" href="../utils/run_utils.html#runner"><span class="std std-ref">command line interface (CLI)</span></a> that lets you
quickly launch any algorithm (with any choices of hyperparameters) from the command line.
It also serves as a thin wrapper over the utilities for watching/evaluating the trained
policies and plotting. However, that functionality is not discussed on this page (for
those details, see the pages on <a class="reference internal" href="saving_and_loading.html#saving-and-loading"><span class="std std-ref">experiment outputs</span></a>,
<a class="reference internal" href="eval_robustness.html#robustness-eval"><span class="std std-ref">robustness evaluation</span></a> and <a class="reference internal" href="plotting.html#plotting"><span class="std std-ref">Plotting Results</span></a>).</p>
<p>The standard way to run an SLC algorithm from the command line is</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">stable_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="p">[</span><span class="n">algo</span> <span class="n">name</span><span class="p">]</span> <span class="p">[</span><span class="n">experiment</span> <span class="n">flags</span><span class="p">]</span>
</pre></div>
</div>
<p>eg:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">stable_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="n">sac</span> <span class="o">--</span><span class="n">env</span> <span class="n">Walker2d</span><span class="o">-</span><span class="n">v4</span> <span class="o">--</span><span class="n">exp_name</span> <span class="n">walker</span>
</pre></div>
</div>
<div class="admonition-you-should-know admonition">
<p class="admonition-title">You Should Know</p>
<p>If you are using ZShell: ZShell interprets square brackets as special characters. SLC
uses square brackets in a few ways for command-line arguments; make sure to escape
them or try the solution recommended <a class="reference external" href="https://gymnasium.farama.org/environments/mujoco/">here</a>
if you want to escape them by default.</p>
</div>
<div class="admonition-detailed-quickstart-guide admonition">
<p class="admonition-title">Detailed Quickstart Guide</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">stable_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="n">sac</span> <span class="o">--</span><span class="n">exp_name</span> <span class="n">sac_ant</span> <span class="o">--</span><span class="n">env</span> <span class="n">Ant</span><span class="o">-</span><span class="n">v4</span> <span class="o">--</span><span class="n">clip_ratio</span> <span class="mf">0.1</span> <span class="mf">0.2</span>
    <span class="o">--</span><span class="n">hid</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="mi">32</span><span class="p">,</span><span class="mi">32</span><span class="p">]</span> <span class="p">[</span><span class="mi">64</span><span class="p">,</span><span class="mi">32</span><span class="p">]</span> <span class="o">--</span><span class="n">act</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Tanh</span> <span class="o">--</span><span class="n">seed</span> <span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span> <span class="o">--</span><span class="n">dt</span>
    <span class="o">--</span><span class="n">data_dir</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span>
</pre></div>
</div>
<p>runs the SAC algorithm in the <code class="docutils literal notranslate"><span class="pre">Ant-v4</span></code> gymnasium environment, with various settings controlled by the flags.</p>
<p>By default, the PyTorch version will run. You can, however, substitute <code class="docutils literal notranslate"><span class="pre">sac</span></code> with
<code class="docutils literal notranslate"><span class="pre">sac_tf2</span></code> for the TensorFlow version.</p>
<p><code class="docutils literal notranslate"><span class="pre">clip_ratio</span></code>, <code class="docutils literal notranslate"><span class="pre">hid</span></code>, and <code class="docutils literal notranslate"><span class="pre">act</span></code> are flags to set some algorithm hyperparameters. You
can provide multiple values for hyperparameters to run multiple experiments. Check the docs
to see what hyperparameters you can set (click here for the <a class="reference internal" href="algorithms/sac.html#sac"><span class="std std-ref">SAC documentation</span></a>).</p>
<p><code class="docutils literal notranslate"><span class="pre">hid</span></code> and <code class="docutils literal notranslate"><span class="pre">act</span></code> are <a class="reference internal" href="#shortcut-flags"><span class="std std-ref">special shortcut flags</span></a> for setting the
hidden sizes and activation function for the neural networks trained by the algorithm.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">seed</span></code> flag sets the seed for the random number generator. RL algorithms have
high variance, so try multiple seeds to get a feel for how performance varies.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">dt</span></code> flag ensures that the save directory names will have timestamps in them
(otherwise, they don’t, unless you set <code class="docutils literal notranslate"><span class="pre">FORCE_DATESTAMP=True</span></code> in <a class="reference internal" href="../autoapi/stable_learning_control/user_config/index.html#module-stable_learning_control.user_config" title="stable_learning_control.user_config"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_learning_control.user_config</span></code></a>).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">data_dir</span></code> flag allows you to set the save folder for results. The default
value is set by <code class="docutils literal notranslate"><span class="pre">DEFAULT_DATA_DIR</span></code> in <a class="reference internal" href="../autoapi/stable_learning_control/user_config/index.html#module-stable_learning_control.user_config" title="stable_learning_control.user_config"><code class="xref py py-mod docutils literal notranslate"><span class="pre">stable_learning_control.user_config</span></code></a>,
which will be a subfolder <code class="docutils literal notranslate"><span class="pre">data</span></code> in the <code class="docutils literal notranslate"><span class="pre">stable_learning_control</span></code> folder (unless you change it).</p>
<p>The <a class="reference external" href="#where-results-are-saved">Save directory names</a> are based on <code class="docutils literal notranslate"><span class="pre">exp_name</span></code> and any flags which have multiple
values. Instead of the full flag, a shorthand will appear in the directory name.
Shorthands can be provided by the user in square brackets after the flag, like
<code class="docutils literal notranslate"><span class="pre">--hid[h]</span></code>; otherwise, shorthands are substrings of the flag (<code class="docutils literal notranslate"><span class="pre">clip_ratio</span></code>
becomes <code class="docutils literal notranslate"><span class="pre">cli</span></code>). To illustrate, the save directory for the run with
<code class="docutils literal notranslate"><span class="pre">clip_ratio=0.1</span></code>, <code class="docutils literal notranslate"><span class="pre">hid=[32,32]</span></code>, and <code class="docutils literal notranslate"><span class="pre">seed=10</span></code> will be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">YY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD_sac_ant_cli0</span><span class="o">-</span><span class="mi">1</span><span class="n">_h32</span><span class="o">-</span><span class="mi">32</span><span class="o">/</span><span class="n">YY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD_HH</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">SS</span><span class="o">-</span><span class="n">sac_ant_cli0</span><span class="o">-</span><span class="mi">1</span><span class="n">_h32</span><span class="o">-</span><span class="mi">32</span><span class="n">_seed10</span>
</pre></div>
</div>
</div>
<section id="choosing-pytorch-or-tensorflow-from-the-command-line">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Choosing PyTorch or TensorFlow from the Command Line</a><a class="headerlink" href="#choosing-pytorch-or-tensorflow-from-the-command-line" title="Permalink to this heading"></a></h3>
<p>To use a PyTorch version of an algorithm, run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">stable_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="p">[</span><span class="n">algo</span><span class="p">]</span><span class="n">_pytorch</span>
</pre></div>
</div>
<p>To use a TensorFlow version of an algorithm, run with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">stable_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="p">[</span><span class="n">algo</span><span class="p">]</span><span class="n">_tf2</span>
</pre></div>
</div>
<p>If you run <code class="docutils literal notranslate"><span class="pre">python</span> <span class="pre">-m</span> <span class="pre">stable_learning_control.run</span> <span class="pre">[algo]</span></code> without <code class="docutils literal notranslate"><span class="pre">_pytorch</span></code> or <code class="docutils literal notranslate"><span class="pre">_tf2</span></code>,
the runner will look in <code class="docutils literal notranslate"><span class="pre">stable_learning_control/user_config.py</span></code> for which version it should
default to that algorithm.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The TensorFlow version is still experimental. It is not guaranteed to work, and it is not
guaranteed to be up-to-date with the PyTorch version.</p>
</div>
</section>
<section id="setting-hyperparameters-from-the-command-line">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Setting Hyperparameters from the Command Line</a><a class="headerlink" href="#setting-hyperparameters-from-the-command-line" title="Permalink to this heading"></a></h3>
<p>Every hyperparameter in every algorithm can be controlled directly from the command line. If <strong>kwarg</strong>
is a valid keyword arg for the function call of an algorithm, you can set values for it with the flag
<code class="docutils literal notranslate"><span class="pre">--kwarg</span></code>.</p>
<p>To find out what keyword args are available, see either the docs page for <a class="reference internal" href="algorithms.html#algos"><span class="std std-ref">an algorithm</span></a>,
<span class="xref std std-ref">the API reference</span> or try</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">stable_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="p">[</span><span class="n">algo</span> <span class="n">name</span><span class="p">]</span> <span class="o">--</span><span class="n">help</span>
</pre></div>
</div>
<p>to see a readout of the docstring.</p>
<div class="admonition-you-should-know admonition">
<p class="admonition-title">You Should Know</p>
<p>Values pass through <a class="reference internal" href="../autoapi/stable_learning_control/utils/safer_eval_util/index.html#stable_learning_control.utils.safer_eval_util.safer_eval" title="stable_learning_control.utils.safer_eval_util.safer_eval"><code class="xref py py-meth docutils literal notranslate"><span class="pre">safer_eval()</span></code></a> before
being used so that you can describe some functions and objects directly from the command line.
For example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">stable_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="n">sac</span> <span class="o">--</span><span class="n">env</span> <span class="n">Walker2d</span><span class="o">-</span><span class="n">v4</span> <span class="o">--</span><span class="n">exp_name</span> <span class="n">walker</span> <span class="o">--</span><span class="n">act</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span>
</pre></div>
</div>
<p>sets <code class="docutils literal notranslate"><span class="pre">torch.nn.ReLU</span></code> as the activation function. (TensorFlow equivalent: run <code class="docutils literal notranslate"><span class="pre">sac_tf</span></code> with <code class="docutils literal notranslate"><span class="pre">--act</span> <span class="pre">tf.nn.relu</span></code>.)</p>
</div>
<div class="admonition-you-should-know admonition">
<p class="admonition-title">You Should Know</p>
<p>There’s some excellent handling for kwargs that take <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a> values. Instead of having to provide</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">key</span> <span class="nb">dict</span><span class="p">(</span><span class="n">v1</span><span class="o">=</span><span class="n">value_1</span><span class="p">,</span> <span class="n">v2</span><span class="o">=</span><span class="n">value_2</span><span class="p">)</span>
</pre></div>
</div>
<p>you can give</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span><span class="n">key</span><span class="p">:</span><span class="n">v1</span> <span class="n">value_1</span> <span class="o">--</span><span class="n">key</span><span class="p">:</span><span class="n">v2</span> <span class="n">value_2</span>
</pre></div>
</div>
<p>to get the same result.</p>
</div>
</section>
<section id="launching-multiple-experiments-at-once">
<span id="running-multiple-experiments"></span><h3><a class="toc-backref" href="#id7" role="doc-backlink">Launching Multiple Experiments at Once</a><a class="headerlink" href="#launching-multiple-experiments-at-once" title="Permalink to this heading"></a></h3>
<p>You can launch multiple experiments, to be executed <strong>in series</strong>, by simply providing more than
one value for a given argument. (An experiment for each possible combination of values will
be launched.)</p>
<p>For example, to launch otherwise-equivalent runs with different random seeds (0, 10, and 20), do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">stable_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="n">sac</span> <span class="o">--</span><span class="n">env</span> <span class="n">Walker2d</span><span class="o">-</span><span class="n">v4</span> <span class="o">--</span><span class="n">exp_name</span> <span class="n">walker</span> <span class="o">--</span><span class="n">seed</span> <span class="mi">0</span> <span class="mi">10</span> <span class="mi">20</span>
</pre></div>
</div>
<p>Experiments don’t launch in parallel because they soak up enough resources that executing several
simultaneously wouldn’t get a speedup.</p>
</section>
<section id="special-flags">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">Special Flags</a><a class="headerlink" href="#special-flags" title="Permalink to this heading"></a></h3>
<p>A few flags receive special treatment.</p>
<section id="environment-flags">
<span id="env-flags"></span><h4><a class="toc-backref" href="#id9" role="doc-backlink">Environment Flags</a><a class="headerlink" href="#environment-flags" title="Permalink to this heading"></a></h4>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-env">
<span id="cmdoption-env_name"></span><span class="sig-name descname"><span class="pre">--env</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--env_name</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-env" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>. The name of an environment in gymnasium. All SLC algorithms are implemented as
functions that accept <code class="docutils literal notranslate"><span class="pre">env_fn</span></code> as an argument, where <code class="docutils literal notranslate"><span class="pre">env_fn</span></code> must be a callable function
that builds a copy of the RL environment. Since the most common use case is gymnasium
environments, though, all of which are built through <code class="docutils literal notranslate"><span class="pre">gym.make(env_name)</span></code>, we allow
you to specify <code class="docutils literal notranslate"><span class="pre">env_name</span></code> (or <code class="docutils literal notranslate"><span class="pre">env</span></code> for short) at the command line, which gets
converted to a lambda-function that builds the correct gymnasium environment. You can
prefix the environment name with a module name, separated by a colon, to specify a
custom gymnasium environment (i.e. <code class="docutils literal notranslate"><span class="pre">--env</span> <span class="pre">stable_gym:Oscillator-v1</span></code>).</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-env_k">
<span id="cmdoption-env_kwargs"></span><span class="sig-name descname"><span class="pre">--env_k</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--env_kwargs</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-env_k" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>. Additional keyword arguments you want to pass to the gym environment. If
you, for example, want to change the forward reward weight and healthy reward of the
<a class="reference external" href="https://gymnasium.farama.org/environments/mujoco/walker2d/">Walker2d-v4</a> environment, you can do so by passing <code class="docutils literal notranslate"><span class="pre">--env_kwargs</span> <span class="pre">&quot;{'forward_reward_weight':</span> <span class="pre">0.5,</span> <span class="pre">'healthy_reward':</span> <span class="pre">0.5}&quot;</span></code>
to the run command.</p>
</dd></dl>

</section>
<section id="algorithm-flags">
<span id="alg-flags"></span><h4><a class="toc-backref" href="#id10" role="doc-backlink">Algorithm Flags</a><a class="headerlink" href="#algorithm-flags" title="Permalink to this heading"></a></h4>
<section id="general-flags">
<h5><a class="toc-backref" href="#id11" role="doc-backlink">General Flags</a><a class="headerlink" href="#general-flags" title="Permalink to this heading"></a></h5>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-save_cps">
<span id="cmdoption-save_checkpoints"></span><span id="cmdoption-arg-default"></span><span class="sig-name descname"><span class="pre">--save_cps</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--save_checkpoints</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">default:</span></span><span class="sig-prename descclassname"> <span class="pre">False</span></span><a class="headerlink" href="#cmdoption-save_cps" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>. Only the most recent state of the agent and environment is saved by default. When the
<code class="docutils literal notranslate"><span class="pre">--save_checkpoints</span></code> flag is supplied, a snapshot (checkpoint) of the agent and
environment will be saved at each epoch. These snapshots are saved in a <code class="docutils literal notranslate"><span class="pre">checkpoints</span></code>
folder inside the Logger output directory (for more information, see
<a class="reference internal" href="saving_and_loading.html#checkpoints"><span class="std std-ref">Saving and Loading Experiment Outputs</span></a>).</p>
</dd></dl>

</section>
<section id="shortcut-flags">
<span id="id2"></span><h5><a class="toc-backref" href="#id12" role="doc-backlink">Shortcut Flags</a><a class="headerlink" href="#shortcut-flags" title="Permalink to this heading"></a></h5>
<p>Some algorithm arguments are relatively long, and we enabled shortcuts for them:</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-hid">
<span id="cmdoption-ac_kwargs-hidden_sizes"></span><span class="sig-name descname"><span class="pre">--hid</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--ac_kwargs:hidden_sizes</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-hid" title="Permalink to this definition"></a></dt>
<dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">ints</span></code>. Sets the sizes of the hidden layers in the neural networks of both the actor and critic.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-hid_a">
<span id="cmdoption-ac_kwargs-hidden_sizes-actor"></span><span class="sig-name descname"><span class="pre">--hid_a</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--ac_kwargs:hidden_sizes:actor</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-hid_a" title="Permalink to this definition"></a></dt>
<dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">ints</span></code>. Sets the sizes of the hidden layers in the neural networks of the actor.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-hid_c">
<span id="cmdoption-ac_kwargs-hidden_sizes-critic"></span><span class="sig-name descname"><span class="pre">--hid_c</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--ac_kwargs:hidden_sizes:critic</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-hid_c" title="Permalink to this definition"></a></dt>
<dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span> <span class="pre">of</span> <span class="pre">ints</span></code>. Sets the sizes of the hidden layers in the neural networks of the critic.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-act">
<span id="cmdoption-ac_kwargs-activation"></span><span class="sig-name descname"><span class="pre">--act</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--ac_kwargs:activation</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-act" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://pytorch.org/docs/stable/nn.html#module-torch.nn" title="(in PyTorch v2.4)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.nn</span></code></a> or <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/nn" title="(in TensorFlow v2.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tf.nn</span></code></a>. The activation function for the neural networks in the actor and critic.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-act_out">
<span id="cmdoption-ac_kwargs-output_activation"></span><span class="sig-name descname"><span class="pre">--act_out</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--ac_kwargs:output_activation</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-act_out" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://pytorch.org/docs/stable/nn.html#module-torch.nn" title="(in PyTorch v2.4)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.nn</span></code></a> or <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/nn" title="(in TensorFlow v2.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tf.nn</span></code></a>. The activation function for the neural networks in the actor and critic.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-act_a">
<span id="cmdoption-ac_kwargs-activation-actor"></span><span class="sig-name descname"><span class="pre">--act_a</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--ac_kwargs:activation:actor</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-act_a" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://pytorch.org/docs/stable/nn.html#module-torch.nn" title="(in PyTorch v2.4)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.nn</span></code></a> or <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/nn" title="(in TensorFlow v2.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tf.nn</span></code></a>. The activation function for the neural networks in the actor.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-act_c">
<span id="cmdoption-ac_kwargs-activation-critic"></span><span class="sig-name descname"><span class="pre">--act_c</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--ac_kwargs:activation:critic</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-act_c" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://pytorch.org/docs/stable/nn.html#module-torch.nn" title="(in PyTorch v2.4)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.nn</span></code></a> or <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/nn" title="(in TensorFlow v2.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tf.nn</span></code></a>. The activation function for the neural networks in the critic.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-act_out_a">
<span id="cmdoption-ac_kwargs-output_activation-actor"></span><span class="sig-name descname"><span class="pre">--act_out_a</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--ac_kwargs:output_activation:actor</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-act_out_a" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://pytorch.org/docs/stable/nn.html#module-torch.nn" title="(in PyTorch v2.4)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.nn</span></code></a> or <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/nn" title="(in TensorFlow v2.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tf.nn</span></code></a>. The activation function for the output activation function of the actor.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-act_out_c">
<span id="cmdoption-ac_kwargs-output_activation-critic"></span><span class="sig-name descname"><span class="pre">--act_out_c</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--ac_kwargs:output_activation:critic</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-act_out_c" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://pytorch.org/docs/stable/nn.html#module-torch.nn" title="(in PyTorch v2.4)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">torch.nn</span></code></a> or <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/nn" title="(in TensorFlow v2.8)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">tf.nn</span></code></a>. The activation function for the output activation function of the critic.</p>
</dd></dl>

<p>These flags are valid for all current SLC algorithms.</p>
</section>
</section>
<section id="config-flags">
<h4><a class="toc-backref" href="#id13" role="doc-backlink">Config Flags</a><a class="headerlink" href="#config-flags" title="Permalink to this heading"></a></h4>
<p>These flags are not hyperparameters of any algorithm but change the experimental configuration in some way.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-cpu">
<span id="cmdoption-num_cpu"></span><span class="sig-name descname"><span class="pre">--cpu</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--num_cpu</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-cpu" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>. If this flag is set, the experiment is launched with this many processes, one per CPU,
connected by MPI. Some algorithms are amenable to this sort of parallelization, but not all. If you
try setting <code class="docutils literal notranslate"><span class="pre">num_cpu</span></code> &gt; 1 for an incompatible algorithm, an error will be raised. You can also
set <code class="docutils literal notranslate"><span class="pre">--num_cpu</span> <span class="pre">auto</span></code>, which will automatically use as many CPUs as are available on the machine.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-exp_name">
<span class="sig-name descname"><span class="pre">--exp_name</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-exp_name" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>. The experiment name. This is used in naming the save directory for each experiment. The default
is “cmd” + [algo name].</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-data_dir">
<span class="sig-name descname"><span class="pre">--data_dir</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-data_dir" title="Permalink to this definition"></a></dt>
<dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">path</span> <span class="pre">str</span></code>. Set the base save directory for this experiment or set of experiments. If none is given,
the <code class="docutils literal notranslate"><span class="pre">DEFAULT_DATA_DIR</span></code> in <code class="docutils literal notranslate"><span class="pre">stable_learning_control/user_config.py</span></code> will be used.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-dt">
<span id="cmdoption-datestamp"></span><span class="sig-name descname"><span class="pre">--dt</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--datestamp</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-dt" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>. Include the date and time in the name for the save directory of the experiment.</p>
</dd></dl>

</section>
<section id="logger-flags">
<h4><a class="toc-backref" href="#id14" role="doc-backlink">Logger Flags</a><a class="headerlink" href="#logger-flags" title="Permalink to this heading"></a></h4>
<p>The CLI also contains several (shortcut) flags that can be used to change the behaviour of the
<a class="reference internal" href="../utils/loggers.html#stable_learning_control.utils.log_utils.logx.EpochLogger" title="stable_learning_control.utils.log_utils.logx.EpochLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">stable_learning_control.utils.log_utils.logx.EpochLogger</span></code></a>.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-use_tb">
<span id="cmdoption-logger_kwargs-use_tensorboard"></span><span id="cmdoption-arg-0"></span><span class="sig-name descname"><span class="pre">--use_tb</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--logger_kwargs:use_tensorboard</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">default</span></span><span class="sig-prename descclassname"><span class="pre">=False</span></span><a class="headerlink" href="#cmdoption-use_tb" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>. Enables TensorBoard logging.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-tb_log_freq">
<span id="cmdoption-logger_kwargs-tb_log_freq"></span><span id="cmdoption-arg-1"></span><span class="sig-name descname"><span class="pre">--tb_log_freq</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--logger_kwargs:tb_log_freq</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">default</span></span><span class="sig-prename descclassname"><span class="pre">='low'</span></span><a class="headerlink" href="#cmdoption-tb_log_freq" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>. The TensorBoard log frequency. Options are <code class="docutils literal notranslate"><span class="pre">low</span></code> (Recommended: logs at every epoch) and
<code class="docutils literal notranslate"><span class="pre">high</span></code> (logs at every SGD update batch). Defaults to <code class="docutils literal notranslate"><span class="pre">low</span></code> since this is less resource intensive.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-use_wandb">
<span id="cmdoption-logger_kwargs-use_wandb"></span><span id="cmdoption-arg-2"></span><span class="sig-name descname"><span class="pre">--use_wandb</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--logger_kwargs:use_wandb</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">default</span></span><span class="sig-prename descclassname"><span class="pre">=False</span></span><a class="headerlink" href="#cmdoption-use_wandb" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>. Enables Weights &amp; Biases logging.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-wandb_job_type">
<span id="cmdoption-logger_kwargs-wandb_job_type"></span><span id="cmdoption-arg-3"></span><span class="sig-name descname"><span class="pre">--wandb_job_type</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--logger_kwargs:wandb_job_type</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">default</span></span><span class="sig-prename descclassname"><span class="pre">='train'</span></span><a class="headerlink" href="#cmdoption-wandb_job_type" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>. The Weights &amp; Biases job type.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-wandb_project">
<span id="cmdoption-logger_kwargs-wandb_project"></span><span id="cmdoption-arg-4"></span><span class="sig-name descname"><span class="pre">--wandb_project</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--logger_kwargs:wandb_project</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">default</span></span><span class="sig-prename descclassname"><span class="pre">='stable_learning_control'</span></span><a class="headerlink" href="#cmdoption-wandb_project" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>. The Weights &amp; Biases project name.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-wandb_group">
<span id="cmdoption-logger_kwargs-wandb_group"></span><span id="cmdoption-arg-5"></span><span class="sig-name descname"><span class="pre">--wandb_group</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--logger_kwargs:wandb_group</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">default</span></span><span class="sig-prename descclassname"><span class="pre">=None</span></span><a class="headerlink" href="#cmdoption-wandb_group" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>. The Weights &amp; Biases group name.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-quiet">
<span id="cmdoption-logger_kwargs-quiet"></span><span id="cmdoption-arg-6"></span><span class="sig-name descname"><span class="pre">--quiet</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--logger_kwargs:quiet</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">default</span></span><span class="sig-prename descclassname"><span class="pre">=False</span></span><a class="headerlink" href="#cmdoption-quiet" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>. Suppress logging of diagnostics to the stdout.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-verbose_fmt">
<span id="cmdoption-logger_kwargs-verbose_fmt"></span><span id="cmdoption-arg-7"></span><span class="sig-name descname"><span class="pre">--verbose_fmt</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--logger_kwargs:verbose_fmt</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">default</span></span><span class="sig-prename descclassname"><span class="pre">='line'</span></span><a class="headerlink" href="#cmdoption-verbose_fmt" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">bool</span></code></a>. The format in which the diagnostics are displayed to the terminal when <code class="docutils literal notranslate"><span class="pre">quiet</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>.
Options are <code class="docutils literal notranslate"><span class="pre">table</span></code>, which supplies them as a table and <code class="docutils literal notranslate"><span class="pre">line</span></code>, which prints them in one line.</p>
</dd></dl>

<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-verbose_vars">
<span id="cmdoption-logger_kwargs-verbose_vars"></span><span id="cmdoption-arg-8"></span><span class="sig-name descname"><span class="pre">--verbose_vars</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">--logger_kwargs:verbose_vars</span></span><span class="sig-prename descclassname"></span><span class="sig-prename descclassname"><span class="pre">,</span> </span><span class="sig-name descname"><span class="pre">default</span></span><span class="sig-prename descclassname"><span class="pre">=None</span></span><a class="headerlink" href="#cmdoption-verbose_vars" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>. A list of variables you want to log to the stdout when <code class="docutils literal notranslate"><span class="pre">quiet</span></code> is <code class="docutils literal notranslate"><span class="pre">False</span></code>. The default <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> means that all variables are logged.</p>
</dd></dl>

<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The verbose_vars list should be supplied as a list that can be evaluated in Python (e.g.
<code class="docutils literal notranslate"><span class="pre">--verbose_vars</span> <span class="pre">[&quot;Lr_a&quot;,</span> <span class="pre">&quot;Lr_c&quot;]</span></code>).</p>
</div>
</section>
</section>
<section id="using-experimental-configuration-files-yaml">
<span id="exp-cfg"></span><h3><a class="toc-backref" href="#id15" role="doc-backlink">Using experimental configuration files (yaml)</a><a class="headerlink" href="#using-experimental-configuration-files-yaml" title="Permalink to this heading"></a></h3>
<p>The SLC CLI comes with a handy configuration file loader that can be used to load <a class="reference external" href="https://docs.ansible.com/ansible/latest/reference_appendices/YAMLSyntax.html">YAML</a> configuration files.
These configuration files provide a convenient way to store your experiments’ hyperparameter such that results
can be reproduced. You can supply the CLI with an experiment configuration file using the <code class="docutils literal notranslate"><span class="pre">--exp_cfg</span></code> flag.</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-exp_cfg">
<span class="sig-name descname"><span class="pre">--exp_cfg</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-exp_cfg" title="Permalink to this definition"></a></dt>
<dd><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">path</span> <span class="pre">str</span></code>. Sets the path to the <code class="docutils literal notranslate"><span class="pre">yml</span></code> config file used for loading experiment hyperparameter.</p>
</dd></dl>

<p>For example, we can use the following command to train a SAC algorithm using the original hyperparameters used
by <a class="reference external" href="https://arxiv.org/abs/1801.01290">Haarnoja et al., 2019</a>.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-m<span class="w"> </span>stable_learning_control.run<span class="w"> </span>--exp_cfg<span class="w"> </span>./experiments/haarnoja_et_al_2019.yml
</pre></div>
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Please note that if you want to run multiple hyperparameter variants, for example, multiple seeds or
learning rates, you have to use comma/space-separated strings in your configuration file:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">alg_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lac</span>
<span class="nt">exp_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my_experiment</span>
<span class="hll"><span class="nt">seed</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0 12345 342699</span>
</span><span class="nt">ac_kwargs</span><span class="p">:</span>
<span class="nt">hidden_sizes</span><span class="p">:</span>
<span class="w">    </span><span class="nt">actor</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">64</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">64</span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">critic</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="nv">256</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">256</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="nv">16</span><span class="p p-Indicator">]</span>
<span class="hll"><span class="nt">lr_a</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1e-4,</span><span class="nv"> </span><span class="s">1e-3,</span><span class="nv"> </span><span class="s">1e-2&quot;</span>
</span></pre></div>
</div>
<p>Additionally, if you want to specify a <a class="reference external" href="https://docs.python.org/dev/library/argparse.html#core-functionality">on/off</a> flag, you can supply an empty key.</p>
</div>
</section>
<section id="where-results-are-saved">
<h3><a class="toc-backref" href="#id16" role="doc-backlink">Where Results are Saved</a><a class="headerlink" href="#where-results-are-saved" title="Permalink to this heading"></a></h3>
<p>Results for a particular experiment (a single run of a configuration of hyperparameters) are stored in</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data_dir</span><span class="o">/</span><span class="p">[</span><span class="n">outer_prefix</span><span class="p">]</span><span class="n">exp_name</span><span class="p">[</span><span class="n">suffix</span><span class="p">]</span><span class="o">/</span><span class="p">[</span><span class="n">inner_prefix</span><span class="p">]</span><span class="n">exp_name</span><span class="p">[</span><span class="n">suffix</span><span class="p">]</span><span class="n">_s</span><span class="p">[</span><span class="n">seed</span><span class="p">]</span>
</pre></div>
</div>
<p>where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data_dir</span></code> is the value of the <code class="docutils literal notranslate"><span class="pre">--data_dir</span></code> flag (defaults to <code class="docutils literal notranslate"><span class="pre">DEFAULT_DATA_DIR</span></code> from
<code class="docutils literal notranslate"><span class="pre">stable_learning_control/user_config.py</span></code> if <code class="docutils literal notranslate"><span class="pre">--data_dir</span></code> is not given),</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">outer_prefix</span></code> is a <code class="docutils literal notranslate"><span class="pre">YY-MM-DD_</span></code> timestamp if the <code class="docutils literal notranslate"><span class="pre">--datestamp</span></code> flag is raised, otherwise nothing,</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">inner_prefix</span></code> is a <code class="docutils literal notranslate"><span class="pre">YY-MM-DD_HH-MM-SS-</span></code> timestamp if the <code class="docutils literal notranslate"><span class="pre">--datestamp</span></code> flag is raised, otherwise nothing,</p></li>
<li><p>and <code class="docutils literal notranslate"><span class="pre">suffix</span></code> is a special string based on the experiment hyperparameters.</p></li>
</ul>
<section id="how-is-suffix-determined">
<h4><a class="toc-backref" href="#id17" role="doc-backlink">How is Suffix Determined?</a><a class="headerlink" href="#how-is-suffix-determined" title="Permalink to this heading"></a></h4>
<p>Suffixes are only included if you run multiple experiments at once, and they only have references to hyperparameters
that differ across experiments, except for the random seed. The goal is to ensure that results for similar experiments
(ones that share all parameters except the seed) are grouped in the same folder.</p>
<p>Suffixes are constructed by combining <em>shorthands</em> for hyperparameters with their values, where a shorthand is either
1) constructed automatically from the hyperparameter name or 2) supplied by the user. The user can write a shorthand
2) in square brackets after the <code class="docutils literal notranslate"><span class="pre">kwarg</span></code> flag.</p>
<p>For example, consider:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">stable_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="n">sac_tf</span> <span class="o">--</span><span class="n">env</span> <span class="n">Hopper</span><span class="o">-</span><span class="n">v4</span> <span class="o">--</span><span class="n">hid</span><span class="p">[</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="mi">300</span><span class="p">]</span> <span class="p">[</span><span class="mi">128</span><span class="p">,</span><span class="mi">128</span><span class="p">]</span> <span class="o">--</span><span class="n">act</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">tanh</span> <span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span>
</pre></div>
</div>
<p>Here, the <code class="docutils literal notranslate"><span class="pre">--hid</span></code> flag is given a <strong>user-supplied shorthand</strong>, <code class="docutils literal notranslate"><span class="pre">h</span></code>. The user does not provide the <code class="docutils literal notranslate"><span class="pre">--act</span></code>
flag with a shorthand, so one will be constructed for it automatically.</p>
<p>The suffixes produced in this case are:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">_h128</span><span class="o">-</span><span class="mi">128</span><span class="n">_ac</span><span class="o">-</span><span class="n">actrelu</span>
<span class="n">_h128</span><span class="o">-</span><span class="mi">128</span><span class="n">_ac</span><span class="o">-</span><span class="n">acttanh</span>
<span class="n">_h300_ac</span><span class="o">-</span><span class="n">actrelu</span>
<span class="n">_h300_ac</span><span class="o">-</span><span class="n">acttanh</span>
</pre></div>
</div>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">h</span></code> was given by the user. the <code class="docutils literal notranslate"><span class="pre">ac-act</span></code> shorthand was constructed from <code class="docutils literal notranslate"><span class="pre">ac_kwargs:activation</span></code>
(the true name for the <code class="docutils literal notranslate"><span class="pre">act</span></code> flag).</p>
</section>
</section>
<section id="extra">
<h3><a class="toc-backref" href="#id18" role="doc-backlink">Extra</a><a class="headerlink" href="#extra" title="Permalink to this heading"></a></h3>
<div class="admonition-you-don-t-actually-need-to-know-this-one admonition">
<p class="admonition-title">You don’t actually Need to Know This One</p>
<p>Each individual algorithm is located in a file <code class="docutils literal notranslate"><span class="pre">stable_learning_control/algos/BACKEND/ALGO_NAME/ALGO_NAME.py</span></code>,
and these files can be run directly from the command line with a limited set of arguments (some of which differ
from what’s available to <code class="docutils literal notranslate"><span class="pre">stable_learning_control/run.py</span></code>). However, the command line support in the individual
algorithm files is vestigial, which is <strong>not</strong> a recommended way to perform experiments.</p>
<p>This documentation page will not describe those command line calls and <em>only</em> describe calls through
<code class="docutils literal notranslate"><span class="pre">stable_learning_control/run.py</span></code>.</p>
</div>
</section>
<section id="use-transfer-learning">
<h3><a class="toc-backref" href="#id19" role="doc-backlink">Use transfer learning</a><a class="headerlink" href="#use-transfer-learning" title="Permalink to this heading"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">start_policy</span></code> command-line flag allows you to use an already trained algorithm as the starting point for
your new algorithm:</p>
<dl class="std option">
<dt class="sig sig-object std" id="cmdoption-start_policy">
<span class="sig-name descname"><span class="pre">--start_policy</span></span><span class="sig-prename descclassname"></span><a class="headerlink" href="#cmdoption-start_policy" title="Permalink to this definition"></a></dt>
<dd><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>. This flag can be used to train your policy while taking an already-started policy as the starting point.
It should contain the path to the folder
where the already trained policy is found.</p>
</dd></dl>

</section>
<section id="using-custom-environments">
<h3><a class="toc-backref" href="#id20" role="doc-backlink">Using custom environments</a><a class="headerlink" href="#using-custom-environments" title="Permalink to this heading"></a></h3>
<p>The SLC package can be used with any <a class="reference external" href="https://gymnasium.farama.org/">Gymnasium-based</a> environment. To use a custom environment, you need
to ensure it inherits from the <code class="xref py py-class docutils literal notranslate"><span class="pre">gym.Env</span></code> class and implements the following methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">reset(self)</span></code>: Reset the environment’s state. Returns <code class="docutils literal notranslate"><span class="pre">observation,</span> <span class="pre">info</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step(self,</span> <span class="pre">action)</span></code>: Step the environment by one timestep. Returns <code class="docutils literal notranslate"><span class="pre">observation,</span> <span class="pre">reward,</span> <span class="pre">terminated,</span> <span class="pre">truncated,</span> <span class="pre">info</span></code>.</p></li>
</ul>
<p>Additionally, you must ensure that your environment is registered in the <a class="reference external" href="https://gymnasium.farama.org/">Gymnasium registry</a>. This
can be done by adding the following lines to your environment file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>
<span class="kn">from</span> <span class="nn">gymnasium.envs.registration</span> <span class="kn">import</span> <span class="n">register</span>

<span class="n">register</span><span class="p">(</span>
    <span class="nb">id</span><span class="o">=</span><span class="s1">&#39;CustomEnv-v1&#39;</span><span class="p">,</span>
    <span class="n">entry_point</span><span class="o">=</span><span class="s1">&#39;path.to.your.env:CustomEnv&#39;</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>After these requirements are met, you can use it with the SLC package by passing the environment
name to the <code class="docutils literal notranslate"><span class="pre">--env</span></code> command-line flag. For example, if your environment is called <code class="docutils literal notranslate"><span class="pre">CustomEnv</span></code> and is located in
the file <code class="docutils literal notranslate"><span class="pre">custom_env_module.py</span></code>, you can run the SLC package with your environment by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">stable_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="n">sac</span> <span class="o">--</span><span class="n">env</span> <span class="n">custom_env_module</span><span class="p">:</span><span class="n">CustomEnv</span><span class="o">-</span><span class="n">v1</span>
</pre></div>
</div>
</section>
</section>
<section id="launching-from-scripts">
<h2><a class="toc-backref" href="#id21" role="doc-backlink">Launching from Scripts</a><a class="headerlink" href="#launching-from-scripts" title="Permalink to this heading"></a></h2>
<p>Each algorithm is implemented as a Python function, which can be imported directly from the <code class="docutils literal notranslate"><span class="pre">stable_learning_control</span></code>
package, eg.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stable_learning_control.control</span> <span class="kn">import</span> <span class="n">sac_pytorch</span> <span class="k">as</span> <span class="n">sac</span>
</pre></div>
</div>
<p>See the documentation page for each algorithm for a complete account of possible arguments. These methods can be used
to set up specialized custom experiments, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">stable_learning_control.control</span> <span class="kn">import</span> <span class="n">sac_tf2</span> <span class="k">as</span> <span class="n">sac</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">gymnasium</span> <span class="k">as</span> <span class="nn">gym</span>

<span class="n">env_fn</span> <span class="o">=</span> <span class="k">lambda</span> <span class="p">:</span> <span class="n">gym</span><span class="o">.</span><span class="n">make</span><span class="p">(</span><span class="s1">&#39;LunarLander-v2&#39;</span><span class="p">)</span>

<span class="n">ac_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">hidden_sizes</span><span class="o">=</span><span class="p">[</span><span class="mi">64</span><span class="p">,</span><span class="mi">64</span><span class="p">],</span> <span class="n">activation</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">relu</span><span class="p">)</span>

<span class="n">logger_kwargs</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;path/to/output_dir&#39;</span><span class="p">,</span> <span class="n">exp_name</span><span class="o">=</span><span class="s1">&#39;experiment_name&#39;</span><span class="p">)</span>

<span class="n">sac</span><span class="p">(</span><span class="n">env_fn</span><span class="o">=</span><span class="n">env_fn</span><span class="p">,</span> <span class="n">ac_kwargs</span><span class="o">=</span><span class="n">ac_kwargs</span><span class="p">,</span> <span class="n">steps_per_epoch</span><span class="o">=</span><span class="mi">5000</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">250</span><span class="p">,</span> <span class="n">logger_kwargs</span><span class="o">=</span><span class="n">logger_kwargs</span><span class="p">)</span>
</pre></div>
</div>
<section id="using-experimentgrid">
<h3><a class="toc-backref" href="#id22" role="doc-backlink">Using ExperimentGrid</a><a class="headerlink" href="#using-experimentgrid" title="Permalink to this heading"></a></h3>
<p>An easy way to find good hyperparameters is to run the same algorithm with many possible hyperparameters. LC ships with
a simple tool for facilitating this, called <a class="reference internal" href="../utils/run_utils.html#exp-grid-utility"><span class="std std-ref">ExperimentGrid</span></a>.</p>
<p>Consider the example in <code class="docutils literal notranslate"><span class="pre">stable_learning_control/examples/pytorch/sac_exp_grid_search.py</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="linenos"> 2</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">torch</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="c1"># Import the RL agent you want to perform the grid search for.</span>
<span class="linenos"> 6</span><span class="kn">from</span> <span class="nn">stable_learning_control.algos.pytorch.sac</span> <span class="kn">import</span> <span class="n">sac</span>
<span class="linenos"> 7</span><span class="kn">from</span> <span class="nn">stable_learning_control.utils.run_utils</span> <span class="kn">import</span> <span class="n">ExperimentGrid</span>
<span class="linenos"> 8</span>
<span class="linenos"> 9</span><span class="c1"># Scriptparameters.</span>
<span class="linenos">10</span><span class="n">ENV_NAME</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos">11</span>    <span class="s2">&quot;stable_gym:Oscillator-v1&quot;</span>  <span class="c1"># The environment on which you want to train the agent.</span>
<span class="linenos">12</span><span class="p">)</span>
<span class="linenos">13</span>
<span class="linenos">14</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">15</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="linenos">16</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--cpu&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="linenos">17</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--num_runs&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="linenos">18</span>    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="linenos">19</span>
<span class="linenos">20</span>    <span class="c1"># Setup Grid search parameters.</span>
<span class="linenos">21</span>    <span class="c1"># NOTE: Here you can add the algorithm parameters you want using their name.</span>
<span class="hll"><span class="linenos">22</span>    <span class="n">eg</span> <span class="o">=</span> <span class="n">ExperimentGrid</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;sac-grid-search&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">23</span>    <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;env_name&quot;</span><span class="p">,</span> <span class="s2">&quot;stable_gym:Oscillator-v1&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">24</span>    <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;seed&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mi">10</span> <span class="o">*</span> <span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">num_runs</span><span class="p">)])</span>
</span><span class="hll"><span class="linenos">25</span>    <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;epochs&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">26</span>    <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;steps_per_epoch&quot;</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">27</span>    <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;ac_kwargs:hidden_sizes&quot;</span><span class="p">,</span> <span class="p">[(</span><span class="mi">32</span><span class="p">,),</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">)],</span> <span class="s2">&quot;hid&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">28</span>    <span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="s2">&quot;ac_kwargs:activation&quot;</span><span class="p">,</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">],</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
</span><span class="linenos">29</span>
<span class="linenos">30</span>    <span class="c1"># Run the grid search.</span>
<span class="hll"><span class="linenos">31</span>    <span class="n">eg</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">sac</span><span class="p">,</span> <span class="n">num_cpu</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">cpu</span><span class="p">)</span>
</span></pre></div>
</div>
<p>After making the ExperimentGrid object, parameters are added to it with</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eg</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">param_name</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">shorthand</span><span class="p">,</span> <span class="n">in_name</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">in_name</span></code> forces a parameter to appear in the experiment name, even if it has the same value across all experiments.</p>
<p>After all parameters have been added,</p>
<pre class="literal-block">eg.run(thunk, **run_kwargs)</pre>
<p>runs all experiments in the grid (one experiment per valid configuration), by providing the configurations as kwargs to the
function <code class="docutils literal notranslate"><span class="pre">thunk</span></code>. <code class="docutils literal notranslate"><span class="pre">ExperimentGrid.run</span></code> uses a function named <a class="reference internal" href="../utils/run_utils.html#exp-call-utility"><span class="std std-ref">call_experiment</span></a> to launch <code class="docutils literal notranslate"><span class="pre">thunk</span></code>, and <code class="docutils literal notranslate"><span class="pre">**run_kwargs</span></code>
specify behaviors for <code class="docutils literal notranslate"><span class="pre">call_experiment</span></code>. See <a class="reference internal" href="../utils/run_utils.html#exp-grid-utility"><span class="std std-ref">the documentation page</span></a> for details.</p>
<p>Except for the absence of shortcut kwargs (you can’t use <code class="docutils literal notranslate"><span class="pre">hid</span></code> for <code class="docutils literal notranslate"><span class="pre">ac_kwargs:hidden_sizes</span></code> in <code class="docutils literal notranslate"><span class="pre">ExperimentGrid</span></code>), the
basic behaviour of <code class="docutils literal notranslate"><span class="pre">ExperimentGrid</span></code> is the same as running things from the command line.
(In fact, <code class="docutils literal notranslate"><span class="pre">stable_learning_control.run</span></code> uses an <code class="docutils literal notranslate"><span class="pre">ExperimentGrid</span></code> under the hood.)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An equivalent TensorFlow example is available in <code class="docutils literal notranslate"><span class="pre">stable_learning_control/examples/tf2/sac_exp_grid_search.py</span></code>.</p>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="algorithms/sac.html" class="btn btn-neutral float-left" title="Soft Actor-Critic" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="hyperparameter_tuning.html" class="btn btn-neutral float-right" title="Hyperparameter Tuning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Rick Staa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>