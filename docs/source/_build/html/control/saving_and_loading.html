

<!DOCTYPE html>
<html class="writer-html4" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Experiment Outputs &mdash; Machine Learning Control 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/modify.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plotting Results" href="plotting.html" />
    <link rel="prev" title="Running Experiments" href="running.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">MLC package</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user/introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user/installation.html">Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Modeling</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../modeling/modeling.html">Modeling</a></li>
</ul>
<p class="caption"><span class="caption-text">Control</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="control.html">Algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running Experiments</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Experiment Outputs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#algorithm-outputs">Algorithm Outputs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pytorch-save-directory-info">PyTorch Save Directory Info</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tensorflow-save-directory-info">Tensorflow Save Directory Info</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#save-directory-location">Save Directory Location</a></li>
<li class="toctree-l2"><a class="reference internal" href="#loading-and-running-trained-policies">Loading and Running Trained Policies</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#if-environment-saves-successfully">If Environment Saves Successfully</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment-not-found-error">Environment Not Found Error</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-trained-value-functions">Using Trained Value Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">Plotting Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="bench/bench.html">Benchmarks</a></li>
</ul>
<p class="caption"><span class="caption-text">Hardware</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../hardware/hardware.html">Hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/supported.html">Supported hardware</a></li>
<li class="toctree-l1"><a class="reference internal" href="../hardware/deploy.html">Deploy</a></li>
</ul>
<p class="caption"><span class="caption-text">Simzoo</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../simzoo/simzoo.html">Simzoo</a></li>
</ul>
<p class="caption"><span class="caption-text">Utilities Docs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../utils/logger.html">Logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/plotter.html">Plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/mpi.html">MPI Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../utils/run_utils.html">Run Utils</a></li>
</ul>
<p class="caption"><span class="caption-text">Developer Zone</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/api/api.html">Code API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/release_dev.html">Release package</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/doc_dev.html">Release documentation</a></li>
</ul>
<p class="caption"><span class="caption-text">Etc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../etc/acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../etc/author.html">About the Author</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Machine Learning Control</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Experiment Outputs</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/control/saving_and_loading.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="experiment-outputs">
<h1><a class="toc-backref" href="#id1">Experiment Outputs</a><a class="headerlink" href="#experiment-outputs" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#experiment-outputs" id="id1">Experiment Outputs</a><ul>
<li><a class="reference internal" href="#algorithm-outputs" id="id2">Algorithm Outputs</a><ul>
<li><a class="reference internal" href="#pytorch-save-directory-info" id="id3">PyTorch Save Directory Info</a></li>
<li><a class="reference internal" href="#tensorflow-save-directory-info" id="id4">Tensorflow Save Directory Info</a></li>
</ul>
</li>
<li><a class="reference internal" href="#save-directory-location" id="id5">Save Directory Location</a></li>
<li><a class="reference internal" href="#loading-and-running-trained-policies" id="id6">Loading and Running Trained Policies</a><ul>
<li><a class="reference internal" href="#if-environment-saves-successfully" id="id7">If Environment Saves Successfully</a></li>
<li><a class="reference internal" href="#environment-not-found-error" id="id8">Environment Not Found Error</a></li>
<li><a class="reference internal" href="#using-trained-value-functions" id="id9">Using Trained Value Functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<p>In this section we’ll cover</p>
<ul class="simple">
<li>what outputs come from Spinning Up algorithm implementations,</li>
<li>what formats they’re stored in and how they’re organized,</li>
<li>where they are stored and how you can change that,</li>
<li>and how to load and run trained policies.</li>
</ul>
<div class="admonition-you-should-know admonition">
<p class="first admonition-title">You Should Know</p>
<p class="last">Spinning Up implementations currently have no way to resume training for partially-trained agents. If you consider this feature important, please let us know—or consider it a hacking project!</p>
</div>
<div class="section" id="algorithm-outputs">
<h2><a class="toc-backref" href="#id2">Algorithm Outputs</a><a class="headerlink" href="#algorithm-outputs" title="Permalink to this headline">¶</a></h2>
<p>Each algorithm is set up to save a training run’s hyperparameter configuration, learning progress, trained agent and value functions, and a copy of the environment if possible (to make it easy to load up the agent and environment simultaneously). The output directory contains the following:</p>
<table border="1" class="docutils">
<colgroup>
<col width="20%" />
<col width="80%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="2"><strong>Output Directory Structure</strong></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">pyt_save/</span></code></td>
<td><div class="first last line-block">
<div class="line"><strong>PyTorch implementations only.</strong> A directory containing</div>
<div class="line">everything needed to restore the trained agent and value</div>
<div class="line">functions. (<a class="reference internal" href="#details-for-pytorch-saves-below">Details for PyTorch saves below.</a>)</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">tf1_save/</span></code></td>
<td><div class="first last line-block">
<div class="line"><strong>Tensorflow implementations only.</strong> A directory containing</div>
<div class="line">everything needed to restore the trained agent and value</div>
<div class="line">functions. (<a class="reference internal" href="#details-for-tensorflow-saves-below">Details for Tensorflow saves below.</a>)</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">config.json</span></code></td>
<td><div class="first last line-block">
<div class="line">A dict containing an as-complete-as-possible description</div>
<div class="line">of the args and kwargs you used to launch the training</div>
<div class="line">function. If you passed in something which can’t be</div>
<div class="line">serialised to JSON, it should get handled gracefully by the</div>
<div class="line">logger, and the config file will represent it with a string.</div>
<div class="line">Note: this is meant for record-keeping only. Launching an</div>
<div class="line">experiment from a config file is not currently supported.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">progress.txt</span></code></td>
<td><div class="first last line-block">
<div class="line">A tab-separated value file containing records of the metrics</div>
<div class="line">recorded by the logger throughout training. eg, <code class="docutils literal notranslate"><span class="pre">Epoch</span></code>,</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">AverageEpRet</span></code>, etc.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">vars.pkl</span></code></td>
<td><div class="first last line-block">
<div class="line">A pickle file containing anything about the algorithm state</div>
<div class="line">which should get stored. Currently, all algorithms only use</div>
<div class="line">this to save a copy of the environment.</div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="admonition-you-should-know admonition">
<p class="first admonition-title">You Should Know</p>
<p class="last">Sometimes environment-saving fails because the environment can’t be pickled, and <code class="docutils literal notranslate"><span class="pre">vars.pkl</span></code> is empty. This is known to be a problem for Gym Box2D environments in older versions of Gym, which can’t be saved in this manner.</p>
</div>
<div class="admonition-you-should-know admonition">
<p class="first admonition-title">You Should Know</p>
<p class="last">As of 1/30/20, the save directory structure has changed slightly. Previously, Tensorflow graphs were saved in the <code class="docutils literal notranslate"><span class="pre">simple_save/</span></code> folder; this has been replaced with <code class="docutils literal notranslate"><span class="pre">tf1_save/</span></code>.</p>
</div>
<div class="admonition-you-should-know admonition">
<p class="first admonition-title">You Should Know</p>
<p class="last">The only file in here that you should ever have to use “by hand” is the <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file. Our agent testing utility will load things from the <code class="docutils literal notranslate"><span class="pre">tf1_save/</span></code> or <code class="docutils literal notranslate"><span class="pre">pyt_save/</span></code> directory, and our plotter interprets the contents of <code class="docutils literal notranslate"><span class="pre">progress.txt</span></code>, and those are the correct tools for interfacing with these outputs. But there is no tooling for <code class="docutils literal notranslate"><span class="pre">config.json</span></code>—it’s just there so that if you forget what hyperparameters you ran an experiment with, you can double-check.</p>
</div>
<div class="section" id="pytorch-save-directory-info">
<h3><a class="toc-backref" href="#id3">PyTorch Save Directory Info</a><a class="headerlink" href="#pytorch-save-directory-info" title="Permalink to this headline">¶</a></h3>
<p id="details-for-pytorch-saves-below">The <code class="docutils literal notranslate"><span class="pre">pyt_save</span></code> directory contains:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="2"><strong>Pyt_Save Directory Structure</strong></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">model.pt</span></code></td>
<td><div class="first last line-block">
<div class="line">A file created with <code class="docutils literal notranslate"><span class="pre">torch.save</span></code>, essentially just a</div>
<div class="line">pickled PyTorch <code class="docutils literal notranslate"><span class="pre">nn.Module</span></code>. Loading it will restore</div>
<div class="line">a trained agent as an ActorCritic object with an <code class="docutils literal notranslate"><span class="pre">act</span></code></div>
<div class="line">method.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="tensorflow-save-directory-info">
<h3><a class="toc-backref" href="#id4">Tensorflow Save Directory Info</a><a class="headerlink" href="#tensorflow-save-directory-info" title="Permalink to this headline">¶</a></h3>
<p id="details-for-tensorflow-saves-below">The <code class="docutils literal notranslate"><span class="pre">tf1_save</span></code> directory contains:</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td colspan="2"><strong>TF1_Save Directory Structure</strong></td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">variables/</span></code></td>
<td><div class="first last line-block">
<div class="line">A directory containing outputs from the Tensorflow Saver.</div>
<div class="line">See documentation for <a class="reference external" href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/saved_model/README.md">Tensorflow SavedModel</a>.</div>
</div>
</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal notranslate"><span class="pre">model_info.pkl</span></code></td>
<td><div class="first last line-block">
<div class="line">A dict containing information (map from key to tensor name)</div>
<div class="line">which helps us unpack the saved model after loading.</div>
</div>
</td>
</tr>
<tr class="row-even"><td><code class="docutils literal notranslate"><span class="pre">saved_model.pb</span></code></td>
<td><div class="first last line-block">
<div class="line">A protocol buffer, needed for a <a class="reference external" href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/python/saved_model/README.md">Tensorflow SavedModel</a>.</div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="save-directory-location">
<h2><a class="toc-backref" href="#id5">Save Directory Location</a><a class="headerlink" href="#save-directory-location" title="Permalink to this headline">¶</a></h2>
<p>Experiment results will, by default, be saved in the same directory as the Spinning Up package, in a folder called <code class="docutils literal notranslate"><span class="pre">data</span></code>:</p>
<pre class="literal-block">
spinningup/
    <strong>data/</strong>
        ...
    docs/
        ...
    machine_learning_control/
        ...
    LICENSE
    setup.py
</pre>
<p>You can change the default results directory by modifying <code class="docutils literal notranslate"><span class="pre">DEFAULT_DATA_DIR</span></code> in <code class="docutils literal notranslate"><span class="pre">machine_learning_control/user_config.py</span></code>.</p>
</div>
<div class="section" id="loading-and-running-trained-policies">
<h2><a class="toc-backref" href="#id6">Loading and Running Trained Policies</a><a class="headerlink" href="#loading-and-running-trained-policies" title="Permalink to this headline">¶</a></h2>
<div class="section" id="if-environment-saves-successfully">
<h3><a class="toc-backref" href="#id7">If Environment Saves Successfully</a><a class="headerlink" href="#if-environment-saves-successfully" title="Permalink to this headline">¶</a></h3>
<p>For cases where the environment is successfully saved alongside the agent, it’s a cinch to watch the trained agent act in the environment using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python</span> <span class="o">-</span><span class="n">m</span> <span class="n">machine_learning_control</span><span class="o">.</span><span class="n">run</span> <span class="n">test_policy</span> <span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">output_directory</span>
</pre></div>
</div>
<p>There are a few flags for options:</p>
<dl class="option">
<dt id="cmdoption-l">
<code class="descname">-l</code><code class="descclassname"> L</code><code class="descclassname">, </code><code class="descname">--len</code><code class="descclassname">=L</code><code class="descclassname">, </code><code class="descname">default</code><code class="descclassname">=0</code><a class="headerlink" href="#cmdoption-l" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em>. Maximum length of test episode / trajectory / rollout. The default of 0 means no maximum episode length—episodes only end when the agent has reached a terminal state in the environment. (Note: setting L=0 will not prevent Gym envs wrapped by TimeLimit wrappers from ending when they reach their pre-set maximum episode length.)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-n">
<code class="descname">-n</code><code class="descclassname"> N</code><code class="descclassname">, </code><code class="descname">--episodes</code><code class="descclassname">=N</code><code class="descclassname">, </code><code class="descname">default</code><code class="descclassname">=100</code><a class="headerlink" href="#cmdoption-n" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em>. Number of test episodes to run the agent for.</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-nr">
<code class="descname">-nr</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--norender</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-nr" title="Permalink to this definition">¶</a></dt>
<dd><p>Do not render the test episodes to the screen. In this case, <code class="docutils literal notranslate"><span class="pre">test_policy</span></code> will only print the episode returns and lengths. (Use case: the renderer slows down the testing process, and you just want to get a fast sense of how the agent is performing, so you don’t particularly care to watch it.)</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-i">
<code class="descname">-i</code><code class="descclassname"> I</code><code class="descclassname">, </code><code class="descname">--itr</code><code class="descclassname">=I</code><code class="descclassname">, </code><code class="descname">default</code><code class="descclassname">=-1</code><a class="headerlink" href="#cmdoption-i" title="Permalink to this definition">¶</a></dt>
<dd><p><em>int</em>. This is an option for a special case which is not supported by algorithms in this package as-shipped, but which they are easily modified to do. Use case: Sometimes it’s nice to watch trained agents from many different points in training (eg watch at iteration 50, 100, 150, etc.). The logger can do this—save snapshots of the agent from those different points, so they can be run and watched later. In this case, you use this flag to specify which iteration to run. But again: machine_learning_control algorithms by default only save snapshots of the most recent agent, overwriting the old snapshots.</p>
<p>The default value of this flag means “use the latest snapshot.”</p>
<p>To modify an algo so it does produce multiple snapshots, find the following line (which is present in all of the algorithms):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="n">save_state</span><span class="p">({</span><span class="s1">&#39;env&#39;</span><span class="p">:</span> <span class="n">env</span><span class="p">},</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>and tweak it to</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span><span class="o">.</span><span class="n">save_state</span><span class="p">({</span><span class="s1">&#39;env&#39;</span><span class="p">:</span> <span class="n">env</span><span class="p">},</span> <span class="n">epoch</span><span class="p">)</span>
</pre></div>
</div>
<p>Make sure to then also set <code class="docutils literal notranslate"><span class="pre">save_freq</span></code> to something reasonable (because if it defaults to 1, for instance, you’ll flood your output directory with one <code class="docutils literal notranslate"><span class="pre">save</span></code> folder for each snapshot—which adds up fast).</p>
</dd></dl>

<dl class="option">
<dt id="cmdoption-d">
<code class="descname">-d</code><code class="descclassname"></code><code class="descclassname">, </code><code class="descname">--deterministic</code><code class="descclassname"></code><a class="headerlink" href="#cmdoption-d" title="Permalink to this definition">¶</a></dt>
<dd><p>Another special case, which is only used for SAC. The Spinning Up SAC implementation trains a stochastic policy, but is evaluated using the deterministic <em>mean</em> of the action distribution. <code class="docutils literal notranslate"><span class="pre">test_policy</span></code> will default to using the stochastic policy trained by SAC, but you should set the deterministic flag to watch the deterministic mean policy (the correct evaluation policy for SAC). This flag is not used for any other algorithms.</p>
</dd></dl>

</div>
<div class="section" id="environment-not-found-error">
<h3><a class="toc-backref" href="#id8">Environment Not Found Error</a><a class="headerlink" href="#environment-not-found-error" title="Permalink to this headline">¶</a></h3>
<p>If the environment wasn’t saved successfully, you can expect <code class="docutils literal notranslate"><span class="pre">test_policy.py</span></code> to crash with something that looks like</p>
<pre class="literal-block">
Traceback (most recent call last):
  File &quot;machine_learning_control/control/utils/test_policy.py&quot;, line 153, in &lt;module&gt;
    run_policy(env, get_action, args.len, args.episodes, not(args.norender))
  File &quot;machine_learning_control/control/utils/test_policy.py&quot;, line 114, in run_policy
    &quot;and we can't run the agent in it. :( nn Check out the readthedocs &quot; +
AssertionError: Environment not found!

 It looks like the environment wasn't saved, and we can't run the agent in it. :(

 Check out the readthedocs page on Experiment Outputs for how to handle this situation.
</pre>
<p>In this case, watching your agent perform is slightly more of a pain but not impossible, as long as you can recreate your environment easily. Try the following in IPython:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">machine_learning_control.control.utils.test_policy</span> <span class="kn">import</span> <span class="n">load_policy_and_env</span><span class="p">,</span> <span class="n">run_policy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">your_env</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="p">,</span> <span class="n">get_action</span> <span class="o">=</span> <span class="n">load_policy_and_env</span><span class="p">(</span><span class="s1">&#39;/path/to/output_directory&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">your_env</span><span class="o">.</span><span class="n">make</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">run_policy</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="n">get_action</span><span class="p">)</span>
<span class="go">Logging data to /tmp/experiments/1536150702/progress.txt</span>
<span class="go">Episode 0    EpRet -163.830      EpLen 93</span>
<span class="go">Episode 1    EpRet -346.164      EpLen 99</span>
<span class="gp">...</span>
</pre></div>
</div>
</div>
<div class="section" id="using-trained-value-functions">
<h3><a class="toc-backref" href="#id9">Using Trained Value Functions</a><a class="headerlink" href="#using-trained-value-functions" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">test_policy.py</span></code> tool doesn’t help you look at trained value functions, and if you want to use those, you will have to do some digging by hand. For the PyTorch case, load the saved model file with <code class="docutils literal notranslate"><span class="pre">torch.load</span></code> and check the documentation for each algorithm to see what modules the ActorCritic object has. For the Tensorflow case, load the saved computation graph with the <a class="reference external" href="../utils/logger.html#machine_learning_control.control.utils.logx.restore_tf_graph">restore_tf_graph</a> function, and check the documentation for each algorithm to see what functions were saved.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="plotting.html" class="btn btn-neutral float-right" title="Plotting Results" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="running.html" class="btn btn-neutral float-left" title="Running Experiments" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Rick Staa

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>