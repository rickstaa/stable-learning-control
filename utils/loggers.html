<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Loggers &mdash; stable-learning-control 6.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
      <link rel="stylesheet" type="text/css" href="../_static/css/modify.css?v=519ed47b" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=9497d378"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MPI Tools" href="mpi.html" />
    <link rel="prev" title="Benchmarks" href="../usage/benchmarks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.svg" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                6.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usage/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/docker.html">Use with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/algorithms.html">Available Agents</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/running.html">Running Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/hyperparameter_tuning.html">Hyperparameter Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/saving_and_loading.html">Experiment Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/plotting.html">Plotting Results</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/eval_robustness.html">Evaluating Robustness</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usage/benchmarks.html">Benchmarks</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Utilities</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Loggers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-a-logger">Using a Logger</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#examples">Examples</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logging-and-tensorflow">Logging and TensorFlow</a></li>
<li class="toctree-l3"><a class="reference internal" href="#logging-and-mpi">Logging and MPI</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#logger-classes">Logger Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger"><code class="docutils literal notranslate"><span class="pre">Logger</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.__init__"><code class="docutils literal notranslate"><span class="pre">Logger.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_writer"><code class="docutils literal notranslate"><span class="pre">Logger.tb_writer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.output_dir"><code class="docutils literal notranslate"><span class="pre">Logger.output_dir</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.output_file"><code class="docutils literal notranslate"><span class="pre">Logger.output_file</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.exp_name"><code class="docutils literal notranslate"><span class="pre">Logger.exp_name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.wandb"><code class="docutils literal notranslate"><span class="pre">Logger.wandb</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.log"><code class="docutils literal notranslate"><span class="pre">Logger.log()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.log_to_tb"><code class="docutils literal notranslate"><span class="pre">Logger.log_to_tb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.log_tabular"><code class="docutils literal notranslate"><span class="pre">Logger.log_tabular()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.dump_tabular"><code class="docutils literal notranslate"><span class="pre">Logger.dump_tabular()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.get_logdir"><code class="docutils literal notranslate"><span class="pre">Logger.get_logdir()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.save_config"><code class="docutils literal notranslate"><span class="pre">Logger.save_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.load_config"><code class="docutils literal notranslate"><span class="pre">Logger.load_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.load_env"><code class="docutils literal notranslate"><span class="pre">Logger.load_env()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.save_to_json"><code class="docutils literal notranslate"><span class="pre">Logger.save_to_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.load_from_json"><code class="docutils literal notranslate"><span class="pre">Logger.load_from_json()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.save_state"><code class="docutils literal notranslate"><span class="pre">Logger.save_state()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.setup_tf_saver"><code class="docutils literal notranslate"><span class="pre">Logger.setup_tf_saver()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.setup_pytorch_saver"><code class="docutils literal notranslate"><span class="pre">Logger.setup_pytorch_saver()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.use_tensorboard"><code class="docutils literal notranslate"><span class="pre">Logger.use_tensorboard</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.log_current_row"><code class="docutils literal notranslate"><span class="pre">Logger.log_current_row</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.watch_model_in_wandb"><code class="docutils literal notranslate"><span class="pre">Logger.watch_model_in_wandb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.log_model_to_tb"><code class="docutils literal notranslate"><span class="pre">Logger.log_model_to_tb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_scalar"><code class="docutils literal notranslate"><span class="pre">Logger.add_tb_scalar()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_scalar"><code class="docutils literal notranslate"><span class="pre">Logger.tb_scalar()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_histogram"><code class="docutils literal notranslate"><span class="pre">Logger.add_tb_histogram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_histogram"><code class="docutils literal notranslate"><span class="pre">Logger.tb_histogram()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_image"><code class="docutils literal notranslate"><span class="pre">Logger.add_tb_image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_image"><code class="docutils literal notranslate"><span class="pre">Logger.tb_image()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_text"><code class="docutils literal notranslate"><span class="pre">Logger.add_tb_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_text"><code class="docutils literal notranslate"><span class="pre">Logger.tb_text()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_graph"><code class="docutils literal notranslate"><span class="pre">Logger.add_tb_graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_graph"><code class="docutils literal notranslate"><span class="pre">Logger.tb_graph()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_hparams"><code class="docutils literal notranslate"><span class="pre">Logger.add_tb_hparams()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.flush_tb_writer"><code class="docutils literal notranslate"><span class="pre">Logger.flush_tb_writer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger"><code class="docutils literal notranslate"><span class="pre">EpochLogger</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.epoch_dict"><code class="docutils literal notranslate"><span class="pre">EpochLogger.epoch_dict</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.store"><code class="docutils literal notranslate"><span class="pre">EpochLogger.store()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.log_to_tb"><code class="docutils literal notranslate"><span class="pre">EpochLogger.log_to_tb()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular"><code class="docutils literal notranslate"><span class="pre">EpochLogger.log_tabular()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.dump_tabular"><code class="docutils literal notranslate"><span class="pre">EpochLogger.dump_tabular()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.get_stats"><code class="docutils literal notranslate"><span class="pre">EpochLogger.get_stats()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#logger-helper-functions">Logger helper functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#stable_learning_control.utils.log_utils.setup_logger_kwargs"><code class="docutils literal notranslate"><span class="pre">setup_logger_kwargs()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mpi.html">MPI Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="run_utils.html">Run Utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotter.html">Plotter</a></li>
<li class="toctree-l1"><a class="reference internal" href="testers.html">Policy testers</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dev/contributing.html">Contribute to stable-learning-control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/doc_dev.html">Build the documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev/license.html">License</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../autoapi/index.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Etc.</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../etc/acknowledgements.html">Acknowledgements</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">stable-learning-control</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Loggers</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/rickstaa/stable-learning-control/blob/main/docs/source/utils/loggers.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="loggers">
<span id="id1"></span><h1><a class="toc-backref" href="#id2" role="doc-backlink">Loggers</a><a class="headerlink" href="#loggers" title="Permalink to this heading"></a></h1>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#loggers" id="id2">Loggers</a></p>
<ul>
<li><p><a class="reference internal" href="#using-a-logger" id="id3">Using a Logger</a></p>
<ul>
<li><p><a class="reference internal" href="#examples" id="id4">Examples</a></p></li>
<li><p><a class="reference internal" href="#logging-and-tensorflow" id="id5">Logging and TensorFlow</a></p></li>
<li><p><a class="reference internal" href="#logging-and-mpi" id="id6">Logging and MPI</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#logger-classes" id="id7">Logger Classes</a></p></li>
<li><p><a class="reference internal" href="#logger-helper-functions" id="id8">Logger helper functions</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="using-a-logger">
<h2><a class="toc-backref" href="#id3" role="doc-backlink">Using a Logger</a><a class="headerlink" href="#using-a-logger" title="Permalink to this heading"></a></h2>
<p>SLC ships with basic logging tools, implemented in the classes
<a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger" title="stable_learning_control.utils.log_utils.logx.Logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></a>
and <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger" title="stable_learning_control.utils.log_utils.logx.EpochLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">EpochLogger</span></code></a>. The Logger
class contains most of the basic functionality for saving diagnostics,
hyperparameter configurations, the state of a training run, and the trained model. The EpochLogger
class adds a thin layer to make it easy to track a diagnostic’s average, standard deviation, min,
and max value over each epoch and across MPI workers.</p>
<div class="admonition-you-should-know admonition">
<p class="admonition-title">You Should Know</p>
<p>All SLC algorithm implementations use an EpochLogger.</p>
</div>
<p>These loggers allow you to write these diagnostics to the <code class="docutils literal notranslate"><span class="pre">stdout</span></code>, a <code class="docutils literal notranslate"><span class="pre">csv/txt</span></code> file, <a class="reference external" href="https://www.tensorflow.org/tensorboard/">TensorBoard</a> and/or
<a class="reference external" href="https://docs.wandb.ai/">Weights &amp; Biases</a>.</p>
<section id="examples">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Examples</a><a class="headerlink" href="#examples" title="Permalink to this heading"></a></h3>
<p>First, let’s look at a simple example of how an <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger" title="stable_learning_control.utils.log_utils.logx.EpochLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">EpochLogger</span></code></a>
keeps track of a diagnostic value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stable_learning_control.utils.logx</span> <span class="kn">import</span> <span class="n">EpochLogger</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epoch_logger</span> <span class="o">=</span> <span class="n">EpochLogger</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="go">        epoch_logger.store(Test=i)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epoch_logger</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span><span class="s1">&#39;Test&#39;</span><span class="p">,</span> <span class="n">with_min_and_max</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epoch_logger</span><span class="o">.</span><span class="n">dump_tabular</span><span class="p">()</span>
<span class="go">-------------------------------------</span>
<span class="go">|     AverageTest |             4.5 |</span>
<span class="go">|         StdTest |            2.87 |</span>
<span class="go">|         MaxTest |               9 |</span>
<span class="go">|         MinTest |               0 |</span>
<span class="go">-------------------------------------</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.store" title="stable_learning_control.utils.log_utils.logx.EpochLogger.store"><code class="xref py py-meth docutils literal notranslate"><span class="pre">store()</span></code></a> method is used to save all
values of <code class="docutils literal notranslate"><span class="pre">Test</span></code> to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger" title="stable_learning_control.utils.log_utils.logx.EpochLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">EpochLogger</span></code></a>’s internal
state. Then, when <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular" title="stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_tabular()</span></code></a> is called,
it computes the average, standard deviation, min, and max of <code class="docutils literal notranslate"><span class="pre">Test</span></code> over all of the values in the internal state.
The internal state is wiped clean after the call to <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular" title="stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_tabular()</span></code></a>
(to prevent leakage into the diagnostics at the next epoch). Finally, <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.dump_tabular" title="stable_learning_control.utils.log_utils.logx.EpochLogger.dump_tabular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dump_tabular()</span></code></a>
is called to write the diagnostics to file, TensorBoard, Weights &amp; Biases and/or stdout.</p>
<p>Next, let’s use the <a class="reference external" href="https://pytorch.org/tutorials/beginner/blitz/cifar10_tutorial.html">Pytorch Classifier</a> tutorial to look at an entire training procedure with the logger embedded, to highlight configuration and model
saving as well as diagnostic logging:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span> <span class="kn">import</span> <span class="nn">time</span>
<span class="linenos">  2</span> <span class="kn">import</span> <span class="nn">math</span>
<span class="linenos">  3</span>
<span class="linenos">  4</span> <span class="kn">import</span> <span class="nn">torch</span>
<span class="linenos">  5</span> <span class="kn">import</span> <span class="nn">torch.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="linenos">  6</span> <span class="kn">import</span> <span class="nn">torch.nn.functional</span> <span class="k">as</span> <span class="nn">F</span>
<span class="linenos">  7</span> <span class="kn">import</span> <span class="nn">torchvision</span>
<span class="linenos">  8</span> <span class="kn">import</span> <span class="nn">torch.optim</span> <span class="k">as</span> <span class="nn">optim</span>
<span class="linenos">  9</span> <span class="kn">import</span> <span class="nn">torchvision.transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
<span class="linenos"> 10</span> <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="linenos"> 11</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 12</span>
<span class="hll"><span class="linenos"> 13</span> <span class="kn">from</span> <span class="nn">stable_learning_control.utils.log_utils.logx</span> <span class="kn">import</span> <span class="n">EpochLogger</span>
</span><span class="linenos"> 14</span>
<span class="linenos"> 15</span>
<span class="linenos"> 16</span> <span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Module</span><span class="p">):</span>
<span class="linenos"> 17</span>     <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="linenos"> 18</span>         <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="linenos"> 19</span>         <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="linenos"> 20</span>         <span class="bp">self</span><span class="o">.</span><span class="n">pool</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="linenos"> 21</span>         <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="linenos"> 22</span>         <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">120</span><span class="p">)</span>
<span class="linenos"> 23</span>         <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="mi">84</span><span class="p">)</span>
<span class="linenos"> 24</span>         <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">84</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="linenos"> 25</span>
<span class="linenos"> 26</span>     <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="linenos"> 27</span>         <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="linenos"> 28</span>         <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">pool</span><span class="p">(</span><span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
<span class="linenos"> 29</span>         <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">)</span>
<span class="linenos"> 30</span>         <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="linenos"> 31</span>         <span class="n">x</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="linenos"> 32</span>         <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="linenos"> 33</span>         <span class="k">return</span> <span class="n">x</span>
<span class="linenos"> 34</span>
<span class="linenos"> 35</span>
<span class="linenos"> 36</span> <span class="k">def</span> <span class="nf">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">):</span>
<span class="linenos"> 37</span>     <span class="n">img</span> <span class="o">=</span> <span class="n">img</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mf">0.5</span>  <span class="c1"># unnormalize.</span>
<span class="linenos"> 38</span>     <span class="n">npimg</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="linenos"> 39</span>     <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">npimg</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)))</span>
<span class="linenos"> 40</span>     <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="linenos"> 41</span>
<span class="linenos"> 42</span> <span class="c1"># Simple script for training an CNN on CIFAR10.</span>
<span class="linenos"> 43</span> <span class="k">def</span> <span class="nf">train_cifar10</span><span class="p">(</span>
<span class="linenos"> 44</span>     <span class="n">epochs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
<span class="linenos"> 45</span>     <span class="n">batch_size</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
<span class="linenos"> 46</span>     <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">,</span>
<span class="linenos"> 47</span>     <span class="n">logger_kwargs</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span>
<span class="linenos"> 48</span>     <span class="n">save_freq</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="linenos"> 49</span> <span class="p">):</span>
<span class="linenos"> 50</span>     <span class="c1"># Setup logger and save hyperparameters.</span>
<span class="hll"><span class="linenos"> 51</span>     <span class="n">logger</span> <span class="o">=</span> <span class="n">EpochLogger</span><span class="p">(</span><span class="o">**</span><span class="n">logger_kwargs</span><span class="p">,</span> <span class="n">verbose_fmt</span><span class="o">=</span><span class="s2">&quot;tab&quot;</span><span class="p">)</span>
</span><span class="hll"><span class="linenos"> 52</span>     <span class="n">logger</span><span class="o">.</span><span class="n">save_config</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
</span><span class="linenos"> 53</span>
<span class="linenos"> 54</span>     <span class="c1"># Load and preprocess CIFAR10 data</span>
<span class="linenos"> 55</span>     <span class="n">transform</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
<span class="linenos"> 56</span>         <span class="p">[</span><span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">(),</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Normalize</span><span class="p">((</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span> <span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))]</span>
<span class="linenos"> 57</span>     <span class="p">)</span>
<span class="linenos"> 58</span>     <span class="n">trainset</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">CIFAR10</span><span class="p">(</span>
<span class="linenos"> 59</span>         <span class="n">root</span><span class="o">=</span><span class="s2">&quot;./data&quot;</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">download</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">transform</span>
<span class="linenos"> 60</span>     <span class="p">)</span>
<span class="linenos"> 61</span>     <span class="n">trainloader</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">DataLoader</span><span class="p">(</span>
<span class="linenos"> 62</span>         <span class="n">trainset</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">num_workers</span><span class="o">=</span><span class="mi">2</span>
<span class="linenos"> 63</span>     <span class="p">)</span>
<span class="linenos"> 64</span>     <span class="n">classes</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos"> 65</span>         <span class="s2">&quot;plane&quot;</span><span class="p">,</span>
<span class="linenos"> 66</span>         <span class="s2">&quot;car&quot;</span><span class="p">,</span>
<span class="linenos"> 67</span>         <span class="s2">&quot;bird&quot;</span><span class="p">,</span>
<span class="linenos"> 68</span>         <span class="s2">&quot;cat&quot;</span><span class="p">,</span>
<span class="linenos"> 69</span>         <span class="s2">&quot;deer&quot;</span><span class="p">,</span>
<span class="linenos"> 70</span>         <span class="s2">&quot;dog&quot;</span><span class="p">,</span>
<span class="linenos"> 71</span>         <span class="s2">&quot;frog&quot;</span><span class="p">,</span>
<span class="linenos"> 72</span>         <span class="s2">&quot;horse&quot;</span><span class="p">,</span>
<span class="linenos"> 73</span>         <span class="s2">&quot;ship&quot;</span><span class="p">,</span>
<span class="linenos"> 74</span>         <span class="s2">&quot;truck&quot;</span><span class="p">,</span>
<span class="linenos"> 75</span>     <span class="p">)</span>
<span class="linenos"> 76</span>
<span class="linenos"> 77</span>     <span class="c1"># print information about the dataset.</span>
<span class="linenos"> 78</span>     <span class="n">total_samples</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span>
<span class="linenos"> 79</span>     <span class="n">n_iterations</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">total_samples</span> <span class="o">/</span> <span class="n">batch_size</span><span class="p">)</span>
<span class="hll"><span class="linenos"> 80</span>     <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
</span><span class="hll"><span class="linenos"> 81</span>         <span class="s2">&quot;We perform </span><span class="si">{}</span><span class="s2"> epochs on our dataset that contains </span><span class="si">{}</span><span class="s2"> samples &quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
</span><span class="hll"><span class="linenos"> 82</span>             <span class="n">epochs</span><span class="p">,</span>
</span><span class="hll"><span class="linenos"> 83</span>             <span class="n">total_samples</span><span class="p">,</span>
</span><span class="hll"><span class="linenos"> 84</span>         <span class="p">)</span>
</span><span class="hll"><span class="linenos"> 85</span>         <span class="o">+</span> <span class="s2">&quot;and each epoch has </span><span class="si">{}</span><span class="s2"> iterations.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_iterations</span><span class="p">),</span>
</span><span class="hll"><span class="linenos"> 86</span>         <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;info&quot;</span><span class="p">,</span>
</span><span class="hll"><span class="linenos"> 87</span>     <span class="p">)</span>
</span><span class="linenos"> 88</span>
<span class="linenos"> 89</span>     <span class="c1"># get some random training images.</span>
<span class="linenos"> 90</span>     <span class="n">dataiter</span> <span class="o">=</span> <span class="nb">iter</span><span class="p">(</span><span class="n">trainloader</span><span class="p">)</span>
<span class="linenos"> 91</span>     <span class="n">images</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">dataiter</span><span class="o">.</span><span class="n">next</span><span class="p">()</span>
<span class="linenos"> 92</span>
<span class="linenos"> 93</span>     <span class="c1"># show images.</span>
<span class="linenos"> 94</span>     <span class="n">imshow</span><span class="p">(</span><span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">images</span><span class="p">))</span>
<span class="hll"><span class="linenos"> 95</span>     <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
</span><span class="hll"><span class="linenos"> 96</span>         <span class="s2">&quot;labels:&quot;</span> <span class="o">+</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%5s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">classes</span><span class="p">[</span><span class="n">labels</span><span class="p">[</span><span class="n">j</span><span class="p">]]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)),</span> <span class="nb">type</span><span class="o">=</span><span class="s2">&quot;info&quot;</span>
</span><span class="hll"><span class="linenos"> 97</span>     <span class="p">)</span>  <span class="c1"># print labels.</span>
</span><span class="linenos"> 98</span>
<span class="linenos"> 99</span>     <span class="c1"># Define a Convolutional Neural Network.</span>
<span class="linenos">100</span>     <span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="linenos">101</span>
<span class="linenos">102</span>     <span class="c1"># Define a Loss function and optimizer.</span>
<span class="linenos">103</span>     <span class="n">criterion</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="linenos">104</span>     <span class="n">optimizer</span> <span class="o">=</span> <span class="n">optim</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">parameters</span><span class="p">(),</span> <span class="n">lr</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span> <span class="n">momentum</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="linenos">105</span>
<span class="linenos">106</span>     <span class="c1"># Setup model saving.</span>
<span class="hll"><span class="linenos">107</span>     <span class="n">logger</span><span class="o">.</span><span class="n">setup_pytorch_saver</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
</span><span class="linenos">108</span>
<span class="linenos">109</span>     <span class="c1"># Run main training loop.</span>
<span class="linenos">110</span>     <span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="linenos">111</span>     <span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>  <span class="c1"># loop over the dataset multiple times.</span>
<span class="linenos">112</span>         <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">113</span>         <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">114</span>         <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">trainloader</span><span class="p">,</span> <span class="mi">0</span><span class="p">):</span>
<span class="linenos">115</span>             <span class="c1"># get the inputs; data is a list of [inputs, labels]</span>
<span class="linenos">116</span>             <span class="n">inputs</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="n">data</span>
<span class="linenos">117</span>
<span class="linenos">118</span>             <span class="c1"># zero the parameter gradients.</span>
<span class="linenos">119</span>             <span class="n">optimizer</span><span class="o">.</span><span class="n">zero_grad</span><span class="p">()</span>
<span class="linenos">120</span>
<span class="linenos">121</span>             <span class="c1"># forward + backward + optimize</span>
<span class="linenos">122</span>             <span class="n">outputs</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="linenos">123</span>             <span class="n">loss</span> <span class="o">=</span> <span class="n">criterion</span><span class="p">(</span><span class="n">outputs</span><span class="p">,</span> <span class="n">labels</span><span class="p">)</span>
<span class="linenos">124</span>             <span class="n">logger</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">Loss</span><span class="o">=</span><span class="n">loss</span><span class="p">)</span>
<span class="linenos">125</span>             <span class="n">loss</span><span class="o">.</span><span class="n">backward</span><span class="p">()</span>
<span class="linenos">126</span>             <span class="n">optimizer</span><span class="o">.</span><span class="n">step</span><span class="p">()</span>
<span class="linenos">127</span>
<span class="linenos">128</span>             <span class="c1"># calculate accuracy and increment running loss.</span>
<span class="linenos">129</span>             <span class="n">_</span><span class="p">,</span> <span class="n">predicted</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">outputs</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="linenos">130</span>             <span class="n">correct</span> <span class="o">+=</span> <span class="p">(</span><span class="n">predicted</span> <span class="o">==</span> <span class="n">labels</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="linenos">131</span>             <span class="n">accuracy</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">correct</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">trainset</span><span class="p">)</span>
<span class="linenos">132</span>             <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="linenos">133</span>
<span class="linenos">134</span>             <span class="c1"># print diagnostics.</span>
<span class="linenos">135</span>             <span class="n">running_loss</span> <span class="o">+=</span> <span class="n">loss</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
<span class="linenos">136</span>             <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">2000</span> <span class="o">==</span> <span class="mi">1999</span><span class="p">:</span>  <span class="c1"># print every 2000 mini-batches</span>
<span class="hll"><span class="linenos">137</span>                 <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span>
</span><span class="hll"><span class="linenos">138</span>                     <span class="s2">&quot;[</span><span class="si">%d</span><span class="s2">, </span><span class="si">%5d</span><span class="s2">] loss: </span><span class="si">%.3f</span><span class="s2">, acc: </span><span class="si">%.3f</span><span class="s2">&quot;</span>
</span><span class="hll"><span class="linenos">139</span>                     <span class="o">%</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">running_loss</span> <span class="o">/</span> <span class="mi">2000</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">140</span>                 <span class="p">)</span>
</span><span class="hll"><span class="linenos">141</span>                 <span class="n">logger</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">Loss</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">Acc</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
</span><span class="linenos">142</span>                 <span class="n">running_loss</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="linenos">143</span>                 <span class="n">correct</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">144</span>
<span class="linenos">145</span>         <span class="c1"># Save model.</span>
<span class="linenos">146</span>         <span class="k">if</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">%</span> <span class="n">save_freq</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">==</span> <span class="n">epochs</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
<span class="hll"><span class="linenos">147</span>             <span class="n">logger</span><span class="o">.</span><span class="n">save_state</span><span class="p">(</span><span class="n">state_dict</span><span class="o">=</span><span class="nb">dict</span><span class="p">(),</span> <span class="n">itr</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span class="linenos">148</span>
<span class="linenos">149</span>         <span class="c1"># Log info about epoch.</span>
<span class="hll"><span class="linenos">150</span>         <span class="n">logger</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span><span class="s2">&quot;Epoch&quot;</span><span class="p">,</span> <span class="n">epoch</span><span class="p">,</span> <span class="n">tb_write</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">151</span>         <span class="n">logger</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span><span class="s2">&quot;Acc&quot;</span><span class="p">,</span> <span class="n">with_min_and_max</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tb_write</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">152</span>         <span class="n">logger</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span><span class="s2">&quot;Loss&quot;</span><span class="p">,</span> <span class="n">average_only</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tb_write</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">153</span>         <span class="n">logger</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span>
</span><span class="hll"><span class="linenos">154</span>             <span class="s2">&quot;TotalGradientSteps&quot;</span><span class="p">,</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">total_samples</span><span class="p">,</span> <span class="n">tb_write</span><span class="o">=</span><span class="kc">True</span>
</span><span class="hll"><span class="linenos">155</span>         <span class="p">)</span>
</span><span class="hll"><span class="linenos">156</span>         <span class="n">logger</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span><span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">-</span> <span class="n">start_time</span><span class="p">)</span>
</span><span class="hll"><span class="linenos">157</span>         <span class="n">logger</span><span class="o">.</span><span class="n">dump_tabular</span><span class="p">()</span>
</span><span class="linenos">158</span>
<span class="hll"><span class="linenos">159</span>     <span class="n">logger</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="s2">&quot;Finished Training&quot;</span><span class="p">)</span>
</span><span class="linenos">160</span>
<span class="linenos">161</span> <span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">162</span>     <span class="n">train_cifar10</span><span class="p">()</span>
</pre></div>
</div>
<p>In this example, observe that</p>
<ul class="simple">
<li><p>on line 13, the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger" title="stable_learning_control.utils.log_utils.logx.EpochLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">EpochLogger</span></code></a> class is imported.</p></li>
<li><p>On line 51, the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger" title="stable_learning_control.utils.log_utils.logx.EpochLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">EpochLogger</span></code></a> object is initiated. We set the <code class="docutils literal notranslate"><span class="pre">stdout</span></code> format to the “tabular” format.</p></li>
<li><p>On line 52, <code class="xref py py-meth docutils literal notranslate"><span class="pre">save_config()</span></code> is used to save the hyperparameter configuration to a JSON file.</p></li>
<li><p>On lines 80-87, 95-97, 137-140 and 159 we log information to the <code class="docutils literal notranslate"><span class="pre">stdout</span></code>. Additionally we can specify the <code class="docutils literal notranslate"><span class="pre">use_wandb</span></code> flag to log information to Weights &amp; Biases.</p></li>
<li><p>On lines 107 <code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_pytorch_saver()</span></code> is used to prepare the logger to save the key elements of the CNN model.</p></li>
<li><p>On line 141, diagnostics are saved to the logger’s internal state via <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.store" title="stable_learning_control.utils.log_utils.logx.EpochLogger.store"><code class="xref py py-meth docutils literal notranslate"><span class="pre">store()</span></code></a>.</p></li>
<li><p>On line 147, the CNN model saved once per epoch via <code class="xref py py-meth docutils literal notranslate"><span class="pre">save_state()</span></code>.</p></li>
<li><p>On lines 150-157, <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular" title="stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_tabular()</span></code></a> and <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.dump_tabular" title="stable_learning_control.utils.log_utils.logx.EpochLogger.dump_tabular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dump_tabular()</span></code></a> are
used to write the epoch diagnostics to file. Note that the keys passed into <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular" title="stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_tabular()</span></code></a> are the same as the
keys passed into <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.store" title="stable_learning_control.utils.log_utils.logx.EpochLogger.store"><code class="xref py py-meth docutils literal notranslate"><span class="pre">store()</span></code></a>. We use the <code class="docutils literal notranslate"><span class="pre">tb_write=True</span></code> option to enable TensorBoard logging.</p></li>
</ul>
<p>After this script has finished, the following files should be added to a <code class="docutils literal notranslate"><span class="pre">/tmp/experiments/&lt;TIMESTAMP&gt;</span></code> folder:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">events.out.tfevents.*</span></code>: The TensorBoard event file containing the logged diagnostics (if TensorBoard logging is enabled).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">progress.csv</span></code>: Contains the logged diagnostics.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">config.json</span></code>: Contains the hyperparameter configuration.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">vars.pkl</span></code>: Contains some additional saved variables used for easy loading.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wandb</span></code>: Contains the Weights &amp; Biases logging files (if Weights &amp; Biases logging is enabled).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pyt_save</span></code>: Contains the saved PyTorch model (if PyTorch backend is used).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tf_save</span></code>: Contains the saved TensorFlow model (if TensorFlow backend is used).</p></li>
</ul>
<p>If you requested TensorBoard logging, you can use the <code class="docutils literal notranslate"><span class="pre">tensorboard</span> <span class="pre">--logdir=/tmp/experiments</span></code> command to see the diagnostics in TensorBoard. For Weights &amp; Biases logging, you can use
the <code class="docutils literal notranslate"><span class="pre">wandb</span> <span class="pre">login</span></code> command to log in to your Weights &amp; Biases account. You can view your logged diagnostics on the <a class="reference external" href="https://wandb.ai">Weights &amp; Biases website</a>.</p>
</section>
<section id="logging-and-tensorflow">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Logging and TensorFlow</a><a class="headerlink" href="#logging-and-tensorflow" title="Permalink to this heading"></a></h3>
<p>The preceding example was given in Pytorch. For TensorFlow, everything is the same except for L42-43:
instead of <code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_pytorch_saver()</span></code>, you would
use <code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_tf_saver()</span></code> and you would pass it
<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/nn">a TensorFlow Module</a> (the algorithm you train) as an argument.</p>
<p>The behavior of <code class="xref py py-meth docutils literal notranslate"><span class="pre">save_state()</span></code> is the same as in the
PyTorch case: each time it is called,
it’ll save the latest version of the TensorFlow module.</p>
</section>
<section id="logging-and-mpi">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Logging and MPI</a><a class="headerlink" href="#logging-and-mpi" title="Permalink to this heading"></a></h3>
<div class="admonition-you-should-know admonition">
<p class="admonition-title">You Should Know</p>
<p>Several RL algorithms are easily parallelized using MPI to average gradients and/or
other key quantities. The SLC loggers are designed to be well-behaved when using MPI:
things will only get written to stdout, file or TensorBoard from the process with rank
1. But information from other processes is preserved if you use the EpochLogger.
2. Everything passed into EpochLogger via <code class="docutils literal notranslate"><span class="pre">store</span></code>, regardless of which process
3. it’s stored in, gets used to compute average/std/min/max values for a diagnostic.</p>
</div>
</section>
</section>
<section id="logger-classes">
<h2><a class="toc-backref" href="#id7" role="doc-backlink">Logger Classes</a><a class="headerlink" href="#logger-classes" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_learning_control.utils.log_utils.logx.</span></span><span class="sig-name descname"><span class="pre">Logger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'progress.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'line'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'torch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir_exists_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_wandb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_job_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_project</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_run_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger" title="Permalink to this definition"></a></dt>
<dd><p>A general-purpose logger.</p>
<p>Makes it easy to save diagnostics, hyperparameter configurations, the
state of a training run, and the trained model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_fname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'progress.csv'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'line'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">backend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'torch'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir_exists_warning</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_wandb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_job_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_project</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_run_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Initialise a Logger.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – A directory for saving results to. If
<code class="docutils literal notranslate"><span class="pre">None</span></code>, defaults to a temp directory of the form
<code class="docutils literal notranslate"><span class="pre">/tmp/experiments/somerandomnumber</span></code>.</p></li>
<li><p><strong>output_fname</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Name for the (comma/tab) separated-value
file containing metrics logged throughout a training run. Defaults to
to <code class="docutils literal notranslate"><span class="pre">progress.csv</span></code> which uses commas as separators.</p></li>
<li><p><strong>exp_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Experiment name. If you run multiple training
runs and give them all the same <code class="docutils literal notranslate"><span class="pre">exp_name</span></code>, the plotter
will know to group them. (Use case: if you run the same
hyperparameter configuration with multiple random seeds, you
should give them all the same <code class="docutils literal notranslate"><span class="pre">exp_name</span></code>.)</p></li>
<li><p><strong>quiet</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether you want to suppress logging of the
diagnostics to the stdout. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>verbose_fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The format in which the diagnostics are
displayed to the terminal. Options are <code class="docutils literal notranslate"><span class="pre">tab</span></code> which supplies them as a
table and <code class="docutils literal notranslate"><span class="pre">line</span></code> which prints them in one line. Default is set in the
<a class="reference internal" href="../autoapi/stable_learning_control/user_config/index.html#module-stable_learning_control.user_config" title="stable_learning_control.user_config"><code class="xref py py-mod docutils literal notranslate"><span class="pre">user_config</span></code></a> file.</p></li>
<li><p><strong>verbose_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>, </em><em>optional</em>) – A list of variables you want to log to the
stdout. By default all variables are logged.</p></li>
<li><p><strong>save_checkpoints</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Save checkpoints during training.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>backend</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The backend you want to use for writing to
TensorBoard. Options are: <code class="docutils literal notranslate"><span class="pre">tf2</span></code> or <code class="docutils literal notranslate"><span class="pre">torch</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">torch</span></code>.</p></li>
<li><p><strong>output_dir_exists_warning</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to print a warning
when the output directory already exists. Defaults to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>use_wandb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to use Weights &amp; Biases for logging.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>wandb_job_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The Weights &amp; Biases job type. Defaults to
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>wandb_project</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the Weights &amp; Biases
project. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> which means that the project name is
automatically generated.</p></li>
<li><p><strong>wandb_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the Weights &amp; Biases group you want
to assign the run to. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>wandb_run_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the Weights &amp; Biases run.
Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code> which means that the run name is automatically
generated.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.tb_writer">
<span class="sig-name descname"><span class="pre">tb_writer</span></span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.tb_writer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_writer" title="Permalink to this definition"></a></dt>
<dd><p>A TensorBoard
writer. This is only created when you log a variable to TensorBoard or
set the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.use_tensorboard" title="stable_learning_control.utils.log_utils.logx.Logger.use_tensorboard"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Logger.use_tensorboard</span></code></a> variable to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensorboard.html#torch.utils.tensorboard.writer.SummaryWriter" title="(in PyTorch v2.4)">torch.utils.tensorboard.writer.SummaryWriter</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.output_dir">
<span class="sig-name descname"><span class="pre">output_dir</span></span><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.output_dir" title="Permalink to this definition"></a></dt>
<dd><p>The directory in which the log data and models are saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.output_file">
<span class="sig-name descname"><span class="pre">output_file</span></span><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.output_file" title="Permalink to this definition"></a></dt>
<dd><p>The name of the file in which the progress data is saved.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.exp_name">
<span class="sig-name descname"><span class="pre">exp_name</span></span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.exp_name"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.exp_name" title="Permalink to this definition"></a></dt>
<dd><p>Experiment name.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)">str</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.wandb">
<span class="sig-name descname"><span class="pre">wandb</span></span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.wandb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.wandb" title="Permalink to this definition"></a></dt>
<dd><p>A Weights &amp; Biases object. This is only created when you set
the <code class="xref py py-attr docutils literal notranslate"><span class="pre">Logger.use_wandb</span></code> variable to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>wandb</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.log">
<span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highlight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.log" title="Permalink to this definition"></a></dt>
<dd><p>Print a colorized message to <code class="docutils literal notranslate"><span class="pre">stdout</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Message you want to log.</p></li>
<li><p><strong>color</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Color you want the message to have. Defaults to
<code class="docutils literal notranslate"><span class="pre">&quot;&quot;</span></code>.</p></li>
<li><p><strong>bold</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether you want the text to be bold text has to be
bold.</p></li>
<li><p><strong>highlight</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether you want to highlight the text.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The log message type. Options are: <code class="docutils literal notranslate"><span class="pre">info</span></code>,
<code class="docutils literal notranslate"><span class="pre">warning</span></code> and <code class="docutils literal notranslate"><span class="pre">error</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>*args</strong> – All args to pass to the print function.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the print function.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.log_to_tb">
<span class="sig-name descname"><span class="pre">log_to_tb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.log_to_tb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.log_to_tb" title="Permalink to this definition"></a></dt>
<dd><p>Log a value to TensorBoard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The name of the diagnostic.</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><em>object</em></a>) – A value for the diagnostic.</p></li>
<li><p><strong>tb_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – A prefix which can be added to group the
variables.</p></li>
<li><p><strong>tb_alias</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – A tb alias for the variable you want to store
store. Defaults to empty <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>. If not supplied the variable name
is used.</p></li>
<li><p><strong>global_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Global step value to record. Uses internal step
counter if global step is not supplied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.log_tabular">
<span class="sig-name descname"><span class="pre">log_tabular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.log_tabular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.log_tabular" title="Permalink to this definition"></a></dt>
<dd><p>Log a value of some diagnostic.</p>
<p>Call this only once for each diagnostic quantity, each iteration.
After using <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.log_tabular" title="stable_learning_control.utils.log_utils.logx.Logger.log_tabular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">log_tabular()</span></code></a> to store values for each diagnostic,
make sure to call <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.dump_tabular" title="stable_learning_control.utils.log_utils.logx.Logger.dump_tabular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">dump_tabular()</span></code></a> to write them out to file,
TensorBoard and <code class="docutils literal notranslate"><span class="pre">stdout</span></code> (otherwise they will not get saved anywhere).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The name of the diagnostic. If you are logging a
diagnostic whose state has previously been saved with
<a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.store" title="stable_learning_control.utils.log_utils.logx.EpochLogger.store"><code class="xref py py-meth docutils literal notranslate"><span class="pre">EpochLogger.store()</span></code></a>, the key here has to match the key you used
there.</p></li>
<li><p><strong>val</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><em>object</em></a>) – A value for the diagnostic. If you have previously saved
values for this key via <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.store" title="stable_learning_control.utils.log_utils.logx.EpochLogger.store"><code class="xref py py-meth docutils literal notranslate"><span class="pre">EpochLogger.store()</span></code></a>, do <em>not</em> provide a
<code class="docutils literal notranslate"><span class="pre">val</span></code> here.</p></li>
<li><p><strong>tb_write</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Boolean specifying whether you also want to write
the value to the TensorBoard logfile. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>tb_metrics</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – List containing the metrics
you want to write to TensorBoard. Options are [<code class="docutils literal notranslate"><span class="pre">avg</span></code>, <code class="docutils literal notranslate"><span class="pre">std</span></code>,
<code class="docutils literal notranslate"><span class="pre">min</span></code>, <code class="docutils literal notranslate"><span class="pre">max</span></code>].`` Defaults to <code class="docutils literal notranslate"><span class="pre">avg</span></code>.</p></li>
<li><p><strong>tb_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – A prefix which can be added to group the
variables.</p></li>
<li><p><strong>tb_alias</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – A tb alias for the variable you want to store
store. Defaults to empty <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>. If not supplied the variable name
is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.dump_tabular">
<span class="sig-name descname"><span class="pre">dump_tabular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">global_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.dump_tabular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.dump_tabular" title="Permalink to this definition"></a></dt>
<dd><p>Write all of the diagnostics from the current iteration.</p>
<p>Writes both to <code class="docutils literal notranslate"><span class="pre">stdout</span></code>, TensorBoard and to the output file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>global_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Global step value to record. Uses internal step
counter if global step is not supplied.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.get_logdir">
<span class="sig-name descname"><span class="pre">get_logdir</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.get_logdir"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.get_logdir" title="Permalink to this definition"></a></dt>
<dd><p>Get Logger and TensorBoard SummaryWriter logdirs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the Summary/SummaryWriter object.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the Summary/SummaryWriter object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>dict containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>output_dir(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>): Logger output directory.</p></li>
<li><p>tb_output_dir(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">str</span></code></a>): TensorBoard writer output directory.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.save_config">
<span class="sig-name descname"><span class="pre">save_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.save_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.save_config" title="Permalink to this definition"></a></dt>
<dd><p>Log an experiment configuration.</p>
<p>Call this once at the top of your experiment, passing in all important
config vars as a dict. This will serialize the config to JSON, while
handling anything which can’t be serialized in a graceful way (writing
as informative a string as possible). The resulting JSON will be saved
to the output directory, made available to TensorBoard and Weights &amp; Biases and
printed to stdout.</p>
<p class="rubric">Example</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">logger</span> <span class="o">=</span> <span class="n">EpochLogger</span><span class="p">(</span><span class="o">**</span><span class="n">logger_kwargs</span><span class="p">)</span>
<span class="n">logger</span><span class="o">.</span><span class="n">save_config</span><span class="p">(</span><span class="nb">locals</span><span class="p">())</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><em>object</em></a>) – Configuration Python object you want to save.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.load_config">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.load_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.load_config" title="Permalink to this definition"></a></dt>
<dd><p>Loads an experiment configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Folder that contains the config files you want to load.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object containing the loaded configuration.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)">object</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.load_env">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_env</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.load_env"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.load_env" title="Permalink to this definition"></a></dt>
<dd><p>Loads a pickled environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>config_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Folder that contains the pickled environment.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The gymnasium environment.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<code class="xref py py-obj docutils literal notranslate"><span class="pre">gym.env</span></code>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.save_to_json">
<span class="sig-name descname"><span class="pre">save_to_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_object</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.save_to_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.save_to_json" title="Permalink to this definition"></a></dt>
<dd><p>Save python object to Json file. This method will serialize the object to
JSON, while handling anything which can’t be serialized in a graceful way
(writing as informative a string as possible).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_object</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><em>object</em></a>) – The input object you want to save.</p></li>
<li><p><strong>output_filename</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The output filename.</p></li>
<li><p><strong>output_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The output path. By default the
<a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.output_dir" title="stable_learning_control.utils.log_utils.logx.Logger.output_dir"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Logger.output_dir</span></code></a>  is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.load_from_json">
<span class="sig-name descname"><span class="pre">load_from_json</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.load_from_json"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.load_from_json" title="Permalink to this definition"></a></dt>
<dd><p>Load data from json file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The path of the json file you want to load.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>The Json load object.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)">object</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.save_state">
<span class="sig-name descname"><span class="pre">save_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">itr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.save_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.save_state" title="Permalink to this definition"></a></dt>
<dd><p>Saves the state of an experiment.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>To be clear: this is about saving <em>state</em>, not logging diagnostics.
All diagnostic logging is separate from this function. This function
will save whatever is in <code class="docutils literal notranslate"><span class="pre">state_dict</span></code>—usually just a copy of the
environment—and the most recent parameters for the model you
previously set up saving for with <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.setup_tf_saver" title="stable_learning_control.utils.log_utils.logx.Logger.setup_tf_saver"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_tf_saver()</span></code></a> or
<a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.setup_pytorch_saver" title="stable_learning_control.utils.log_utils.logx.Logger.setup_pytorch_saver"><code class="xref py py-meth docutils literal notranslate"><span class="pre">setup_pytorch_saver()</span></code></a>.</p>
</div>
<p>Call with any frequency you prefer. If you only want to maintain a
single state and overwrite it at each call with the most recent
version, leave <code class="docutils literal notranslate"><span class="pre">itr=None</span></code>. If you want to keep all of the states you
save, provide unique (increasing) values for ‘itr’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state_dict</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a>) – Dictionary containing essential elements to
describe the current state of training.</p></li>
<li><p><strong>itr</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>None</em><em>]</em>) – Current iteration of training (e.g. epoch). Defaults
to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.setup_tf_saver">
<span class="sig-name descname"><span class="pre">setup_tf_saver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what_to_save</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.setup_tf_saver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.setup_tf_saver" title="Permalink to this definition"></a></dt>
<dd><p>Set up easy model saving for a single Tensorlow model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>what_to_save</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><em>object</em></a>) – Any Tensorflow model or serializable object
containing TensorFlow models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.setup_pytorch_saver">
<span class="sig-name descname"><span class="pre">setup_pytorch_saver</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">what_to_save</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.setup_pytorch_saver"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.setup_pytorch_saver" title="Permalink to this definition"></a></dt>
<dd><p>Set up easy model saving for a single PyTorch model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>what_to_save</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><em>object</em></a>) – Any PyTorch model or serializable object containing
PyTorch models.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.use_tensorboard">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">use_tensorboard</span></span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.use_tensorboard"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.use_tensorboard" title="Permalink to this definition"></a></dt>
<dd><p>Variable specifying whether the logger uses TensorBoard. A TensorBoard writer
is created on the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_writer" title="stable_learning_control.utils.log_utils.logx.Logger.tb_writer"><code class="xref py py-attr docutils literal notranslate"><span class="pre">Logger.tb_writer</span></code></a> attribute when
<a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.use_tensorboard" title="stable_learning_control.utils.log_utils.logx.Logger.use_tensorboard"><code class="xref py py-attr docutils literal notranslate"><span class="pre">use_tensorboard</span></code></a> is set to <code class="docutils literal notranslate"><span class="pre">True</span></code></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.log_current_row">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">log_current_row</span></span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.log_current_row"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.log_current_row" title="Permalink to this definition"></a></dt>
<dd><p>Return the current row of the logger.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.watch_model_in_wandb">
<span class="sig-name descname"><span class="pre">watch_model_in_wandb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.watch_model_in_wandb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.watch_model_in_wandb" title="Permalink to this definition"></a></dt>
<dd><p>Watch model parameters in Weights &amp; Biases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>model</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.4)"><em>torch.nn.Module</em></a>) – Model to watch on Weights &amp; Biases.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.log_model_to_tb">
<span class="sig-name descname"><span class="pre">log_model_to_tb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_to_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.log_model_to_tb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.log_model_to_tb" title="Permalink to this definition"></a></dt>
<dd><p>Add model to tb summary.</p>
<p>Wrapper that calls the <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.tensorboard.SummaryWriter.add_graph</span></code>
or <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/summary/graph" title="(in TensorFlow v2.8)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tf.summary.graph</span></code></a> (depending on the backend) method while first making
sure a SummaryWriter object exits.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>union</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.4)"><em>torch.nn.Module</em></a><em>, </em><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/keras/Model" title="(in TensorFlow v2.8)"><em>tf.keras.Model</em></a><em>]</em>) – Model to add to the summary.</p></li>
<li><p><strong>input_to_model</strong> (<em>union</em><em>[</em><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.4)"><em>torch.Tensor</em></a><em>, </em><a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/Tensor" title="(in TensorFlow v2.8)"><em>tf.Tensor</em></a><em>]</em>) – Input tensor to the model.</p></li>
<li><p><strong>*args</strong> – All args to pass to the Summary/SummaryWriter object.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the Summary/SummaryWriter object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.add_tb_scalar">
<span class="sig-name descname"><span class="pre">add_tb_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.add_tb_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Add scalar to tb summary.</p>
<p>Wrapper that calls the <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.tensorboard.SummaryWriter.add_scalar</span></code>
or <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/summary/scalar" title="(in TensorFlow v2.8)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tf.summary.scalar</span></code></a> (depending on the backend) method while first making
sure a SummaryWriter object exits. These methods can be used to add a scalar
to the summary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the Summary/SummaryWriter object.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the Summary/SummaryWriter object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.tb_scalar">
<span class="sig-name descname"><span class="pre">tb_scalar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.tb_scalar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_scalar" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for making the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_scalar" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_scalar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_scalar()</span></code></a> method available directly under
the <code class="docutils literal notranslate"><span class="pre">scalar</span></code> alias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_scalar" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_scalar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_scalar()</span></code></a> method.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_scalar" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_scalar"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_scalar()</span></code></a> method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.add_tb_histogram">
<span class="sig-name descname"><span class="pre">add_tb_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.add_tb_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Add histogram to tb summary.</p>
<p>Wrapper that calls the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.tensorboard.SummaryWriter.add_histogram</span></code> or
<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/summary/histogram" title="(in TensorFlow v2.8)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tf.summary.histogram</span></code></a> (depending on the backend) method while first making
sure a SummaryWriter object exits. These methods can be used to add a histogram
to the summary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the Summary/SummaryWriter object.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the Summary/SummaryWriter object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.tb_histogram">
<span class="sig-name descname"><span class="pre">tb_histogram</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.tb_histogram"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_histogram" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for making the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_histogram" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_histogram"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_histogram()</span></code></a> method available directly
under the <code class="docutils literal notranslate"><span class="pre">tb_histogram</span></code> alias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_histogram" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_histogram"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_histogram()</span></code></a> method.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_histogram" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_histogram"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_histogram()</span></code></a> method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.add_tb_image">
<span class="sig-name descname"><span class="pre">add_tb_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.add_tb_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_image" title="Permalink to this definition"></a></dt>
<dd><p>Add image to tb summary.</p>
<p>Wrapper that calls the <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.tensorboard.SummaryWriter.add_image</span></code>
or <a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/summary/image" title="(in TensorFlow v2.8)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tf.summary.image</span></code></a> (depending on the backend) method while first making
sure a SummaryWriter object exits. These methods can be used to add a image
to the summary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the Summary/SummaryWriter object.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the Summary/SummaryWriter object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.tb_image">
<span class="sig-name descname"><span class="pre">tb_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.tb_image"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_image" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for making the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_image" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_image()</span></code></a> method available directly under
the <code class="docutils literal notranslate"><span class="pre">tb_image</span></code> alias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_image" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_image()</span></code></a> method.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_image" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_image"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_image()</span></code></a> method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.add_tb_text">
<span class="sig-name descname"><span class="pre">add_tb_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.add_tb_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_text" title="Permalink to this definition"></a></dt>
<dd><p>Add text to tb summary.</p>
<p>Wrapper that calls the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.tensorboard.SummaryWriter.add_text</span></code> or
<code class="xref py py-obj docutils literal notranslate"><span class="pre">tf.summary.add_text</span></code> (depending on the backend) method while first making
sure a SummaryWriter object exits. These methods can be used to add text
to the summary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the Summary/SummaryWriter object.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the Summary/SummaryWriter object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.tb_text">
<span class="sig-name descname"><span class="pre">tb_text</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.tb_text"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_text" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for making the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_text" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_text()</span></code></a> method available directly under
the <code class="docutils literal notranslate"><span class="pre">text</span></code> alias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_text" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_text()</span></code></a> method.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_text" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_text"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_text()</span></code></a> method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.add_tb_graph">
<span class="sig-name descname"><span class="pre">add_tb_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.add_tb_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_graph" title="Permalink to this definition"></a></dt>
<dd><p>Add graph to tb summary.</p>
<p>Wrapper that calls the <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.tensorboard.SummaryWriter.add_graph</span></code>
or <code class="xref py py-obj docutils literal notranslate"><span class="pre">tf.summary.add_graph</span></code> (depending on the backend) method while first
making sure a SummaryWriter object exits. These methods can be used to add a
graph to the summary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the Summary/SummaryWriter object.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the Summary/SummaryWriter object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.tb_graph">
<span class="sig-name descname"><span class="pre">tb_graph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.tb_graph"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.tb_graph" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for making the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_graph" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_graph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_graph()</span></code></a> method available directly under
the <code class="docutils literal notranslate"><span class="pre">tb_graph</span></code> alias.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_graph" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_graph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_graph()</span></code></a> method.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_graph" title="stable_learning_control.utils.log_utils.logx.Logger.add_tb_graph"><code class="xref py py-meth docutils literal notranslate"><span class="pre">add_tb_graph()</span></code></a> method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.add_tb_hparams">
<span class="sig-name descname"><span class="pre">add_tb_hparams</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.add_tb_hparams"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.add_tb_hparams" title="Permalink to this definition"></a></dt>
<dd><p>Adds hyper parameters to tb summary.</p>
<p>Wrapper that calls the <code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.tensorboard.SummaryWriter.add_hparams</span></code>
method while first making sure a SummaryWriter object exits. The <code class="docutils literal notranslate"><span class="pre">add_hparams</span></code>
method adds a set of hyperparameters to be compared in TensorBoard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the Summary/SummaryWriter object.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the Summary/SummaryWriter object.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#NotImplementedError" title="(in Python v3.12)"><strong>NotImplementedError</strong></a> – Raised if you try to call this method when using the
    TensorFlow backend.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.Logger.flush_tb_writer">
<span class="sig-name descname"><span class="pre">flush_tb_writer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#Logger.flush_tb_writer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.Logger.flush_tb_writer" title="Permalink to this definition"></a></dt>
<dd><p>Flush tb event file to disk.</p>
<p>Wrapper that calls the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">torch.utils.tensorboard.SummaryWriter.flush</span></code> or
<a class="reference external" href="https://www.tensorflow.org/api_docs/python/tf/summary/flush" title="(in TensorFlow v2.8)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">tf.summary.flush</span></code></a> (depending on the backend) method while first making
sure a SummaryWriter object exits. These methods can be used to flush the event
file to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to the Summary/SummaryWriter object.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to the Summary/SummaryWriter object.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.EpochLogger">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">stable_learning_control.utils.log_utils.logx.</span></span><span class="sig-name descname"><span class="pre">EpochLogger</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#EpochLogger"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.EpochLogger" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger" title="stable_learning_control.utils.log_utils.logx.Logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></a></p>
<p>A variant of <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger" title="stable_learning_control.utils.log_utils.logx.Logger"><code class="xref py py-class docutils literal notranslate"><span class="pre">Logger</span></code></a> tailored for tracking average values over epochs.</p>
<p><strong>Typical use case:</strong> there is some quantity which is calculated many times
throughout an epoch, and at the end of the epoch, you would like to
report the average/std/min/max value of that quantity.</p>
<p>With an EpochLogger, each time the quantity is calculated, you would
use</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">epoch_logger</span><span class="o">.</span><span class="n">store</span><span class="p">(</span><span class="n">NameOfQuantity</span><span class="o">=</span><span class="n">quantity_value</span><span class="p">)</span>
</pre></div>
</div>
<p>to load it into the EpochLogger’s state. Then at the end of the epoch, you
would use</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">epoch_logger</span><span class="o">.</span><span class="n">log_tabular</span><span class="p">(</span><span class="n">NameOfQuantity</span><span class="p">,</span> <span class="o">**</span><span class="n">options</span><span class="p">)</span>
</pre></div>
</div>
<p>to record the desired values.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.EpochLogger.epoch_dict">
<span class="sig-name descname"><span class="pre">epoch_dict</span></span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#EpochLogger.epoch_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.epoch_dict" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary used to store variables you want to log into the
<a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger" title="stable_learning_control.utils.log_utils.logx.EpochLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">EpochLogger</span></code></a> current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.EpochLogger.store">
<span class="sig-name descname"><span class="pre">store</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tb_write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_aliases</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extend</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#EpochLogger.store"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.store" title="Permalink to this definition"></a></dt>
<dd><p>Save something into the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger" title="stable_learning_control.utils.log_utils.logx.EpochLogger"><code class="xref py py-class docutils literal notranslate"><span class="pre">EpochLogger</span></code></a>’s current state.</p>
<p>Provide an arbitrary number of keyword arguments with numerical
values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tb_write</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>]</em><em>, </em><em>optional</em>) – Boolean or dict of key boolean pairs
specifying whether you also want to write the value to the TensorBoard
logfile. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>tb_aliases</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><em>dict</em></a><em>, </em><em>optional</em>) – Dictionary that can be used to set aliases for
the variables you want to store. Defaults to empty <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>.</p></li>
<li><p><strong>extend</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Boolean specifying whether you want to extend the
values to the log buffer. By default <code class="docutils literal notranslate"><span class="pre">False</span></code> meaning the values are
appended to the buffer.</p></li>
<li><p><strong>global_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Global step value to record. Uses internal step
counter if global step is not supplied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.EpochLogger.log_to_tb">
<span class="sig-name descname"><span class="pre">log_to_tb</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_min_and_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_step</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#EpochLogger.log_to_tb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.log_to_tb" title="Permalink to this definition"></a></dt>
<dd><p>Log a diagnostic to TensorBoard. This function takes or a list of keys or a
key-value pair. If only keys are supplied, averages will be calculated using
the new data found in the Loggers internal storage. If a key-value pair is
supplied, this pair will be directly logged to TensorBoard.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>keys</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>]</em>) – The name(s) of the diagnostic.</p></li>
<li><p><strong>val</strong> – A value for the diagnostic.</p></li>
<li><p><strong>with_min_and_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, log min and max values of the
diagnostic.</p></li>
<li><p><strong>average_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, do not log the standard deviation
of the diagnostic.</p></li>
<li><p><strong>tb_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – A prefix which can be added to group the
variables.</p></li>
<li><p><strong>tb_alias</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – A tb alias for the variable you want to store
store. Defaults to empty <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>. If not supplied the variable name
is used.</p></li>
<li><p><strong>global_step</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Global step value to record. Uses internal step
counter if global step is not supplied.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular">
<span class="sig-name descname"><span class="pre">log_tabular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_min_and_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">average_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_alias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#EpochLogger.log_tabular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.log_tabular" title="Permalink to this definition"></a></dt>
<dd><p>Log a value or possibly the mean/std/min/max values of a diagnostic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The name of the diagnostic. If you are logging a
diagnostic whose state has previously been saved with
<a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.store" title="stable_learning_control.utils.log_utils.logx.EpochLogger.store"><code class="xref py py-meth docutils literal notranslate"><span class="pre">store()</span></code></a>, the key here has to match the key you used there.</p></li>
<li><p><strong>val</strong> – A value for the diagnostic. If you have previously saved
values for this key via <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.store" title="stable_learning_control.utils.log_utils.logx.EpochLogger.store"><code class="xref py py-meth docutils literal notranslate"><span class="pre">store()</span></code></a>, do <em>not</em> provide a <code class="docutils literal notranslate"><span class="pre">val</span></code>
here.</p></li>
<li><p><strong>with_min_and_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, log min and max values of the
diagnostic over the epoch.</p></li>
<li><p><strong>average_only</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, do not log the standard deviation
of the diagnostic over the epoch.</p></li>
<li><p><strong>tb_write</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Boolean specifying whether you also want to write
the value to the TensorBoard logfile. Defaults to False.</p></li>
<li><p><strong>tb_prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – A prefix which can be added to group the
variables.</p></li>
<li><p><strong>tb_alias</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – A tb alias for the variable you want to store
store. Defaults to empty <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dict</span></code></a>. If not supplied the variable name
is used.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.EpochLogger.dump_tabular">
<span class="sig-name descname"><span class="pre">dump_tabular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#EpochLogger.dump_tabular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.dump_tabular" title="Permalink to this definition"></a></dt>
<dd><p>Small wrapper around the <a class="reference internal" href="#stable_learning_control.utils.log_utils.logx.Logger.dump_tabular" title="stable_learning_control.utils.log_utils.logx.Logger.dump_tabular"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Logger.dump_tabular()</span></code></a> method which
makes sure that the TensorBoard index track dictionary is reset after the table
is dumped.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong> – All args to pass to parent method.</p></li>
<li><p><strong>**kwargs</strong> – All kwargs to pass to parent method.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.logx.EpochLogger.get_stats">
<span class="sig-name descname"><span class="pre">get_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/logx.html#EpochLogger.get_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.logx.EpochLogger.get_stats" title="Permalink to this definition"></a></dt>
<dd><p>Lets an algorithm ask the logger for mean/std/min/max of a diagnostic.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>key</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – The key for which you want to get the stats.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><p>tuple containing:</p>
<blockquote>
<div><ul class="simple">
<li><p>mean(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): The current mean value.</p></li>
<li><p>std(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): The current  mean standard deviation.</p></li>
<li><p>min(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): The current mean value.</p></li>
<li><p>max(<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a>): The current mean value.</p></li>
</ul>
</div></blockquote>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>(<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.12)">tuple</a>)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="logger-helper-functions">
<h2><a class="toc-backref" href="#id8" role="doc-backlink">Logger helper functions</a><a class="headerlink" href="#logger-helper-functions" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="stable_learning_control.utils.log_utils.setup_logger_kwargs">
<span class="sig-prename descclassname"><span class="pre">stable_learning_control.utils.log_utils.</span></span><span class="sig-name descname"><span class="pre">setup_logger_kwargs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_checkpoints</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_tensorboard</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tb_log_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'low'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_wandb</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_job_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'train'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_project</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'stable-learning-control'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_group</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wandb_run_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'line'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose_vars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">data_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">datestamp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_learning_control/utils/log_utils/helpers.html#setup_logger_kwargs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_learning_control.utils.log_utils.setup_logger_kwargs" title="Permalink to this definition"></a></dt>
<dd><p>Sets up the output_dir for a logger and returns a dict for logger kwargs.</p>
<p>If no seed is given and datestamp is false,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">data_dir</span><span class="o">/</span><span class="n">exp_name</span>
</pre></div>
</div>
<p>If a seed is given and datestamp is false,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">data_dir</span><span class="o">/</span><span class="n">exp_name</span><span class="o">/</span><span class="n">exp_name_s</span><span class="p">[</span><span class="n">seed</span><span class="p">]</span>
</pre></div>
</div>
<p>If datestamp is true, amend to</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">data_dir</span><span class="o">/</span><span class="n">YY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD_exp_name</span><span class="o">/</span><span class="n">YY</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">DD_HH</span><span class="o">-</span><span class="n">MM</span><span class="o">-</span><span class="n">SS_exp_name_s</span><span class="p">[</span><span class="n">seed</span><span class="p">]</span>
</pre></div>
</div>
<p>You can force datestamp=True by setting <code class="docutils literal notranslate"><span class="pre">FORCE_DATESTAMP=True</span></code> in
<code class="docutils literal notranslate"><span class="pre">stable_learning_control/user_config.py</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exp_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a>) – Name for experiment.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><em>int</em></a><em>, </em><em>optional</em>) – Seed for random number generators used by experiment.</p></li>
<li><p><strong>save_checkpoints</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Save checkpoints during training.
Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>use_tensorboard</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether you want to use TensorBoard. Defaults
to <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>tb_log_freq</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The TensorBoard log frequency. Options are <code class="docutils literal notranslate"><span class="pre">low</span></code>
(Recommended: logs at every epoch) and <code class="docutils literal notranslate"><span class="pre">high</span></code> (logs at every SGD update ”
batch). Defaults to <code class="docutils literal notranslate"><span class="pre">low</span></code> since this is less resource intensive.</p></li>
<li><p><strong>use_wandb</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether you want to use Weights &amp; Biases. Defaults
to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>wandb_job_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The Weights &amp; Biases job type. Defaults to
<code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>wandb_project</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the Weights &amp; Biases project you
want to log to. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>wandb_group</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the Weights &amp; Biases group you want to
assign the run to. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>wandb_run_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The name of the Weights &amp; Biases run. Defaults
to <code class="docutils literal notranslate"><span class="pre">None</span></code> which means that the run name is automatically generated.</p></li>
<li><p><strong>quiet</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether you want to suppress logging of the diagnostics
to the stdout. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>verbose_fmt</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – The format in which the diagnostics are
displayed to the terminal. Options are <code class="docutils literal notranslate"><span class="pre">table</span></code> which supplies them as a
table and <code class="docutils literal notranslate"><span class="pre">line</span></code> which prints them in one line. Defaults to <code class="docutils literal notranslate"><span class="pre">line</span></code>.</p></li>
<li><p><strong>verbose_vars</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.12)"><em>list</em></a><em>, </em><em>optional</em>) – A list of variables you want to log to the
stdout. By default all variables are logged.</p></li>
<li><p><strong>data_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><em>str</em></a><em>, </em><em>optional</em>) – Path to folder where results should be saved.
Default is the <code class="docutils literal notranslate"><span class="pre">DEFAULT_DATA_DIR</span></code> in
<code class="docutils literal notranslate"><span class="pre">stable_learning_control/user_config.py</span></code>. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>datestamp</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether to include a date and timestamp in the
name of the save directory. Defaults to <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><dl class="simple">
<dt>logger_kwargs</dt><dd><p>A dict containing output_dir and exp_name.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.12)">dict</a></p>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../usage/benchmarks.html" class="btn btn-neutral float-left" title="Benchmarks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mpi.html" class="btn btn-neutral float-right" title="MPI Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Rick Staa.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>